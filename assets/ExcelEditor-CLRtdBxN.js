import{d as Mr,r as _t,c as Dr,o as Nr,a as yt,b as We,e as Pr,F as xr,f as Ur,n as hr,t as zt,g as zr,h as wt,w as Wr,v as Hr,i as dr,j as Zr}from"./index-B771QOqE.js";import{_ as Xr}from"./_plugin-vue_export-helper-DlAUqK2U.js";var lt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function jr(F){return F&&F.__esModule&&Object.prototype.hasOwnProperty.call(F,"default")?F.default:F}function kt(F){throw new Error('Could not dynamically require "'+F+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Wt={exports:{}},pr;function Gr(){return pr||(pr=1,(function(F,h){(function(e){F.exports=e()})(function(){return(function(){function e(g,n,y){function r(f,u){if(!n[f]){if(!g[f]){var s=typeof kt=="function"&&kt;if(!u&&s)return s(f,!0);if(t)return t(f,!0);var w=new Error("Cannot find module '"+f+"'");throw w.code="MODULE_NOT_FOUND",w}var _=n[f]={exports:{}};g[f][0].call(_.exports,function(S){var b=g[f][1][S];return r(b||S)},_,_.exports,e,g,n,y)}return n[f].exports}for(var t=typeof kt=="function"&&kt,a=0;a<y.length;a++)r(y[a]);return r}return e})()({1:[function(e,g,n){n.byteLength=w,n.toByteArray=S,n.fromByteArray=i;for(var y=[],r=[],t=typeof Uint8Array<"u"?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",f=0,u=a.length;f<u;++f)y[f]=a[f],r[a.charCodeAt(f)]=f;r[45]=62,r[95]=63;function s(l){var d=l.length;if(d%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var C=l.indexOf("=");C===-1&&(C=d);var c=C===d?0:4-C%4;return[C,c]}function w(l){var d=s(l),C=d[0],c=d[1];return(C+c)*3/4-c}function _(l,d,C){return(d+C)*3/4-C}function S(l){var d,C=s(l),c=C[0],E=C[1],O=new t(_(l,c,E)),P=0,W=E>0?c-4:c,A;for(A=0;A<W;A+=4)d=r[l.charCodeAt(A)]<<18|r[l.charCodeAt(A+1)]<<12|r[l.charCodeAt(A+2)]<<6|r[l.charCodeAt(A+3)],O[P++]=d>>16&255,O[P++]=d>>8&255,O[P++]=d&255;return E===2&&(d=r[l.charCodeAt(A)]<<2|r[l.charCodeAt(A+1)]>>4,O[P++]=d&255),E===1&&(d=r[l.charCodeAt(A)]<<10|r[l.charCodeAt(A+1)]<<4|r[l.charCodeAt(A+2)]>>2,O[P++]=d>>8&255,O[P++]=d&255),O}function b(l){return y[l>>18&63]+y[l>>12&63]+y[l>>6&63]+y[l&63]}function p(l,d,C){for(var c,E=[],O=d;O<C;O+=3)c=(l[O]<<16&16711680)+(l[O+1]<<8&65280)+(l[O+2]&255),E.push(b(c));return E.join("")}function i(l){for(var d,C=l.length,c=C%3,E=[],O=16383,P=0,W=C-c;P<W;P+=O)E.push(p(l,P,P+O>W?W:P+O));return c===1?(d=l[C-1],E.push(y[d>>2]+y[d<<4&63]+"==")):c===2&&(d=(l[C-2]<<8)+l[C-1],E.push(y[d>>10]+y[d>>4&63]+y[d<<2&63]+"=")),E.join("")}},{}],2:[function(e,g,n){},{}],3:[function(e,g,n){(function(s){var r=e("base64-js"),t=e("ieee754");n.Buffer=s,n.SlowBuffer=c,n.INSPECT_MAX_BYTES=50;var a=2147483647;n.kMaxLength=a,s.TYPED_ARRAY_SUPPORT=f(),!s.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function f(){try{var R=new Uint8Array(1);return R.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},R.foo()===42}catch{return!1}}Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.byteOffset}});function u(R){if(R>a)throw new RangeError('The value "'+R+'" is invalid for option "size"');var v=new Uint8Array(R);return v.__proto__=s.prototype,v}function s(R,v,m){if(typeof R=="number"){if(typeof v=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return b(R)}return w(R,v,m)}typeof Symbol<"u"&&Symbol.species!=null&&s[Symbol.species]===s&&Object.defineProperty(s,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),s.poolSize=8192;function w(R,v,m){if(typeof R=="string")return p(R,v);if(ArrayBuffer.isView(R))return i(R);if(R==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof R);if(Se(R,ArrayBuffer)||R&&Se(R.buffer,ArrayBuffer))return l(R,v,m);if(typeof R=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var L=R.valueOf&&R.valueOf();if(L!=null&&L!==R)return s.from(L,v,m);var X=d(R);if(X)return X;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof R[Symbol.toPrimitive]=="function")return s.from(R[Symbol.toPrimitive]("string"),v,m);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof R)}s.from=function(R,v,m){return w(R,v,m)},s.prototype.__proto__=Uint8Array.prototype,s.__proto__=Uint8Array;function _(R){if(typeof R!="number")throw new TypeError('"size" argument must be of type number');if(R<0)throw new RangeError('The value "'+R+'" is invalid for option "size"')}function S(R,v,m){return _(R),R<=0?u(R):v!==void 0?typeof m=="string"?u(R).fill(v,m):u(R).fill(v):u(R)}s.alloc=function(R,v,m){return S(R,v,m)};function b(R){return _(R),u(R<0?0:C(R)|0)}s.allocUnsafe=function(R){return b(R)},s.allocUnsafeSlow=function(R){return b(R)};function p(R,v){if((typeof v!="string"||v==="")&&(v="utf8"),!s.isEncoding(v))throw new TypeError("Unknown encoding: "+v);var m=E(R,v)|0,L=u(m),X=L.write(R,v);return X!==m&&(L=L.slice(0,X)),L}function i(R){for(var v=R.length<0?0:C(R.length)|0,m=u(v),L=0;L<v;L+=1)m[L]=R[L]&255;return m}function l(R,v,m){if(v<0||R.byteLength<v)throw new RangeError('"offset" is outside of buffer bounds');if(R.byteLength<v+(m||0))throw new RangeError('"length" is outside of buffer bounds');var L;return v===void 0&&m===void 0?L=new Uint8Array(R):m===void 0?L=new Uint8Array(R,v):L=new Uint8Array(R,v,m),L.__proto__=s.prototype,L}function d(R){if(s.isBuffer(R)){var v=C(R.length)|0,m=u(v);return m.length===0||R.copy(m,0,0,v),m}if(R.length!==void 0)return typeof R.length!="number"||we(R.length)?u(0):i(R);if(R.type==="Buffer"&&Array.isArray(R.data))return i(R.data)}function C(R){if(R>=a)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a.toString(16)+" bytes");return R|0}function c(R){return+R!=R&&(R=0),s.alloc(+R)}s.isBuffer=function(v){return v!=null&&v._isBuffer===!0&&v!==s.prototype},s.compare=function(v,m){if(Se(v,Uint8Array)&&(v=s.from(v,v.offset,v.byteLength)),Se(m,Uint8Array)&&(m=s.from(m,m.offset,m.byteLength)),!s.isBuffer(v)||!s.isBuffer(m))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(v===m)return 0;for(var L=v.length,X=m.length,se=0,oe=Math.min(L,X);se<oe;++se)if(v[se]!==m[se]){L=v[se],X=m[se];break}return L<X?-1:X<L?1:0},s.isEncoding=function(v){switch(String(v).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(v,m){if(!Array.isArray(v))throw new TypeError('"list" argument must be an Array of Buffers');if(v.length===0)return s.alloc(0);var L;if(m===void 0)for(m=0,L=0;L<v.length;++L)m+=v[L].length;var X=s.allocUnsafe(m),se=0;for(L=0;L<v.length;++L){var oe=v[L];if(Se(oe,Uint8Array)&&(oe=s.from(oe)),!s.isBuffer(oe))throw new TypeError('"list" argument must be an Array of Buffers');oe.copy(X,se),se+=oe.length}return X};function E(R,v){if(s.isBuffer(R))return R.length;if(ArrayBuffer.isView(R)||Se(R,ArrayBuffer))return R.byteLength;if(typeof R!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof R);var m=R.length,L=arguments.length>2&&arguments[2]===!0;if(!L&&m===0)return 0;for(var X=!1;;)switch(v){case"ascii":case"latin1":case"binary":return m;case"utf8":case"utf-8":return ke(R).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return m*2;case"hex":return m>>>1;case"base64":return te(R).length;default:if(X)return L?-1:ke(R).length;v=(""+v).toLowerCase(),X=!0}}s.byteLength=E;function O(R,v,m){var L=!1;if((v===void 0||v<0)&&(v=0),v>this.length||((m===void 0||m>this.length)&&(m=this.length),m<=0)||(m>>>=0,v>>>=0,m<=v))return"";for(R||(R="utf8");;)switch(R){case"hex":return de(this,v,m);case"utf8":case"utf-8":return Y(this,v,m);case"ascii":return ce(this,v,m);case"latin1":case"binary":return ie(this,v,m);case"base64":return K(this,v,m);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ve(this,v,m);default:if(L)throw new TypeError("Unknown encoding: "+R);R=(R+"").toLowerCase(),L=!0}}s.prototype._isBuffer=!0;function P(R,v,m){var L=R[v];R[v]=R[m],R[m]=L}s.prototype.swap16=function(){var v=this.length;if(v%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var m=0;m<v;m+=2)P(this,m,m+1);return this},s.prototype.swap32=function(){var v=this.length;if(v%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var m=0;m<v;m+=4)P(this,m,m+3),P(this,m+1,m+2);return this},s.prototype.swap64=function(){var v=this.length;if(v%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var m=0;m<v;m+=8)P(this,m,m+7),P(this,m+1,m+6),P(this,m+2,m+5),P(this,m+3,m+4);return this},s.prototype.toString=function(){var v=this.length;return v===0?"":arguments.length===0?Y(this,0,v):O.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(v){if(!s.isBuffer(v))throw new TypeError("Argument must be a Buffer");return this===v?!0:s.compare(this,v)===0},s.prototype.inspect=function(){var v="",m=n.INSPECT_MAX_BYTES;return v=this.toString("hex",0,m).replace(/(.{2})/g,"$1 ").trim(),this.length>m&&(v+=" ... "),"<Buffer "+v+">"},s.prototype.compare=function(v,m,L,X,se){if(Se(v,Uint8Array)&&(v=s.from(v,v.offset,v.byteLength)),!s.isBuffer(v))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof v);if(m===void 0&&(m=0),L===void 0&&(L=v?v.length:0),X===void 0&&(X=0),se===void 0&&(se=this.length),m<0||L>v.length||X<0||se>this.length)throw new RangeError("out of range index");if(X>=se&&m>=L)return 0;if(X>=se)return-1;if(m>=L)return 1;if(m>>>=0,L>>>=0,X>>>=0,se>>>=0,this===v)return 0;for(var oe=se-X,Te=L-m,Ce=Math.min(oe,Te),Ee=this.slice(X,se),Fe=v.slice(m,L),Ae=0;Ae<Ce;++Ae)if(Ee[Ae]!==Fe[Ae]){oe=Ee[Ae],Te=Fe[Ae];break}return oe<Te?-1:Te<oe?1:0};function W(R,v,m,L,X){if(R.length===0)return-1;if(typeof m=="string"?(L=m,m=0):m>2147483647?m=2147483647:m<-2147483648&&(m=-2147483648),m=+m,we(m)&&(m=X?0:R.length-1),m<0&&(m=R.length+m),m>=R.length){if(X)return-1;m=R.length-1}else if(m<0)if(X)m=0;else return-1;if(typeof v=="string"&&(v=s.from(v,L)),s.isBuffer(v))return v.length===0?-1:A(R,v,m,L,X);if(typeof v=="number")return v=v&255,typeof Uint8Array.prototype.indexOf=="function"?X?Uint8Array.prototype.indexOf.call(R,v,m):Uint8Array.prototype.lastIndexOf.call(R,v,m):A(R,[v],m,L,X);throw new TypeError("val must be string, number or Buffer")}function A(R,v,m,L,X){var se=1,oe=R.length,Te=v.length;if(L!==void 0&&(L=String(L).toLowerCase(),L==="ucs2"||L==="ucs-2"||L==="utf16le"||L==="utf-16le")){if(R.length<2||v.length<2)return-1;se=2,oe/=2,Te/=2,m/=2}function Ce(Ie,Ne){return se===1?Ie[Ne]:Ie.readUInt16BE(Ne*se)}var Ee;if(X){var Fe=-1;for(Ee=m;Ee<oe;Ee++)if(Ce(R,Ee)===Ce(v,Fe===-1?0:Ee-Fe)){if(Fe===-1&&(Fe=Ee),Ee-Fe+1===Te)return Fe*se}else Fe!==-1&&(Ee-=Ee-Fe),Fe=-1}else for(m+Te>oe&&(m=oe-Te),Ee=m;Ee>=0;Ee--){for(var Ae=!0,xe=0;xe<Te;xe++)if(Ce(R,Ee+xe)!==Ce(v,xe)){Ae=!1;break}if(Ae)return Ee}return-1}s.prototype.includes=function(v,m,L){return this.indexOf(v,m,L)!==-1},s.prototype.indexOf=function(v,m,L){return W(this,v,m,L,!0)},s.prototype.lastIndexOf=function(v,m,L){return W(this,v,m,L,!1)};function ee(R,v,m,L){m=Number(m)||0;var X=R.length-m;L?(L=Number(L),L>X&&(L=X)):L=X;var se=v.length;L>se/2&&(L=se/2);for(var oe=0;oe<L;++oe){var Te=parseInt(v.substr(oe*2,2),16);if(we(Te))return oe;R[m+oe]=Te}return oe}function D(R,v,m,L){return ae(ke(v,R.length-m),R,m,L)}function B(R,v,m,L){return ae(M(v),R,m,L)}function U(R,v,m,L){return B(R,v,m,L)}function x(R,v,m,L){return ae(te(v),R,m,L)}function z(R,v,m,L){return ae(N(v,R.length-m),R,m,L)}s.prototype.write=function(v,m,L,X){if(m===void 0)X="utf8",L=this.length,m=0;else if(L===void 0&&typeof m=="string")X=m,L=this.length,m=0;else if(isFinite(m))m=m>>>0,isFinite(L)?(L=L>>>0,X===void 0&&(X="utf8")):(X=L,L=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var se=this.length-m;if((L===void 0||L>se)&&(L=se),v.length>0&&(L<0||m<0)||m>this.length)throw new RangeError("Attempt to write outside buffer bounds");X||(X="utf8");for(var oe=!1;;)switch(X){case"hex":return ee(this,v,m,L);case"utf8":case"utf-8":return D(this,v,m,L);case"ascii":return B(this,v,m,L);case"latin1":case"binary":return U(this,v,m,L);case"base64":return x(this,v,m,L);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return z(this,v,m,L);default:if(oe)throw new TypeError("Unknown encoding: "+X);X=(""+X).toLowerCase(),oe=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function K(R,v,m){return v===0&&m===R.length?r.fromByteArray(R):r.fromByteArray(R.slice(v,m))}function Y(R,v,m){m=Math.min(R.length,m);for(var L=[],X=v;X<m;){var se=R[X],oe=null,Te=se>239?4:se>223?3:se>191?2:1;if(X+Te<=m){var Ce,Ee,Fe,Ae;switch(Te){case 1:se<128&&(oe=se);break;case 2:Ce=R[X+1],(Ce&192)===128&&(Ae=(se&31)<<6|Ce&63,Ae>127&&(oe=Ae));break;case 3:Ce=R[X+1],Ee=R[X+2],(Ce&192)===128&&(Ee&192)===128&&(Ae=(se&15)<<12|(Ce&63)<<6|Ee&63,Ae>2047&&(Ae<55296||Ae>57343)&&(oe=Ae));break;case 4:Ce=R[X+1],Ee=R[X+2],Fe=R[X+3],(Ce&192)===128&&(Ee&192)===128&&(Fe&192)===128&&(Ae=(se&15)<<18|(Ce&63)<<12|(Ee&63)<<6|Fe&63,Ae>65535&&Ae<1114112&&(oe=Ae))}}oe===null?(oe=65533,Te=1):oe>65535&&(oe-=65536,L.push(oe>>>10&1023|55296),oe=56320|oe&1023),L.push(oe),X+=Te}return V(L)}var $=4096;function V(R){var v=R.length;if(v<=$)return String.fromCharCode.apply(String,R);for(var m="",L=0;L<v;)m+=String.fromCharCode.apply(String,R.slice(L,L+=$));return m}function ce(R,v,m){var L="";m=Math.min(R.length,m);for(var X=v;X<m;++X)L+=String.fromCharCode(R[X]&127);return L}function ie(R,v,m){var L="";m=Math.min(R.length,m);for(var X=v;X<m;++X)L+=String.fromCharCode(R[X]);return L}function de(R,v,m){var L=R.length;(!v||v<0)&&(v=0),(!m||m<0||m>L)&&(m=L);for(var X="",se=v;se<m;++se)X+=Oe(R[se]);return X}function ve(R,v,m){for(var L=R.slice(v,m),X="",se=0;se<L.length;se+=2)X+=String.fromCharCode(L[se]+L[se+1]*256);return X}s.prototype.slice=function(v,m){var L=this.length;v=~~v,m=m===void 0?L:~~m,v<0?(v+=L,v<0&&(v=0)):v>L&&(v=L),m<0?(m+=L,m<0&&(m=0)):m>L&&(m=L),m<v&&(m=v);var X=this.subarray(v,m);return X.__proto__=s.prototype,X};function Z(R,v,m){if(R%1!==0||R<0)throw new RangeError("offset is not uint");if(R+v>m)throw new RangeError("Trying to access beyond buffer length")}s.prototype.readUIntLE=function(v,m,L){v=v>>>0,m=m>>>0,L||Z(v,m,this.length);for(var X=this[v],se=1,oe=0;++oe<m&&(se*=256);)X+=this[v+oe]*se;return X},s.prototype.readUIntBE=function(v,m,L){v=v>>>0,m=m>>>0,L||Z(v,m,this.length);for(var X=this[v+--m],se=1;m>0&&(se*=256);)X+=this[v+--m]*se;return X},s.prototype.readUInt8=function(v,m){return v=v>>>0,m||Z(v,1,this.length),this[v]},s.prototype.readUInt16LE=function(v,m){return v=v>>>0,m||Z(v,2,this.length),this[v]|this[v+1]<<8},s.prototype.readUInt16BE=function(v,m){return v=v>>>0,m||Z(v,2,this.length),this[v]<<8|this[v+1]},s.prototype.readUInt32LE=function(v,m){return v=v>>>0,m||Z(v,4,this.length),(this[v]|this[v+1]<<8|this[v+2]<<16)+this[v+3]*16777216},s.prototype.readUInt32BE=function(v,m){return v=v>>>0,m||Z(v,4,this.length),this[v]*16777216+(this[v+1]<<16|this[v+2]<<8|this[v+3])},s.prototype.readIntLE=function(v,m,L){v=v>>>0,m=m>>>0,L||Z(v,m,this.length);for(var X=this[v],se=1,oe=0;++oe<m&&(se*=256);)X+=this[v+oe]*se;return se*=128,X>=se&&(X-=Math.pow(2,8*m)),X},s.prototype.readIntBE=function(v,m,L){v=v>>>0,m=m>>>0,L||Z(v,m,this.length);for(var X=m,se=1,oe=this[v+--X];X>0&&(se*=256);)oe+=this[v+--X]*se;return se*=128,oe>=se&&(oe-=Math.pow(2,8*m)),oe},s.prototype.readInt8=function(v,m){return v=v>>>0,m||Z(v,1,this.length),this[v]&128?(255-this[v]+1)*-1:this[v]},s.prototype.readInt16LE=function(v,m){v=v>>>0,m||Z(v,2,this.length);var L=this[v]|this[v+1]<<8;return L&32768?L|4294901760:L},s.prototype.readInt16BE=function(v,m){v=v>>>0,m||Z(v,2,this.length);var L=this[v+1]|this[v]<<8;return L&32768?L|4294901760:L},s.prototype.readInt32LE=function(v,m){return v=v>>>0,m||Z(v,4,this.length),this[v]|this[v+1]<<8|this[v+2]<<16|this[v+3]<<24},s.prototype.readInt32BE=function(v,m){return v=v>>>0,m||Z(v,4,this.length),this[v]<<24|this[v+1]<<16|this[v+2]<<8|this[v+3]},s.prototype.readFloatLE=function(v,m){return v=v>>>0,m||Z(v,4,this.length),t.read(this,v,!0,23,4)},s.prototype.readFloatBE=function(v,m){return v=v>>>0,m||Z(v,4,this.length),t.read(this,v,!1,23,4)},s.prototype.readDoubleLE=function(v,m){return v=v>>>0,m||Z(v,8,this.length),t.read(this,v,!0,52,8)},s.prototype.readDoubleBE=function(v,m){return v=v>>>0,m||Z(v,8,this.length),t.read(this,v,!1,52,8)};function j(R,v,m,L,X,se){if(!s.isBuffer(R))throw new TypeError('"buffer" argument must be a Buffer instance');if(v>X||v<se)throw new RangeError('"value" argument is out of bounds');if(m+L>R.length)throw new RangeError("Index out of range")}s.prototype.writeUIntLE=function(v,m,L,X){if(v=+v,m=m>>>0,L=L>>>0,!X){var se=Math.pow(2,8*L)-1;j(this,v,m,L,se,0)}var oe=1,Te=0;for(this[m]=v&255;++Te<L&&(oe*=256);)this[m+Te]=v/oe&255;return m+L},s.prototype.writeUIntBE=function(v,m,L,X){if(v=+v,m=m>>>0,L=L>>>0,!X){var se=Math.pow(2,8*L)-1;j(this,v,m,L,se,0)}var oe=L-1,Te=1;for(this[m+oe]=v&255;--oe>=0&&(Te*=256);)this[m+oe]=v/Te&255;return m+L},s.prototype.writeUInt8=function(v,m,L){return v=+v,m=m>>>0,L||j(this,v,m,1,255,0),this[m]=v&255,m+1},s.prototype.writeUInt16LE=function(v,m,L){return v=+v,m=m>>>0,L||j(this,v,m,2,65535,0),this[m]=v&255,this[m+1]=v>>>8,m+2},s.prototype.writeUInt16BE=function(v,m,L){return v=+v,m=m>>>0,L||j(this,v,m,2,65535,0),this[m]=v>>>8,this[m+1]=v&255,m+2},s.prototype.writeUInt32LE=function(v,m,L){return v=+v,m=m>>>0,L||j(this,v,m,4,4294967295,0),this[m+3]=v>>>24,this[m+2]=v>>>16,this[m+1]=v>>>8,this[m]=v&255,m+4},s.prototype.writeUInt32BE=function(v,m,L){return v=+v,m=m>>>0,L||j(this,v,m,4,4294967295,0),this[m]=v>>>24,this[m+1]=v>>>16,this[m+2]=v>>>8,this[m+3]=v&255,m+4},s.prototype.writeIntLE=function(v,m,L,X){if(v=+v,m=m>>>0,!X){var se=Math.pow(2,8*L-1);j(this,v,m,L,se-1,-se)}var oe=0,Te=1,Ce=0;for(this[m]=v&255;++oe<L&&(Te*=256);)v<0&&Ce===0&&this[m+oe-1]!==0&&(Ce=1),this[m+oe]=(v/Te>>0)-Ce&255;return m+L},s.prototype.writeIntBE=function(v,m,L,X){if(v=+v,m=m>>>0,!X){var se=Math.pow(2,8*L-1);j(this,v,m,L,se-1,-se)}var oe=L-1,Te=1,Ce=0;for(this[m+oe]=v&255;--oe>=0&&(Te*=256);)v<0&&Ce===0&&this[m+oe+1]!==0&&(Ce=1),this[m+oe]=(v/Te>>0)-Ce&255;return m+L},s.prototype.writeInt8=function(v,m,L){return v=+v,m=m>>>0,L||j(this,v,m,1,127,-128),v<0&&(v=255+v+1),this[m]=v&255,m+1},s.prototype.writeInt16LE=function(v,m,L){return v=+v,m=m>>>0,L||j(this,v,m,2,32767,-32768),this[m]=v&255,this[m+1]=v>>>8,m+2},s.prototype.writeInt16BE=function(v,m,L){return v=+v,m=m>>>0,L||j(this,v,m,2,32767,-32768),this[m]=v>>>8,this[m+1]=v&255,m+2},s.prototype.writeInt32LE=function(v,m,L){return v=+v,m=m>>>0,L||j(this,v,m,4,2147483647,-2147483648),this[m]=v&255,this[m+1]=v>>>8,this[m+2]=v>>>16,this[m+3]=v>>>24,m+4},s.prototype.writeInt32BE=function(v,m,L){return v=+v,m=m>>>0,L||j(this,v,m,4,2147483647,-2147483648),v<0&&(v=4294967295+v+1),this[m]=v>>>24,this[m+1]=v>>>16,this[m+2]=v>>>8,this[m+3]=v&255,m+4};function re(R,v,m,L,X,se){if(m+L>R.length)throw new RangeError("Index out of range");if(m<0)throw new RangeError("Index out of range")}function ue(R,v,m,L,X){return v=+v,m=m>>>0,X||re(R,v,m,4),t.write(R,v,m,L,23,4),m+4}s.prototype.writeFloatLE=function(v,m,L){return ue(this,v,m,!0,L)},s.prototype.writeFloatBE=function(v,m,L){return ue(this,v,m,!1,L)};function ge(R,v,m,L,X){return v=+v,m=m>>>0,X||re(R,v,m,8),t.write(R,v,m,L,52,8),m+8}s.prototype.writeDoubleLE=function(v,m,L){return ge(this,v,m,!0,L)},s.prototype.writeDoubleBE=function(v,m,L){return ge(this,v,m,!1,L)},s.prototype.copy=function(v,m,L,X){if(!s.isBuffer(v))throw new TypeError("argument should be a Buffer");if(L||(L=0),!X&&X!==0&&(X=this.length),m>=v.length&&(m=v.length),m||(m=0),X>0&&X<L&&(X=L),X===L||v.length===0||this.length===0)return 0;if(m<0)throw new RangeError("targetStart out of bounds");if(L<0||L>=this.length)throw new RangeError("Index out of range");if(X<0)throw new RangeError("sourceEnd out of bounds");X>this.length&&(X=this.length),v.length-m<X-L&&(X=v.length-m+L);var se=X-L;if(this===v&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(m,L,X);else if(this===v&&L<m&&m<X)for(var oe=se-1;oe>=0;--oe)v[oe+m]=this[oe+L];else Uint8Array.prototype.set.call(v,this.subarray(L,X),m);return se},s.prototype.fill=function(v,m,L,X){if(typeof v=="string"){if(typeof m=="string"?(X=m,m=0,L=this.length):typeof L=="string"&&(X=L,L=this.length),X!==void 0&&typeof X!="string")throw new TypeError("encoding must be a string");if(typeof X=="string"&&!s.isEncoding(X))throw new TypeError("Unknown encoding: "+X);if(v.length===1){var se=v.charCodeAt(0);(X==="utf8"&&se<128||X==="latin1")&&(v=se)}}else typeof v=="number"&&(v=v&255);if(m<0||this.length<m||this.length<L)throw new RangeError("Out of range index");if(L<=m)return this;m=m>>>0,L=L===void 0?this.length:L>>>0,v||(v=0);var oe;if(typeof v=="number")for(oe=m;oe<L;++oe)this[oe]=v;else{var Te=s.isBuffer(v)?v:s.from(v,X),Ce=Te.length;if(Ce===0)throw new TypeError('The value "'+v+'" is invalid for argument "value"');for(oe=0;oe<L-m;++oe)this[oe+m]=Te[oe%Ce]}return this};var me=/[^+/0-9A-Za-z-_]/g;function Re(R){if(R=R.split("=")[0],R=R.trim().replace(me,""),R.length<2)return"";for(;R.length%4!==0;)R=R+"=";return R}function Oe(R){return R<16?"0"+R.toString(16):R.toString(16)}function ke(R,v){v=v||1/0;for(var m,L=R.length,X=null,se=[],oe=0;oe<L;++oe){if(m=R.charCodeAt(oe),m>55295&&m<57344){if(!X){if(m>56319){(v-=3)>-1&&se.push(239,191,189);continue}else if(oe+1===L){(v-=3)>-1&&se.push(239,191,189);continue}X=m;continue}if(m<56320){(v-=3)>-1&&se.push(239,191,189),X=m;continue}m=(X-55296<<10|m-56320)+65536}else X&&(v-=3)>-1&&se.push(239,191,189);if(X=null,m<128){if((v-=1)<0)break;se.push(m)}else if(m<2048){if((v-=2)<0)break;se.push(m>>6|192,m&63|128)}else if(m<65536){if((v-=3)<0)break;se.push(m>>12|224,m>>6&63|128,m&63|128)}else if(m<1114112){if((v-=4)<0)break;se.push(m>>18|240,m>>12&63|128,m>>6&63|128,m&63|128)}else throw new Error("Invalid code point")}return se}function M(R){for(var v=[],m=0;m<R.length;++m)v.push(R.charCodeAt(m)&255);return v}function N(R,v){for(var m,L,X,se=[],oe=0;oe<R.length&&!((v-=2)<0);++oe)m=R.charCodeAt(oe),L=m>>8,X=m%256,se.push(X),se.push(L);return se}function te(R){return r.toByteArray(Re(R))}function ae(R,v,m,L){for(var X=0;X<L&&!(X+m>=v.length||X>=R.length);++X)v[X+m]=R[X];return X}function Se(R,v){return R instanceof v||R!=null&&R.constructor!=null&&R.constructor.name!=null&&R.constructor.name===v.name}function we(R){return R!==R}}).call(this,e("buffer").Buffer)},{"base64-js":1,buffer:3,ieee754:6}],4:[function(e,g,n){(function(y){function r(c){return Array.isArray?Array.isArray(c):C(c)==="[object Array]"}n.isArray=r;function t(c){return typeof c=="boolean"}n.isBoolean=t;function a(c){return c===null}n.isNull=a;function f(c){return c==null}n.isNullOrUndefined=f;function u(c){return typeof c=="number"}n.isNumber=u;function s(c){return typeof c=="string"}n.isString=s;function w(c){return typeof c=="symbol"}n.isSymbol=w;function _(c){return c===void 0}n.isUndefined=_;function S(c){return C(c)==="[object RegExp]"}n.isRegExp=S;function b(c){return typeof c=="object"&&c!==null}n.isObject=b;function p(c){return C(c)==="[object Date]"}n.isDate=p;function i(c){return C(c)==="[object Error]"||c instanceof Error}n.isError=i;function l(c){return typeof c=="function"}n.isFunction=l;function d(c){return c===null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||typeof c=="symbol"||typeof c>"u"}n.isPrimitive=d,n.isBuffer=y.isBuffer;function C(c){return Object.prototype.toString.call(c)}}).call(this,{isBuffer:e("../../is-buffer/index.js")})},{"../../is-buffer/index.js":9}],5:[function(e,g,n){var y=Object.create||A,r=Object.keys||ee,t=Function.prototype.bind||D;function a(){(!this._events||!Object.prototype.hasOwnProperty.call(this,"_events"))&&(this._events=y(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}g.exports=a,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._maxListeners=void 0;var f=10,u;try{var s={};Object.defineProperty&&Object.defineProperty(s,"x",{value:0}),u=s.x===0}catch{u=!1}u?Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return f},set:function(B){if(typeof B!="number"||B<0||B!==B)throw new TypeError('"defaultMaxListeners" must be a positive number');f=B}}):a.defaultMaxListeners=f,a.prototype.setMaxListeners=function(U){if(typeof U!="number"||U<0||isNaN(U))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=U,this};function w(B){return B._maxListeners===void 0?a.defaultMaxListeners:B._maxListeners}a.prototype.getMaxListeners=function(){return w(this)};function _(B,U,x){if(U)B.call(x);else for(var z=B.length,K=P(B,z),Y=0;Y<z;++Y)K[Y].call(x)}function S(B,U,x,z){if(U)B.call(x,z);else for(var K=B.length,Y=P(B,K),$=0;$<K;++$)Y[$].call(x,z)}function b(B,U,x,z,K){if(U)B.call(x,z,K);else for(var Y=B.length,$=P(B,Y),V=0;V<Y;++V)$[V].call(x,z,K)}function p(B,U,x,z,K,Y){if(U)B.call(x,z,K,Y);else for(var $=B.length,V=P(B,$),ce=0;ce<$;++ce)V[ce].call(x,z,K,Y)}function i(B,U,x,z){if(U)B.apply(x,z);else for(var K=B.length,Y=P(B,K),$=0;$<K;++$)Y[$].apply(x,z)}a.prototype.emit=function(U){var x,z,K,Y,$,V,ce=U==="error";if(V=this._events,V)ce=ce&&V.error==null;else if(!ce)return!1;if(ce){if(arguments.length>1&&(x=arguments[1]),x instanceof Error)throw x;var ie=new Error('Unhandled "error" event. ('+x+")");throw ie.context=x,ie}if(z=V[U],!z)return!1;var de=typeof z=="function";switch(K=arguments.length,K){case 1:_(z,de,this);break;case 2:S(z,de,this,arguments[1]);break;case 3:b(z,de,this,arguments[1],arguments[2]);break;case 4:p(z,de,this,arguments[1],arguments[2],arguments[3]);break;default:for(Y=new Array(K-1),$=1;$<K;$++)Y[$-1]=arguments[$];i(z,de,this,Y)}return!0};function l(B,U,x,z){var K,Y,$;if(typeof x!="function")throw new TypeError('"listener" argument must be a function');if(Y=B._events,Y?(Y.newListener&&(B.emit("newListener",U,x.listener?x.listener:x),Y=B._events),$=Y[U]):(Y=B._events=y(null),B._eventsCount=0),!$)$=Y[U]=x,++B._eventsCount;else if(typeof $=="function"?$=Y[U]=z?[x,$]:[$,x]:z?$.unshift(x):$.push(x),!$.warned&&(K=w(B),K&&K>0&&$.length>K)){$.warned=!0;var V=new Error("Possible EventEmitter memory leak detected. "+$.length+' "'+String(U)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');V.name="MaxListenersExceededWarning",V.emitter=B,V.type=U,V.count=$.length,typeof console=="object"&&console.warn&&console.warn("%s: %s",V.name,V.message)}return B}a.prototype.addListener=function(U,x){return l(this,U,x,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(U,x){return l(this,U,x,!0)};function d(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var B=new Array(arguments.length),U=0;U<B.length;++U)B[U]=arguments[U];this.listener.apply(this.target,B)}}function C(B,U,x){var z={fired:!1,wrapFn:void 0,target:B,type:U,listener:x},K=t.call(d,z);return K.listener=x,z.wrapFn=K,K}a.prototype.once=function(U,x){if(typeof x!="function")throw new TypeError('"listener" argument must be a function');return this.on(U,C(this,U,x)),this},a.prototype.prependOnceListener=function(U,x){if(typeof x!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(U,C(this,U,x)),this},a.prototype.removeListener=function(U,x){var z,K,Y,$,V;if(typeof x!="function")throw new TypeError('"listener" argument must be a function');if(K=this._events,!K)return this;if(z=K[U],!z)return this;if(z===x||z.listener===x)--this._eventsCount===0?this._events=y(null):(delete K[U],K.removeListener&&this.emit("removeListener",U,z.listener||x));else if(typeof z!="function"){for(Y=-1,$=z.length-1;$>=0;$--)if(z[$]===x||z[$].listener===x){V=z[$].listener,Y=$;break}if(Y<0)return this;Y===0?z.shift():O(z,Y),z.length===1&&(K[U]=z[0]),K.removeListener&&this.emit("removeListener",U,V||x)}return this},a.prototype.removeAllListeners=function(U){var x,z,K;if(z=this._events,!z)return this;if(!z.removeListener)return arguments.length===0?(this._events=y(null),this._eventsCount=0):z[U]&&(--this._eventsCount===0?this._events=y(null):delete z[U]),this;if(arguments.length===0){var Y=r(z),$;for(K=0;K<Y.length;++K)$=Y[K],$!=="removeListener"&&this.removeAllListeners($);return this.removeAllListeners("removeListener"),this._events=y(null),this._eventsCount=0,this}if(x=z[U],typeof x=="function")this.removeListener(U,x);else if(x)for(K=x.length-1;K>=0;K--)this.removeListener(U,x[K]);return this};function c(B,U,x){var z=B._events;if(!z)return[];var K=z[U];return K?typeof K=="function"?x?[K.listener||K]:[K]:x?W(K):P(K,K.length):[]}a.prototype.listeners=function(U){return c(this,U,!0)},a.prototype.rawListeners=function(U){return c(this,U,!1)},a.listenerCount=function(B,U){return typeof B.listenerCount=="function"?B.listenerCount(U):E.call(B,U)},a.prototype.listenerCount=E;function E(B){var U=this._events;if(U){var x=U[B];if(typeof x=="function")return 1;if(x)return x.length}return 0}a.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};function O(B,U){for(var x=U,z=x+1,K=B.length;z<K;x+=1,z+=1)B[x]=B[z];B.pop()}function P(B,U){for(var x=new Array(U),z=0;z<U;++z)x[z]=B[z];return x}function W(B){for(var U=new Array(B.length),x=0;x<U.length;++x)U[x]=B[x].listener||B[x];return U}function A(B){var U=function(){};return U.prototype=B,new U}function ee(B){for(var U in B)Object.prototype.hasOwnProperty.call(B,U);return U}function D(B){var U=this;return function(){return U.apply(B,arguments)}}},{}],6:[function(e,g,n){n.read=function(y,r,t,a,f){var u,s,w=f*8-a-1,_=(1<<w)-1,S=_>>1,b=-7,p=t?f-1:0,i=t?-1:1,l=y[r+p];for(p+=i,u=l&(1<<-b)-1,l>>=-b,b+=w;b>0;u=u*256+y[r+p],p+=i,b-=8);for(s=u&(1<<-b)-1,u>>=-b,b+=a;b>0;s=s*256+y[r+p],p+=i,b-=8);if(u===0)u=1-S;else{if(u===_)return s?NaN:(l?-1:1)*(1/0);s=s+Math.pow(2,a),u=u-S}return(l?-1:1)*s*Math.pow(2,u-a)},n.write=function(y,r,t,a,f,u){var s,w,_,S=u*8-f-1,b=(1<<S)-1,p=b>>1,i=f===23?Math.pow(2,-24)-Math.pow(2,-77):0,l=a?0:u-1,d=a?1:-1,C=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(w=isNaN(r)?1:0,s=b):(s=Math.floor(Math.log(r)/Math.LN2),r*(_=Math.pow(2,-s))<1&&(s--,_*=2),s+p>=1?r+=i/_:r+=i*Math.pow(2,1-p),r*_>=2&&(s++,_/=2),s+p>=b?(w=0,s=b):s+p>=1?(w=(r*_-1)*Math.pow(2,f),s=s+p):(w=r*Math.pow(2,p-1)*Math.pow(2,f),s=0));f>=8;y[t+l]=w&255,l+=d,w/=256,f-=8);for(s=s<<f|w,S+=f;S>0;y[t+l]=s&255,l+=d,s/=256,S-=8);y[t+l-d]|=C*128}},{}],7:[function(e,g,n){(function(y){var r=y.MutationObserver||y.WebKitMutationObserver,t;if(r){var a=0,f=new r(S),u=y.document.createTextNode("");f.observe(u,{characterData:!0}),t=function(){u.data=a=++a%2}}else if(!y.setImmediate&&typeof y.MessageChannel<"u"){var s=new y.MessageChannel;s.port1.onmessage=S,t=function(){s.port2.postMessage(0)}}else"document"in y&&"onreadystatechange"in y.document.createElement("script")?t=function(){var p=y.document.createElement("script");p.onreadystatechange=function(){S(),p.onreadystatechange=null,p.parentNode.removeChild(p),p=null},y.document.documentElement.appendChild(p)}:t=function(){setTimeout(S,0)};var w,_=[];function S(){w=!0;for(var p,i,l=_.length;l;){for(i=_,_=[],p=-1;++p<l;)i[p]();l=_.length}w=!1}g.exports=b;function b(p){_.push(p)===1&&!w&&t()}}).call(this,typeof lt<"u"?lt:typeof self<"u"?self:typeof window<"u"?window:{})},{}],8:[function(e,g,n){typeof Object.create=="function"?g.exports=function(r,t){t&&(r.super_=t,r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}))}:g.exports=function(r,t){if(t){r.super_=t;var a=function(){};a.prototype=t.prototype,r.prototype=new a,r.prototype.constructor=r}}},{}],9:[function(e,g,n){g.exports=function(t){return t!=null&&(y(t)||r(t)||!!t._isBuffer)};function y(t){return!!t.constructor&&typeof t.constructor.isBuffer=="function"&&t.constructor.isBuffer(t)}function r(t){return typeof t.readFloatLE=="function"&&typeof t.slice=="function"&&y(t.slice(0,0))}},{}],10:[function(e,g,n){var y={}.toString;g.exports=Array.isArray||function(r){return y.call(r)=="[object Array]"}},{}],11:[function(e,g,n){var y=e("./utils"),r=e("./support"),t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.encode=function(a){for(var f=[],u,s,w,_,S,b,p,i=0,l=a.length,d=l,C=y.getTypeOf(a)!=="string";i<a.length;)d=l-i,C?(u=a[i++],s=i<l?a[i++]:0,w=i<l?a[i++]:0):(u=a.charCodeAt(i++),s=i<l?a.charCodeAt(i++):0,w=i<l?a.charCodeAt(i++):0),_=u>>2,S=(u&3)<<4|s>>4,b=d>1?(s&15)<<2|w>>6:64,p=d>2?w&63:64,f.push(t.charAt(_)+t.charAt(S)+t.charAt(b)+t.charAt(p));return f.join("")},n.decode=function(a){var f,u,s,w,_,S,b,p=0,i=0,l="data:";if(a.substr(0,l.length)===l)throw new Error("Invalid base64 input, it looks like a data url.");a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");var d=a.length*3/4;if(a.charAt(a.length-1)===t.charAt(64)&&d--,a.charAt(a.length-2)===t.charAt(64)&&d--,d%1!==0)throw new Error("Invalid base64 input, bad content length.");var C;for(r.uint8array?C=new Uint8Array(d|0):C=new Array(d|0);p<a.length;)w=t.indexOf(a.charAt(p++)),_=t.indexOf(a.charAt(p++)),S=t.indexOf(a.charAt(p++)),b=t.indexOf(a.charAt(p++)),f=w<<2|_>>4,u=(_&15)<<4|S>>2,s=(S&3)<<6|b,C[i++]=f,S!==64&&(C[i++]=u),b!==64&&(C[i++]=s);return C}},{"./support":40,"./utils":42}],12:[function(e,g,n){var y=e("./external"),r=e("./stream/DataWorker"),a=e("./stream/DataLengthProbe"),t=e("./stream/Crc32Probe"),a=e("./stream/DataLengthProbe");function f(u,s,w,_,S){this.compressedSize=u,this.uncompressedSize=s,this.crc32=w,this.compression=_,this.compressedContent=S}f.prototype={getContentWorker:function(){var u=new r(y.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new a("data_length")),s=this;return u.on("end",function(){if(this.streamInfo.data_length!==s.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),u},getCompressedWorker:function(){return new r(y.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},f.createWorkerFrom=function(u,s,w){return u.pipe(new t).pipe(new a("uncompressedSize")).pipe(s.compressWorker(w)).pipe(new a("compressedSize")).withStreamInfo("compression",s)},g.exports=f},{"./external":16,"./stream/Crc32Probe":35,"./stream/DataLengthProbe":36,"./stream/DataWorker":37}],13:[function(e,g,n){var y=e("./stream/GenericWorker");n.STORE={magic:"\0\0",compressWorker:function(r){return new y("STORE compression")},uncompressWorker:function(){return new y("STORE decompression")}},n.DEFLATE=e("./flate")},{"./flate":17,"./stream/GenericWorker":38}],14:[function(e,g,n){var y=e("./utils");function r(){for(var u,s=[],w=0;w<256;w++){u=w;for(var _=0;_<8;_++)u=u&1?3988292384^u>>>1:u>>>1;s[w]=u}return s}var t=r();function a(u,s,w,_){var S=t,b=_+w;u=u^-1;for(var p=_;p<b;p++)u=u>>>8^S[(u^s[p])&255];return u^-1}function f(u,s,w,_){var S=t,b=_+w;u=u^-1;for(var p=_;p<b;p++)u=u>>>8^S[(u^s.charCodeAt(p))&255];return u^-1}g.exports=function(s,w){if(typeof s>"u"||!s.length)return 0;var _=y.getTypeOf(s)!=="string";return _?a(w|0,s,s.length,0):f(w|0,s,s.length,0)}},{"./utils":42}],15:[function(e,g,n){n.base64=!1,n.binary=!1,n.dir=!1,n.createFolders=!0,n.date=null,n.compression=null,n.compressionOptions=null,n.comment=null,n.unixPermissions=null,n.dosPermissions=null},{}],16:[function(e,g,n){var y=null;typeof Promise<"u"?y=Promise:y=e("lie"),g.exports={Promise:y}},{lie:46}],17:[function(e,g,n){var y=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",r=e("pako"),t=e("./utils"),a=e("./stream/GenericWorker"),f=y?"uint8array":"array";n.magic="\b\0";function u(s,w){a.call(this,"FlateWorker/"+s),this._pako=null,this._pakoAction=s,this._pakoOptions=w,this.meta={}}t.inherits(u,a),u.prototype.processChunk=function(s){this.meta=s.meta,this._pako===null&&this._createPako(),this._pako.push(t.transformTo(f,s.data),!1)},u.prototype.flush=function(){a.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},u.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this._pako=null},u.prototype._createPako=function(){this._pako=new r[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var s=this;this._pako.onData=function(w){s.push({data:w,meta:s.meta})}},n.compressWorker=function(s){return new u("Deflate",s)},n.uncompressWorker=function(){return new u("Inflate",{})}},{"./stream/GenericWorker":38,"./utils":42,pako:47}],18:[function(e,g,n){var y=e("../utils"),r=e("../stream/GenericWorker"),t=e("../utf8"),a=e("../crc32"),f=e("../signature"),u=function(i,l){var d="",C;for(C=0;C<l;C++)d+=String.fromCharCode(i&255),i=i>>>8;return d},s=function(i,l){var d=i;return i||(d=l?16893:33204),(d&65535)<<16},w=function(i,l){return(i||0)&63},_=function(i,l,d,C,c,E){var O=i.file,P=i.compression,W=E!==t.utf8encode,A=y.transformTo("string",E(O.name)),ee=y.transformTo("string",t.utf8encode(O.name)),D=O.comment,B=y.transformTo("string",E(D)),U=y.transformTo("string",t.utf8encode(D)),x=ee.length!==O.name.length,z=U.length!==D.length,K,Y,$="",V="",ce="",ie=O.dir,de=O.date,ve={crc32:0,compressedSize:0,uncompressedSize:0};(!l||d)&&(ve.crc32=i.crc32,ve.compressedSize=i.compressedSize,ve.uncompressedSize=i.uncompressedSize);var Z=0;l&&(Z|=8),!W&&(x||z)&&(Z|=2048);var j=0,re=0;ie&&(j|=16),c==="UNIX"?(re=798,j|=s(O.unixPermissions,ie)):(re=20,j|=w(O.dosPermissions)),K=de.getUTCHours(),K=K<<6,K=K|de.getUTCMinutes(),K=K<<5,K=K|de.getUTCSeconds()/2,Y=de.getUTCFullYear()-1980,Y=Y<<4,Y=Y|de.getUTCMonth()+1,Y=Y<<5,Y=Y|de.getUTCDate(),x&&(V=u(1,1)+u(a(A),4)+ee,$+="up"+u(V.length,2)+V),z&&(ce=u(1,1)+u(a(B),4)+U,$+="uc"+u(ce.length,2)+ce);var ue="";ue+=`
\0`,ue+=u(Z,2),ue+=P.magic,ue+=u(K,2),ue+=u(Y,2),ue+=u(ve.crc32,4),ue+=u(ve.compressedSize,4),ue+=u(ve.uncompressedSize,4),ue+=u(A.length,2),ue+=u($.length,2);var ge=f.LOCAL_FILE_HEADER+ue+A+$,me=f.CENTRAL_FILE_HEADER+u(re,2)+ue+u(B.length,2)+"\0\0\0\0"+u(j,4)+u(C,4)+A+$+B;return{fileRecord:ge,dirRecord:me}},S=function(i,l,d,C,c){var E="",O=y.transformTo("string",c(C));return E=f.CENTRAL_DIRECTORY_END+"\0\0\0\0"+u(i,2)+u(i,2)+u(l,4)+u(d,4)+u(O.length,2)+O,E},b=function(i){var l="";return l=f.DATA_DESCRIPTOR+u(i.crc32,4)+u(i.compressedSize,4)+u(i.uncompressedSize,4),l};function p(i,l,d,C){r.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=l,this.zipPlatform=d,this.encodeFileName=C,this.streamFiles=i,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}y.inherits(p,r),p.prototype.push=function(i){var l=i.meta.percent||0,d=this.entriesCount,C=this._sources.length;this.accumulate?this.contentBuffer.push(i):(this.bytesWritten+=i.data.length,r.prototype.push.call(this,{data:i.data,meta:{currentFile:this.currentFile,percent:d?(l+100*(d-C-1))/d:100}}))},p.prototype.openedSource=function(i){this.currentSourceOffset=this.bytesWritten,this.currentFile=i.file.name;var l=this.streamFiles&&!i.file.dir;if(l){var d=_(i,l,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:d.fileRecord,meta:{percent:0}})}else this.accumulate=!0},p.prototype.closedSource=function(i){this.accumulate=!1;var l=this.streamFiles&&!i.file.dir,d=_(i,l,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(d.dirRecord),l)this.push({data:b(i),meta:{percent:100}});else for(this.push({data:d.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},p.prototype.flush=function(){for(var i=this.bytesWritten,l=0;l<this.dirRecords.length;l++)this.push({data:this.dirRecords[l],meta:{percent:100}});var d=this.bytesWritten-i,C=S(this.dirRecords.length,d,i,this.zipComment,this.encodeFileName);this.push({data:C,meta:{percent:100}})},p.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},p.prototype.registerPrevious=function(i){this._sources.push(i);var l=this;return i.on("data",function(d){l.processChunk(d)}),i.on("end",function(){l.closedSource(l.previous.streamInfo),l._sources.length?l.prepareNextSource():l.end()}),i.on("error",function(d){l.error(d)}),this},p.prototype.resume=function(){if(!r.prototype.resume.call(this))return!1;if(!this.previous&&this._sources.length)return this.prepareNextSource(),!0;if(!this.previous&&!this._sources.length&&!this.generatedError)return this.end(),!0},p.prototype.error=function(i){var l=this._sources;if(!r.prototype.error.call(this,i))return!1;for(var d=0;d<l.length;d++)try{l[d].error(i)}catch{}return!0},p.prototype.lock=function(){r.prototype.lock.call(this);for(var i=this._sources,l=0;l<i.length;l++)i[l].lock()},g.exports=p},{"../crc32":14,"../signature":33,"../stream/GenericWorker":38,"../utf8":41,"../utils":42}],19:[function(e,g,n){var y=e("../compressions"),r=e("./ZipFileWorker"),t=function(a,f){var u=a||f,s=y[u];if(!s)throw new Error(u+" is not a valid compression method !");return s};n.generateWorker=function(a,f,u){var s=new r(f.streamFiles,u,f.platform,f.encodeFileName),w=0;try{a.forEach(function(_,S){w++;var b=t(S.options.compression,f.compression),p=S.options.compressionOptions||f.compressionOptions||{},i=S.dir,l=S.date;S._compressWorker(b,p).withStreamInfo("file",{name:_,dir:i,date:l,comment:S.comment||"",unixPermissions:S.unixPermissions,dosPermissions:S.dosPermissions}).pipe(s)}),s.entriesCount=w}catch(_){s.error(_)}return s}},{"../compressions":13,"./ZipFileWorker":18}],20:[function(e,g,n){function y(){if(!(this instanceof y))return new y;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files={},this.comment=null,this.root="",this.clone=function(){var r=new y;for(var t in this)typeof this[t]!="function"&&(r[t]=this[t]);return r}}y.prototype=e("./object"),y.prototype.loadAsync=e("./load"),y.support=e("./support"),y.defaults=e("./defaults"),y.version="3.5.0",y.loadAsync=function(r,t){return new y().loadAsync(r,t)},y.external=e("./external"),g.exports=y},{"./defaults":15,"./external":16,"./load":21,"./object":25,"./support":40}],21:[function(e,g,n){var t=e("./utils"),y=e("./external"),r=e("./utf8"),t=e("./utils"),a=e("./zipEntries"),f=e("./stream/Crc32Probe"),u=e("./nodejsUtils");function s(w){return new y.Promise(function(_,S){var b=w.decompressed.getContentWorker().pipe(new f);b.on("error",function(p){S(p)}).on("end",function(){b.streamInfo.crc32!==w.decompressed.crc32?S(new Error("Corrupted zip : CRC32 mismatch")):_()}).resume()})}g.exports=function(w,_){var S=this;return _=t.extend(_||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:r.utf8decode}),u.isNode&&u.isStream(w)?y.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):t.prepareContent("the loaded zip file",w,!0,_.optimizedBinaryString,_.base64).then(function(b){var p=new a(_);return p.load(b),p}).then(function(p){var i=[y.Promise.resolve(p)],l=p.files;if(_.checkCRC32)for(var d=0;d<l.length;d++)i.push(s(l[d]));return y.Promise.all(i)}).then(function(p){for(var i=p.shift(),l=i.files,d=0;d<l.length;d++){var C=l[d];S.file(C.fileNameStr,C.decompressed,{binary:!0,optimizedBinaryString:!0,date:C.date,dir:C.dir,comment:C.fileCommentStr.length?C.fileCommentStr:null,unixPermissions:C.unixPermissions,dosPermissions:C.dosPermissions,createFolders:_.createFolders})}return i.zipComment.length&&(S.comment=i.zipComment),S})}},{"./external":16,"./nodejsUtils":22,"./stream/Crc32Probe":35,"./utf8":41,"./utils":42,"./zipEntries":43}],22:[function(e,g,n){(function(y){g.exports={isNode:typeof y<"u",newBufferFrom:function(r,t){if(y.from&&y.from!==Uint8Array.from)return y.from(r,t);if(typeof r=="number")throw new Error('The "data" argument must not be a number');return new y(r,t)},allocBuffer:function(r){if(y.alloc)return y.alloc(r);var t=new y(r);return t.fill(0),t},isBuffer:function(r){return y.isBuffer(r)},isStream:function(r){return r&&typeof r.on=="function"&&typeof r.pause=="function"&&typeof r.resume=="function"}}}).call(this,e("buffer").Buffer)},{buffer:3}],23:[function(e,g,n){var y=e("../utils"),r=e("../stream/GenericWorker");function t(a,f){r.call(this,"Nodejs stream input adapter for "+a),this._upstreamEnded=!1,this._bindStream(f)}y.inherits(t,r),t.prototype._bindStream=function(a){var f=this;this._stream=a,a.pause(),a.on("data",function(u){f.push({data:u,meta:{percent:0}})}).on("error",function(u){f.isPaused?this.generatedError=u:f.error(u)}).on("end",function(){f.isPaused?f._upstreamEnded=!0:f.end()})},t.prototype.pause=function(){return r.prototype.pause.call(this)?(this._stream.pause(),!0):!1},t.prototype.resume=function(){return r.prototype.resume.call(this)?(this._upstreamEnded?this.end():this._stream.resume(),!0):!1},g.exports=t},{"../stream/GenericWorker":38,"../utils":42}],24:[function(e,g,n){var y=e("readable-stream").Readable,r=e("../utils");r.inherits(t,y);function t(a,f,u){y.call(this,f),this._helper=a;var s=this;a.on("data",function(w,_){s.push(w)||s._helper.pause(),u&&u(_)}).on("error",function(w){s.emit("error",w)}).on("end",function(){s.push(null)})}t.prototype._read=function(){this._helper.resume()},g.exports=t},{"../utils":42,"readable-stream":26}],25:[function(e,g,n){var y=e("./utf8"),r=e("./utils"),t=e("./stream/GenericWorker"),a=e("./stream/StreamHelper"),f=e("./defaults"),u=e("./compressedObject"),s=e("./zipObject"),w=e("./generate"),_=e("./nodejsUtils"),S=e("./nodejs/NodejsStreamInputAdapter"),b=function(c,E,O){var P=r.getTypeOf(E),W,A=r.extend(O||{},f);A.date=A.date||new Date,A.compression!==null&&(A.compression=A.compression.toUpperCase()),typeof A.unixPermissions=="string"&&(A.unixPermissions=parseInt(A.unixPermissions,8)),A.unixPermissions&&A.unixPermissions&16384&&(A.dir=!0),A.dosPermissions&&A.dosPermissions&16&&(A.dir=!0),A.dir&&(c=i(c)),A.createFolders&&(W=p(c))&&l.call(this,W,!0);var ee=P==="string"&&A.binary===!1&&A.base64===!1;(!O||typeof O.binary>"u")&&(A.binary=!ee);var D=E instanceof u&&E.uncompressedSize===0;(D||A.dir||!E||E.length===0)&&(A.base64=!1,A.binary=!0,E="",A.compression="STORE",P="string");var B=null;E instanceof u||E instanceof t?B=E:_.isNode&&_.isStream(E)?B=new S(c,E):B=r.prepareContent(c,E,A.binary,A.optimizedBinaryString,A.base64);var U=new s(c,B,A);this.files[c]=U},p=function(c){c.slice(-1)==="/"&&(c=c.substring(0,c.length-1));var E=c.lastIndexOf("/");return E>0?c.substring(0,E):""},i=function(c){return c.slice(-1)!=="/"&&(c+="/"),c},l=function(c,E){return E=typeof E<"u"?E:f.createFolders,c=i(c),this.files[c]||b.call(this,c,null,{dir:!0,createFolders:E}),this.files[c]};function d(c){return Object.prototype.toString.call(c)==="[object RegExp]"}var C={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(c){var E,O,P;for(E in this.files)this.files.hasOwnProperty(E)&&(P=this.files[E],O=E.slice(this.root.length,E.length),O&&E.slice(0,this.root.length)===this.root&&c(O,P))},filter:function(c){var E=[];return this.forEach(function(O,P){c(O,P)&&E.push(P)}),E},file:function(c,E,O){if(arguments.length===1)if(d(c)){var P=c;return this.filter(function(A,ee){return!ee.dir&&P.test(A)})}else{var W=this.files[this.root+c];return W&&!W.dir?W:null}else c=this.root+c,b.call(this,c,E,O);return this},folder:function(c){if(!c)return this;if(d(c))return this.filter(function(W,A){return A.dir&&c.test(W)});var E=this.root+c,O=l.call(this,E),P=this.clone();return P.root=O.name,P},remove:function(c){c=this.root+c;var E=this.files[c];if(E||(c.slice(-1)!=="/"&&(c+="/"),E=this.files[c]),E&&!E.dir)delete this.files[c];else for(var O=this.filter(function(W,A){return A.name.slice(0,c.length)===c}),P=0;P<O.length;P++)delete this.files[O[P].name];return this},generate:function(c){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(c){var E,O={};try{if(O=r.extend(c||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:y.utf8encode}),O.type=O.type.toLowerCase(),O.compression=O.compression.toUpperCase(),O.type==="binarystring"&&(O.type="string"),!O.type)throw new Error("No output type specified.");r.checkSupport(O.type),(O.platform==="darwin"||O.platform==="freebsd"||O.platform==="linux"||O.platform==="sunos")&&(O.platform="UNIX"),O.platform==="win32"&&(O.platform="DOS");var P=O.comment||this.comment||"";E=w.generateWorker(this,O,P)}catch(W){E=new t("error"),E.error(W)}return new a(E,O.type||"string",O.mimeType)},generateAsync:function(c,E){return this.generateInternalStream(c).accumulate(E)},generateNodeStream:function(c,E){return c=c||{},c.type||(c.type="nodebuffer"),this.generateInternalStream(c).toNodejsStream(E)}};g.exports=C},{"./compressedObject":12,"./defaults":15,"./generate":19,"./nodejs/NodejsStreamInputAdapter":23,"./nodejsUtils":22,"./stream/GenericWorker":38,"./stream/StreamHelper":39,"./utf8":41,"./utils":42,"./zipObject":45}],26:[function(e,g,n){g.exports=e("stream")},{stream:80}],27:[function(e,g,n){var y=e("./DataReader"),r=e("../utils");function t(a){y.call(this,a);for(var f=0;f<this.data.length;f++)a[f]=a[f]&255}r.inherits(t,y),t.prototype.byteAt=function(a){return this.data[this.zero+a]},t.prototype.lastIndexOfSignature=function(a){for(var f=a.charCodeAt(0),u=a.charCodeAt(1),s=a.charCodeAt(2),w=a.charCodeAt(3),_=this.length-4;_>=0;--_)if(this.data[_]===f&&this.data[_+1]===u&&this.data[_+2]===s&&this.data[_+3]===w)return _-this.zero;return-1},t.prototype.readAndCheckSignature=function(a){var f=a.charCodeAt(0),u=a.charCodeAt(1),s=a.charCodeAt(2),w=a.charCodeAt(3),_=this.readData(4);return f===_[0]&&u===_[1]&&s===_[2]&&w===_[3]},t.prototype.readData=function(a){if(this.checkOffset(a),a===0)return[];var f=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,f},g.exports=t},{"../utils":42,"./DataReader":28}],28:[function(e,g,n){var y=e("../utils");function r(t){this.data=t,this.length=t.length,this.index=0,this.zero=0}r.prototype={checkOffset:function(t){this.checkIndex(this.index+t)},checkIndex:function(t){if(this.length<this.zero+t||t<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+t+"). Corrupted zip ?")},setIndex:function(t){this.checkIndex(t),this.index=t},skip:function(t){this.setIndex(this.index+t)},byteAt:function(t){},readInt:function(t){var a=0,f;for(this.checkOffset(t),f=this.index+t-1;f>=this.index;f--)a=(a<<8)+this.byteAt(f);return this.index+=t,a},readString:function(t){return y.transformTo("string",this.readData(t))},readData:function(t){},lastIndexOfSignature:function(t){},readAndCheckSignature:function(t){},readDate:function(){var t=this.readInt(4);return new Date(Date.UTC((t>>25&127)+1980,(t>>21&15)-1,t>>16&31,t>>11&31,t>>5&63,(t&31)<<1))}},g.exports=r},{"../utils":42}],29:[function(e,g,n){var y=e("./Uint8ArrayReader"),r=e("../utils");function t(a){y.call(this,a)}r.inherits(t,y),t.prototype.readData=function(a){this.checkOffset(a);var f=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,f},g.exports=t},{"../utils":42,"./Uint8ArrayReader":31}],30:[function(e,g,n){var y=e("./DataReader"),r=e("../utils");function t(a){y.call(this,a)}r.inherits(t,y),t.prototype.byteAt=function(a){return this.data.charCodeAt(this.zero+a)},t.prototype.lastIndexOfSignature=function(a){return this.data.lastIndexOf(a)-this.zero},t.prototype.readAndCheckSignature=function(a){var f=this.readData(4);return a===f},t.prototype.readData=function(a){this.checkOffset(a);var f=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,f},g.exports=t},{"../utils":42,"./DataReader":28}],31:[function(e,g,n){var y=e("./ArrayReader"),r=e("../utils");function t(a){y.call(this,a)}r.inherits(t,y),t.prototype.readData=function(a){if(this.checkOffset(a),a===0)return new Uint8Array(0);var f=this.data.subarray(this.zero+this.index,this.zero+this.index+a);return this.index+=a,f},g.exports=t},{"../utils":42,"./ArrayReader":27}],32:[function(e,g,n){var y=e("../utils"),r=e("../support"),t=e("./ArrayReader"),a=e("./StringReader"),f=e("./NodeBufferReader"),u=e("./Uint8ArrayReader");g.exports=function(s){var w=y.getTypeOf(s);return y.checkSupport(w),w==="string"&&!r.uint8array?new a(s):w==="nodebuffer"?new f(s):r.uint8array?new u(y.transformTo("uint8array",s)):new t(y.transformTo("array",s))}},{"../support":40,"../utils":42,"./ArrayReader":27,"./NodeBufferReader":29,"./StringReader":30,"./Uint8ArrayReader":31}],33:[function(e,g,n){n.LOCAL_FILE_HEADER="PK",n.CENTRAL_FILE_HEADER="PK",n.CENTRAL_DIRECTORY_END="PK",n.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",n.ZIP64_CENTRAL_DIRECTORY_END="PK",n.DATA_DESCRIPTOR="PK\x07\b"},{}],34:[function(e,g,n){var y=e("./GenericWorker"),r=e("../utils");function t(a){y.call(this,"ConvertWorker to "+a),this.destType=a}r.inherits(t,y),t.prototype.processChunk=function(a){this.push({data:r.transformTo(this.destType,a.data),meta:a.meta})},g.exports=t},{"../utils":42,"./GenericWorker":38}],35:[function(e,g,n){var y=e("./GenericWorker"),r=e("../crc32"),t=e("../utils");function a(){y.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}t.inherits(a,y),a.prototype.processChunk=function(f){this.streamInfo.crc32=r(f.data,this.streamInfo.crc32||0),this.push(f)},g.exports=a},{"../crc32":14,"../utils":42,"./GenericWorker":38}],36:[function(e,g,n){var y=e("../utils"),r=e("./GenericWorker");function t(a){r.call(this,"DataLengthProbe for "+a),this.propName=a,this.withStreamInfo(a,0)}y.inherits(t,r),t.prototype.processChunk=function(a){if(a){var f=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=f+a.data.length}r.prototype.processChunk.call(this,a)},g.exports=t},{"../utils":42,"./GenericWorker":38}],37:[function(e,g,n){var y=e("../utils"),r=e("./GenericWorker"),t=16*1024;function a(f){r.call(this,"DataWorker");var u=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,f.then(function(s){u.dataIsReady=!0,u.data=s,u.max=s&&s.length||0,u.type=y.getTypeOf(s),u.isPaused||u._tickAndRepeat()},function(s){u.error(s)})}y.inherits(a,r),a.prototype.cleanUp=function(){r.prototype.cleanUp.call(this),this.data=null},a.prototype.resume=function(){return r.prototype.resume.call(this)?(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,y.delay(this._tickAndRepeat,[],this)),!0):!1},a.prototype._tickAndRepeat=function(){this._tickScheduled=!1,!(this.isPaused||this.isFinished)&&(this._tick(),this.isFinished||(y.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},a.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var f=t,u=null,s=Math.min(this.max,this.index+f);if(this.index>=this.max)return this.end();switch(this.type){case"string":u=this.data.substring(this.index,s);break;case"uint8array":u=this.data.subarray(this.index,s);break;case"array":case"nodebuffer":u=this.data.slice(this.index,s);break}return this.index=s,this.push({data:u,meta:{percent:this.max?this.index/this.max*100:0}})},g.exports=a},{"../utils":42,"./GenericWorker":38}],38:[function(e,g,n){function y(r){this.name=r||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}y.prototype={push:function(r){this.emit("data",r)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(r){this.emit("error",r)}return!0},error:function(r){return this.isFinished?!1:(this.isPaused?this.generatedError=r:(this.isFinished=!0,this.emit("error",r),this.previous&&this.previous.error(r),this.cleanUp()),!0)},on:function(r,t){return this._listeners[r].push(t),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(r,t){if(this._listeners[r])for(var a=0;a<this._listeners[r].length;a++)this._listeners[r][a].call(this,t)},pipe:function(r){return r.registerPrevious(this)},registerPrevious:function(r){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=r.streamInfo,this.mergeStreamInfo(),this.previous=r;var t=this;return r.on("data",function(a){t.processChunk(a)}),r.on("end",function(){t.end()}),r.on("error",function(a){t.error(a)}),this},pause:function(){return this.isPaused||this.isFinished?!1:(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var r=!1;return this.generatedError&&(this.error(this.generatedError),r=!0),this.previous&&this.previous.resume(),!r},flush:function(){},processChunk:function(r){this.push(r)},withStreamInfo:function(r,t){return this.extraStreamInfo[r]=t,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var r in this.extraStreamInfo)this.extraStreamInfo.hasOwnProperty(r)&&(this.streamInfo[r]=this.extraStreamInfo[r])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var r="Worker "+this.name;return this.previous?this.previous+" -> "+r:r}},g.exports=y},{}],39:[function(e,g,n){(function(y){var r=e("../utils"),t=e("./ConvertWorker"),a=e("./GenericWorker"),f=e("../base64"),u=e("../support"),s=e("../external"),w=null;if(u.nodestream)try{w=e("../nodejs/NodejsStreamOutputAdapter")}catch{}function _(i,l,d){switch(i){case"blob":return r.newBlob(r.transformTo("arraybuffer",l),d);case"base64":return f.encode(l);default:return r.transformTo(i,l)}}function S(i,l){var d,C=0,c=null,E=0;for(d=0;d<l.length;d++)E+=l[d].length;switch(i){case"string":return l.join("");case"array":return Array.prototype.concat.apply([],l);case"uint8array":for(c=new Uint8Array(E),d=0;d<l.length;d++)c.set(l[d],C),C+=l[d].length;return c;case"nodebuffer":return y.concat(l);default:throw new Error("concat : unsupported type '"+i+"'")}}function b(i,l){return new s.Promise(function(d,C){var c=[],E=i._internalType,O=i._outputType,P=i._mimeType;i.on("data",function(W,A){c.push(W),l&&l(A)}).on("error",function(W){c=[],C(W)}).on("end",function(){try{var W=_(O,S(E,c),P);d(W)}catch(A){C(A)}c=[]}).resume()})}function p(i,l,d){var C=l;switch(l){case"blob":case"arraybuffer":C="uint8array";break;case"base64":C="string";break}try{this._internalType=C,this._outputType=l,this._mimeType=d,r.checkSupport(C),this._worker=i.pipe(new t(C)),i.lock()}catch(c){this._worker=new a("error"),this._worker.error(c)}}p.prototype={accumulate:function(i){return b(this,i)},on:function(i,l){var d=this;return i==="data"?this._worker.on(i,function(C){l.call(d,C.data,C.meta)}):this._worker.on(i,function(){r.delay(l,arguments,d)}),this},resume:function(){return r.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(i){if(r.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new w(this,{objectMode:this._outputType!=="nodebuffer"},i)}},g.exports=p}).call(this,e("buffer").Buffer)},{"../base64":11,"../external":16,"../nodejs/NodejsStreamOutputAdapter":24,"../support":40,"../utils":42,"./ConvertWorker":34,"./GenericWorker":38,buffer:3}],40:[function(e,g,n){(function(y){if(n.base64=!0,n.array=!0,n.string=!0,n.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",n.nodebuffer=typeof y<"u",n.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")n.blob=!1;else{var r=new ArrayBuffer(0);try{n.blob=new Blob([r],{type:"application/zip"}).size===0}catch{try{var t=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,a=new t;a.append(r),n.blob=a.getBlob("application/zip").size===0}catch{n.blob=!1}}}try{n.nodestream=!!e("readable-stream").Readable}catch{n.nodestream=!1}}).call(this,e("buffer").Buffer)},{buffer:3,"readable-stream":26}],41:[function(e,g,n){for(var y=e("./utils"),r=e("./support"),t=e("./nodejsUtils"),a=e("./stream/GenericWorker"),f=new Array(256),u=0;u<256;u++)f[u]=u>=252?6:u>=248?5:u>=240?4:u>=224?3:u>=192?2:1;f[254]=f[254]=1;var s=function(p){var i,l,d,C,c,E=p.length,O=0;for(C=0;C<E;C++)l=p.charCodeAt(C),(l&64512)===55296&&C+1<E&&(d=p.charCodeAt(C+1),(d&64512)===56320&&(l=65536+(l-55296<<10)+(d-56320),C++)),O+=l<128?1:l<2048?2:l<65536?3:4;for(r.uint8array?i=new Uint8Array(O):i=new Array(O),c=0,C=0;c<O;C++)l=p.charCodeAt(C),(l&64512)===55296&&C+1<E&&(d=p.charCodeAt(C+1),(d&64512)===56320&&(l=65536+(l-55296<<10)+(d-56320),C++)),l<128?i[c++]=l:l<2048?(i[c++]=192|l>>>6,i[c++]=128|l&63):l<65536?(i[c++]=224|l>>>12,i[c++]=128|l>>>6&63,i[c++]=128|l&63):(i[c++]=240|l>>>18,i[c++]=128|l>>>12&63,i[c++]=128|l>>>6&63,i[c++]=128|l&63);return i},w=function(p,i){var l;for(i=i||p.length,i>p.length&&(i=p.length),l=i-1;l>=0&&(p[l]&192)===128;)l--;return l<0||l===0?i:l+f[p[l]]>i?l:i},_=function(p){var i,l,d,C,c=p.length,E=new Array(c*2);for(l=0,i=0;i<c;){if(d=p[i++],d<128){E[l++]=d;continue}if(C=f[d],C>4){E[l++]=65533,i+=C-1;continue}for(d&=C===2?31:C===3?15:7;C>1&&i<c;)d=d<<6|p[i++]&63,C--;if(C>1){E[l++]=65533;continue}d<65536?E[l++]=d:(d-=65536,E[l++]=55296|d>>10&1023,E[l++]=56320|d&1023)}return E.length!==l&&(E.subarray?E=E.subarray(0,l):E.length=l),y.applyFromCharCode(E)};n.utf8encode=function(i){return r.nodebuffer?t.newBufferFrom(i,"utf-8"):s(i)},n.utf8decode=function(i){return r.nodebuffer?y.transformTo("nodebuffer",i).toString("utf-8"):(i=y.transformTo(r.uint8array?"uint8array":"array",i),_(i))};function S(){a.call(this,"utf-8 decode"),this.leftOver=null}y.inherits(S,a),S.prototype.processChunk=function(p){var i=y.transformTo(r.uint8array?"uint8array":"array",p.data);if(this.leftOver&&this.leftOver.length){if(r.uint8array){var l=i;i=new Uint8Array(l.length+this.leftOver.length),i.set(this.leftOver,0),i.set(l,this.leftOver.length)}else i=this.leftOver.concat(i);this.leftOver=null}var d=w(i),C=i;d!==i.length&&(r.uint8array?(C=i.subarray(0,d),this.leftOver=i.subarray(d,i.length)):(C=i.slice(0,d),this.leftOver=i.slice(d,i.length))),this.push({data:n.utf8decode(C),meta:p.meta})},S.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:n.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},n.Utf8DecodeWorker=S;function b(){a.call(this,"utf-8 encode")}y.inherits(b,a),b.prototype.processChunk=function(p){this.push({data:n.utf8encode(p.data),meta:p.meta})},n.Utf8EncodeWorker=b},{"./nodejsUtils":22,"./stream/GenericWorker":38,"./support":40,"./utils":42}],42:[function(e,g,n){var y=e("./support"),r=e("./base64"),t=e("./nodejsUtils"),a=e("set-immediate-shim"),f=e("./external");function u(i){var l=null;return y.uint8array?l=new Uint8Array(i.length):l=new Array(i.length),w(i,l)}n.newBlob=function(i,l){n.checkSupport("blob");try{return new Blob([i],{type:l})}catch{try{var d=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,C=new d;return C.append(i),C.getBlob(l)}catch{throw new Error("Bug : can't construct the Blob.")}}};function s(i){return i}function w(i,l){for(var d=0;d<i.length;++d)l[d]=i.charCodeAt(d)&255;return l}var _={stringifyByChunk:function(i,l,d){var C=[],c=0,E=i.length;if(E<=d)return String.fromCharCode.apply(null,i);for(;c<E;)l==="array"||l==="nodebuffer"?C.push(String.fromCharCode.apply(null,i.slice(c,Math.min(c+d,E)))):C.push(String.fromCharCode.apply(null,i.subarray(c,Math.min(c+d,E)))),c+=d;return C.join("")},stringifyByChar:function(i){for(var l="",d=0;d<i.length;d++)l+=String.fromCharCode(i[d]);return l},applyCanBeUsed:{uint8array:(function(){try{return y.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return y.nodebuffer&&String.fromCharCode.apply(null,t.allocBuffer(1)).length===1}catch{return!1}})()}};function S(i){var l=65536,d=n.getTypeOf(i),C=!0;if(d==="uint8array"?C=_.applyCanBeUsed.uint8array:d==="nodebuffer"&&(C=_.applyCanBeUsed.nodebuffer),C)for(;l>1;)try{return _.stringifyByChunk(i,d,l)}catch{l=Math.floor(l/2)}return _.stringifyByChar(i)}n.applyFromCharCode=S;function b(i,l){for(var d=0;d<i.length;d++)l[d]=i[d];return l}var p={};p.string={string:s,array:function(i){return w(i,new Array(i.length))},arraybuffer:function(i){return p.string.uint8array(i).buffer},uint8array:function(i){return w(i,new Uint8Array(i.length))},nodebuffer:function(i){return w(i,t.allocBuffer(i.length))}},p.array={string:S,array:s,arraybuffer:function(i){return new Uint8Array(i).buffer},uint8array:function(i){return new Uint8Array(i)},nodebuffer:function(i){return t.newBufferFrom(i)}},p.arraybuffer={string:function(i){return S(new Uint8Array(i))},array:function(i){return b(new Uint8Array(i),new Array(i.byteLength))},arraybuffer:s,uint8array:function(i){return new Uint8Array(i)},nodebuffer:function(i){return t.newBufferFrom(new Uint8Array(i))}},p.uint8array={string:S,array:function(i){return b(i,new Array(i.length))},arraybuffer:function(i){return i.buffer},uint8array:s,nodebuffer:function(i){return t.newBufferFrom(i)}},p.nodebuffer={string:S,array:function(i){return b(i,new Array(i.length))},arraybuffer:function(i){return p.nodebuffer.uint8array(i).buffer},uint8array:function(i){return b(i,new Uint8Array(i.length))},nodebuffer:s},n.transformTo=function(i,l){if(l||(l=""),!i)return l;n.checkSupport(i);var d=n.getTypeOf(l),C=p[d][i](l);return C},n.getTypeOf=function(i){if(typeof i=="string")return"string";if(Object.prototype.toString.call(i)==="[object Array]")return"array";if(y.nodebuffer&&t.isBuffer(i))return"nodebuffer";if(y.uint8array&&i instanceof Uint8Array)return"uint8array";if(y.arraybuffer&&i instanceof ArrayBuffer)return"arraybuffer"},n.checkSupport=function(i){var l=y[i.toLowerCase()];if(!l)throw new Error(i+" is not supported by this platform")},n.MAX_VALUE_16BITS=65535,n.MAX_VALUE_32BITS=-1,n.pretty=function(i){var l="",d,C;for(C=0;C<(i||"").length;C++)d=i.charCodeAt(C),l+="\\x"+(d<16?"0":"")+d.toString(16).toUpperCase();return l},n.delay=function(i,l,d){a(function(){i.apply(d||null,l||[])})},n.inherits=function(i,l){var d=function(){};d.prototype=l.prototype,i.prototype=new d},n.extend=function(){var i={},l,d;for(l=0;l<arguments.length;l++)for(d in arguments[l])arguments[l].hasOwnProperty(d)&&typeof i[d]>"u"&&(i[d]=arguments[l][d]);return i},n.prepareContent=function(i,l,d,C,c){var E=f.Promise.resolve(l).then(function(O){var P=y.blob&&(O instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(O))!==-1);return P&&typeof FileReader<"u"?new f.Promise(function(W,A){var ee=new FileReader;ee.onload=function(D){W(D.target.result)},ee.onerror=function(D){A(D.target.error)},ee.readAsArrayBuffer(O)}):O});return E.then(function(O){var P=n.getTypeOf(O);return P?(P==="arraybuffer"?O=n.transformTo("uint8array",O):P==="string"&&(c?O=r.decode(O):d&&C!==!0&&(O=u(O))),O):f.Promise.reject(new Error("Can't read the data of '"+i+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":11,"./external":16,"./nodejsUtils":22,"./support":40,"set-immediate-shim":79}],43:[function(e,g,n){var y=e("./reader/readerFor"),r=e("./utils"),t=e("./signature"),a=e("./zipEntry");e("./utf8");var f=e("./support");function u(s){this.files=[],this.loadOptions=s}u.prototype={checkSignature:function(s){if(!this.reader.readAndCheckSignature(s)){this.reader.index-=4;var w=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+r.pretty(w)+", expected "+r.pretty(s)+")")}},isSignature:function(s,w){var _=this.reader.index;this.reader.setIndex(s);var S=this.reader.readString(4),b=S===w;return this.reader.setIndex(_),b},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var s=this.reader.readData(this.zipCommentLength),w=f.uint8array?"uint8array":"array",_=r.transformTo(w,s);this.zipComment=this.loadOptions.decodeFileName(_)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var s=this.zip64EndOfCentralSize-44,w=0,_,S,b;w<s;)_=this.reader.readInt(2),S=this.reader.readInt(4),b=this.reader.readData(S),this.zip64ExtensibleData[_]={id:_,length:S,value:b}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var s,w;for(s=0;s<this.files.length;s++)w=this.files[s],this.reader.setIndex(w.localHeaderOffset),this.checkSignature(t.LOCAL_FILE_HEADER),w.readLocalPart(this.reader),w.handleUTF8(),w.processAttributes()},readCentralDir:function(){var s;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(t.CENTRAL_FILE_HEADER);)s=new a({zip64:this.zip64},this.loadOptions),s.readCentralPart(this.reader),this.files.push(s);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var s=this.reader.lastIndexOfSignature(t.CENTRAL_DIRECTORY_END);if(s<0){var w=!this.isSignature(0,t.LOCAL_FILE_HEADER);throw w?new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip: can't find end of central directory")}this.reader.setIndex(s);var _=s;if(this.checkSignature(t.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===r.MAX_VALUE_16BITS||this.diskWithCentralDirStart===r.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===r.MAX_VALUE_16BITS||this.centralDirRecords===r.MAX_VALUE_16BITS||this.centralDirSize===r.MAX_VALUE_32BITS||this.centralDirOffset===r.MAX_VALUE_32BITS){if(this.zip64=!0,s=this.reader.lastIndexOfSignature(t.ZIP64_CENTRAL_DIRECTORY_LOCATOR),s<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(s),this.checkSignature(t.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,t.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(t.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(t.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var S=this.centralDirOffset+this.centralDirSize;this.zip64&&(S+=20,S+=12+this.zip64EndOfCentralSize);var b=_-S;if(b>0)this.isSignature(_,t.CENTRAL_FILE_HEADER)||(this.reader.zero=b);else if(b<0)throw new Error("Corrupted zip: missing "+Math.abs(b)+" bytes.")},prepareReader:function(s){this.reader=y(s)},load:function(s){this.prepareReader(s),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},g.exports=u},{"./reader/readerFor":32,"./signature":33,"./support":40,"./utf8":41,"./utils":42,"./zipEntry":44}],44:[function(e,g,n){var y=e("./reader/readerFor"),r=e("./utils"),t=e("./compressedObject"),a=e("./crc32"),f=e("./utf8"),u=e("./compressions"),s=e("./support"),w=0,_=3,S=function(p){for(var i in u)if(u.hasOwnProperty(i)&&u[i].magic===p)return u[i];return null};function b(p,i){this.options=p,this.loadOptions=i}b.prototype={isEncrypted:function(){return(this.bitFlag&1)===1},useUTF8:function(){return(this.bitFlag&2048)===2048},readLocalPart:function(p){var i,l;if(p.skip(22),this.fileNameLength=p.readInt(2),l=p.readInt(2),this.fileName=p.readData(this.fileNameLength),p.skip(l),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(i=S(this.compressionMethod),i===null)throw new Error("Corrupted zip : compression "+r.pretty(this.compressionMethod)+" unknown (inner file : "+r.transformTo("string",this.fileName)+")");this.decompressed=new t(this.compressedSize,this.uncompressedSize,this.crc32,i,p.readData(this.compressedSize))},readCentralPart:function(p){this.versionMadeBy=p.readInt(2),p.skip(2),this.bitFlag=p.readInt(2),this.compressionMethod=p.readString(2),this.date=p.readDate(),this.crc32=p.readInt(4),this.compressedSize=p.readInt(4),this.uncompressedSize=p.readInt(4);var i=p.readInt(2);if(this.extraFieldsLength=p.readInt(2),this.fileCommentLength=p.readInt(2),this.diskNumberStart=p.readInt(2),this.internalFileAttributes=p.readInt(2),this.externalFileAttributes=p.readInt(4),this.localHeaderOffset=p.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");p.skip(i),this.readExtraFields(p),this.parseZIP64ExtraField(p),this.fileComment=p.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var p=this.versionMadeBy>>8;this.dir=!!(this.externalFileAttributes&16),p===w&&(this.dosPermissions=this.externalFileAttributes&63),p===_&&(this.unixPermissions=this.externalFileAttributes>>16&65535),!this.dir&&this.fileNameStr.slice(-1)==="/"&&(this.dir=!0)},parseZIP64ExtraField:function(p){if(this.extraFields[1]){var i=y(this.extraFields[1].value);this.uncompressedSize===r.MAX_VALUE_32BITS&&(this.uncompressedSize=i.readInt(8)),this.compressedSize===r.MAX_VALUE_32BITS&&(this.compressedSize=i.readInt(8)),this.localHeaderOffset===r.MAX_VALUE_32BITS&&(this.localHeaderOffset=i.readInt(8)),this.diskNumberStart===r.MAX_VALUE_32BITS&&(this.diskNumberStart=i.readInt(4))}},readExtraFields:function(p){var i=p.index+this.extraFieldsLength,l,d,C;for(this.extraFields||(this.extraFields={});p.index+4<i;)l=p.readInt(2),d=p.readInt(2),C=p.readData(d),this.extraFields[l]={id:l,length:d,value:C};p.setIndex(i)},handleUTF8:function(){var p=s.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=f.utf8decode(this.fileName),this.fileCommentStr=f.utf8decode(this.fileComment);else{var i=this.findExtraFieldUnicodePath();if(i!==null)this.fileNameStr=i;else{var l=r.transformTo(p,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(l)}var d=this.findExtraFieldUnicodeComment();if(d!==null)this.fileCommentStr=d;else{var C=r.transformTo(p,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(C)}}},findExtraFieldUnicodePath:function(){var p=this.extraFields[28789];if(p){var i=y(p.value);return i.readInt(1)!==1||a(this.fileName)!==i.readInt(4)?null:f.utf8decode(i.readData(p.length-5))}return null},findExtraFieldUnicodeComment:function(){var p=this.extraFields[25461];if(p){var i=y(p.value);return i.readInt(1)!==1||a(this.fileComment)!==i.readInt(4)?null:f.utf8decode(i.readData(p.length-5))}return null}},g.exports=b},{"./compressedObject":12,"./compressions":13,"./crc32":14,"./reader/readerFor":32,"./support":40,"./utf8":41,"./utils":42}],45:[function(e,g,n){var y=e("./stream/StreamHelper"),r=e("./stream/DataWorker"),t=e("./utf8"),a=e("./compressedObject"),f=e("./stream/GenericWorker"),u=function(S,b,p){this.name=S,this.dir=p.dir,this.date=p.date,this.comment=p.comment,this.unixPermissions=p.unixPermissions,this.dosPermissions=p.dosPermissions,this._data=b,this._dataBinary=p.binary,this.options={compression:p.compression,compressionOptions:p.compressionOptions}};u.prototype={internalStream:function(S){var b=null,p="string";try{if(!S)throw new Error("No output type specified.");p=S.toLowerCase();var i=p==="string"||p==="text";(p==="binarystring"||p==="text")&&(p="string"),b=this._decompressWorker();var l=!this._dataBinary;l&&!i&&(b=b.pipe(new t.Utf8EncodeWorker)),!l&&i&&(b=b.pipe(new t.Utf8DecodeWorker))}catch(d){b=new f("error"),b.error(d)}return new y(b,p,"")},async:function(S,b){return this.internalStream(S).accumulate(b)},nodeStream:function(S,b){return this.internalStream(S||"nodebuffer").toNodejsStream(b)},_compressWorker:function(S,b){if(this._data instanceof a&&this._data.compression.magic===S.magic)return this._data.getCompressedWorker();var p=this._decompressWorker();return this._dataBinary||(p=p.pipe(new t.Utf8EncodeWorker)),a.createWorkerFrom(p,S,b)},_decompressWorker:function(){return this._data instanceof a?this._data.getContentWorker():this._data instanceof f?this._data:new r(this._data)}};for(var s=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],w=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},_=0;_<s.length;_++)u.prototype[s[_]]=w;g.exports=u},{"./compressedObject":12,"./stream/DataWorker":37,"./stream/GenericWorker":38,"./stream/StreamHelper":39,"./utf8":41}],46:[function(e,g,n){var y=e("immediate");function r(){}var t={},a=["REJECTED"],f=["FULFILLED"],u=["PENDING"];g.exports=s;function s(c){if(typeof c!="function")throw new TypeError("resolver must be a function");this.state=u,this.queue=[],this.outcome=void 0,c!==r&&b(this,c)}s.prototype.finally=function(c){if(typeof c!="function")return this;var E=this.constructor;return this.then(O,P);function O(W){function A(){return W}return E.resolve(c()).then(A)}function P(W){function A(){throw W}return E.resolve(c()).then(A)}},s.prototype.catch=function(c){return this.then(null,c)},s.prototype.then=function(c,E){if(typeof c!="function"&&this.state===f||typeof E!="function"&&this.state===a)return this;var O=new this.constructor(r);if(this.state!==u){var P=this.state===f?c:E;_(O,P,this.outcome)}else this.queue.push(new w(O,c,E));return O};function w(c,E,O){this.promise=c,typeof E=="function"&&(this.onFulfilled=E,this.callFulfilled=this.otherCallFulfilled),typeof O=="function"&&(this.onRejected=O,this.callRejected=this.otherCallRejected)}w.prototype.callFulfilled=function(c){t.resolve(this.promise,c)},w.prototype.otherCallFulfilled=function(c){_(this.promise,this.onFulfilled,c)},w.prototype.callRejected=function(c){t.reject(this.promise,c)},w.prototype.otherCallRejected=function(c){_(this.promise,this.onRejected,c)};function _(c,E,O){y(function(){var P;try{P=E(O)}catch(W){return t.reject(c,W)}P===c?t.reject(c,new TypeError("Cannot resolve promise with itself")):t.resolve(c,P)})}t.resolve=function(c,E){var O=p(S,E);if(O.status==="error")return t.reject(c,O.value);var P=O.value;if(P)b(c,P);else{c.state=f,c.outcome=E;for(var W=-1,A=c.queue.length;++W<A;)c.queue[W].callFulfilled(E)}return c},t.reject=function(c,E){c.state=a,c.outcome=E;for(var O=-1,P=c.queue.length;++O<P;)c.queue[O].callRejected(E);return c};function S(c){var E=c&&c.then;if(c&&(typeof c=="object"||typeof c=="function")&&typeof E=="function")return function(){E.apply(c,arguments)}}function b(c,E){var O=!1;function P(D){O||(O=!0,t.reject(c,D))}function W(D){O||(O=!0,t.resolve(c,D))}function A(){E(W,P)}var ee=p(A);ee.status==="error"&&P(ee.value)}function p(c,E){var O={};try{O.value=c(E),O.status="success"}catch(P){O.status="error",O.value=P}return O}s.resolve=i;function i(c){return c instanceof this?c:t.resolve(new this(r),c)}s.reject=l;function l(c){var E=new this(r);return t.reject(E,c)}s.all=d;function d(c){var E=this;if(Object.prototype.toString.call(c)!=="[object Array]")return this.reject(new TypeError("must be an array"));var O=c.length,P=!1;if(!O)return this.resolve([]);for(var W=new Array(O),A=0,ee=-1,D=new this(r);++ee<O;)B(c[ee],ee);return D;function B(U,x){E.resolve(U).then(z,function(K){P||(P=!0,t.reject(D,K))});function z(K){W[x]=K,++A===O&&!P&&(P=!0,t.resolve(D,W))}}}s.race=C;function C(c){var E=this;if(Object.prototype.toString.call(c)!=="[object Array]")return this.reject(new TypeError("must be an array"));var O=c.length,P=!1;if(!O)return this.resolve([]);for(var W=-1,A=new this(r);++W<O;)ee(c[W]);return A;function ee(D){E.resolve(D).then(function(B){P||(P=!0,t.resolve(A,B))},function(B){P||(P=!0,t.reject(A,B))})}}},{immediate:7}],47:[function(e,g,n){var y=e("./lib/utils/common").assign,r=e("./lib/deflate"),t=e("./lib/inflate"),a=e("./lib/zlib/constants"),f={};y(f,r,t,a),g.exports=f},{"./lib/deflate":48,"./lib/inflate":49,"./lib/utils/common":50,"./lib/zlib/constants":53}],48:[function(e,g,n){var y=e("./zlib/deflate"),r=e("./utils/common"),t=e("./utils/strings"),a=e("./zlib/messages"),f=e("./zlib/zstream"),u=Object.prototype.toString,s=0,w=4,_=0,S=1,b=2,p=-1,i=0,l=8;function d(O){if(!(this instanceof d))return new d(O);this.options=r.assign({level:p,method:l,chunkSize:16384,windowBits:15,memLevel:8,strategy:i,to:""},O||{});var P=this.options;P.raw&&P.windowBits>0?P.windowBits=-P.windowBits:P.gzip&&P.windowBits>0&&P.windowBits<16&&(P.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new f,this.strm.avail_out=0;var W=y.deflateInit2(this.strm,P.level,P.method,P.windowBits,P.memLevel,P.strategy);if(W!==_)throw new Error(a[W]);if(P.header&&y.deflateSetHeader(this.strm,P.header),P.dictionary){var A;if(typeof P.dictionary=="string"?A=t.string2buf(P.dictionary):u.call(P.dictionary)==="[object ArrayBuffer]"?A=new Uint8Array(P.dictionary):A=P.dictionary,W=y.deflateSetDictionary(this.strm,A),W!==_)throw new Error(a[W]);this._dict_set=!0}}d.prototype.push=function(O,P){var W=this.strm,A=this.options.chunkSize,ee,D;if(this.ended)return!1;D=P===~~P?P:P===!0?w:s,typeof O=="string"?W.input=t.string2buf(O):u.call(O)==="[object ArrayBuffer]"?W.input=new Uint8Array(O):W.input=O,W.next_in=0,W.avail_in=W.input.length;do{if(W.avail_out===0&&(W.output=new r.Buf8(A),W.next_out=0,W.avail_out=A),ee=y.deflate(W,D),ee!==S&&ee!==_)return this.onEnd(ee),this.ended=!0,!1;(W.avail_out===0||W.avail_in===0&&(D===w||D===b))&&(this.options.to==="string"?this.onData(t.buf2binstring(r.shrinkBuf(W.output,W.next_out))):this.onData(r.shrinkBuf(W.output,W.next_out)))}while((W.avail_in>0||W.avail_out===0)&&ee!==S);return D===w?(ee=y.deflateEnd(this.strm),this.onEnd(ee),this.ended=!0,ee===_):(D===b&&(this.onEnd(_),W.avail_out=0),!0)},d.prototype.onData=function(O){this.chunks.push(O)},d.prototype.onEnd=function(O){O===_&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=O,this.msg=this.strm.msg};function C(O,P){var W=new d(P);if(W.push(O,!0),W.err)throw W.msg||a[W.err];return W.result}function c(O,P){return P=P||{},P.raw=!0,C(O,P)}function E(O,P){return P=P||{},P.gzip=!0,C(O,P)}n.Deflate=d,n.deflate=C,n.deflateRaw=c,n.gzip=E},{"./utils/common":50,"./utils/strings":51,"./zlib/deflate":55,"./zlib/messages":60,"./zlib/zstream":62}],49:[function(e,g,n){var y=e("./zlib/inflate"),r=e("./utils/common"),t=e("./utils/strings"),a=e("./zlib/constants"),f=e("./zlib/messages"),u=e("./zlib/zstream"),s=e("./zlib/gzheader"),w=Object.prototype.toString;function _(p){if(!(this instanceof _))return new _(p);this.options=r.assign({chunkSize:16384,windowBits:0,to:""},p||{});var i=this.options;i.raw&&i.windowBits>=0&&i.windowBits<16&&(i.windowBits=-i.windowBits,i.windowBits===0&&(i.windowBits=-15)),i.windowBits>=0&&i.windowBits<16&&!(p&&p.windowBits)&&(i.windowBits+=32),i.windowBits>15&&i.windowBits<48&&(i.windowBits&15)===0&&(i.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var l=y.inflateInit2(this.strm,i.windowBits);if(l!==a.Z_OK)throw new Error(f[l]);if(this.header=new s,y.inflateGetHeader(this.strm,this.header),i.dictionary&&(typeof i.dictionary=="string"?i.dictionary=t.string2buf(i.dictionary):w.call(i.dictionary)==="[object ArrayBuffer]"&&(i.dictionary=new Uint8Array(i.dictionary)),i.raw&&(l=y.inflateSetDictionary(this.strm,i.dictionary),l!==a.Z_OK)))throw new Error(f[l])}_.prototype.push=function(p,i){var l=this.strm,d=this.options.chunkSize,C=this.options.dictionary,c,E,O,P,W,A=!1;if(this.ended)return!1;E=i===~~i?i:i===!0?a.Z_FINISH:a.Z_NO_FLUSH,typeof p=="string"?l.input=t.binstring2buf(p):w.call(p)==="[object ArrayBuffer]"?l.input=new Uint8Array(p):l.input=p,l.next_in=0,l.avail_in=l.input.length;do{if(l.avail_out===0&&(l.output=new r.Buf8(d),l.next_out=0,l.avail_out=d),c=y.inflate(l,a.Z_NO_FLUSH),c===a.Z_NEED_DICT&&C&&(c=y.inflateSetDictionary(this.strm,C)),c===a.Z_BUF_ERROR&&A===!0&&(c=a.Z_OK,A=!1),c!==a.Z_STREAM_END&&c!==a.Z_OK)return this.onEnd(c),this.ended=!0,!1;l.next_out&&(l.avail_out===0||c===a.Z_STREAM_END||l.avail_in===0&&(E===a.Z_FINISH||E===a.Z_SYNC_FLUSH))&&(this.options.to==="string"?(O=t.utf8border(l.output,l.next_out),P=l.next_out-O,W=t.buf2string(l.output,O),l.next_out=P,l.avail_out=d-P,P&&r.arraySet(l.output,l.output,O,P,0),this.onData(W)):this.onData(r.shrinkBuf(l.output,l.next_out))),l.avail_in===0&&l.avail_out===0&&(A=!0)}while((l.avail_in>0||l.avail_out===0)&&c!==a.Z_STREAM_END);return c===a.Z_STREAM_END&&(E=a.Z_FINISH),E===a.Z_FINISH?(c=y.inflateEnd(this.strm),this.onEnd(c),this.ended=!0,c===a.Z_OK):(E===a.Z_SYNC_FLUSH&&(this.onEnd(a.Z_OK),l.avail_out=0),!0)},_.prototype.onData=function(p){this.chunks.push(p)},_.prototype.onEnd=function(p){p===a.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=p,this.msg=this.strm.msg};function S(p,i){var l=new _(i);if(l.push(p,!0),l.err)throw l.msg||f[l.err];return l.result}function b(p,i){return i=i||{},i.raw=!0,S(p,i)}n.Inflate=_,n.inflate=S,n.inflateRaw=b,n.ungzip=S},{"./utils/common":50,"./utils/strings":51,"./zlib/constants":53,"./zlib/gzheader":56,"./zlib/inflate":58,"./zlib/messages":60,"./zlib/zstream":62}],50:[function(e,g,n){var y=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function r(f,u){return Object.prototype.hasOwnProperty.call(f,u)}n.assign=function(f){for(var u=Array.prototype.slice.call(arguments,1);u.length;){var s=u.shift();if(s){if(typeof s!="object")throw new TypeError(s+"must be non-object");for(var w in s)r(s,w)&&(f[w]=s[w])}}return f},n.shrinkBuf=function(f,u){return f.length===u?f:f.subarray?f.subarray(0,u):(f.length=u,f)};var t={arraySet:function(f,u,s,w,_){if(u.subarray&&f.subarray){f.set(u.subarray(s,s+w),_);return}for(var S=0;S<w;S++)f[_+S]=u[s+S]},flattenChunks:function(f){var u,s,w,_,S,b;for(w=0,u=0,s=f.length;u<s;u++)w+=f[u].length;for(b=new Uint8Array(w),_=0,u=0,s=f.length;u<s;u++)S=f[u],b.set(S,_),_+=S.length;return b}},a={arraySet:function(f,u,s,w,_){for(var S=0;S<w;S++)f[_+S]=u[s+S]},flattenChunks:function(f){return[].concat.apply([],f)}};n.setTyped=function(f){f?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,t)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,a))},n.setTyped(y)},{}],51:[function(e,g,n){var y=e("./common"),r=!0,t=!0;try{String.fromCharCode.apply(null,[0])}catch{r=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{t=!1}for(var a=new y.Buf8(256),f=0;f<256;f++)a[f]=f>=252?6:f>=248?5:f>=240?4:f>=224?3:f>=192?2:1;a[254]=a[254]=1,n.string2buf=function(s){var w,_,S,b,p,i=s.length,l=0;for(b=0;b<i;b++)_=s.charCodeAt(b),(_&64512)===55296&&b+1<i&&(S=s.charCodeAt(b+1),(S&64512)===56320&&(_=65536+(_-55296<<10)+(S-56320),b++)),l+=_<128?1:_<2048?2:_<65536?3:4;for(w=new y.Buf8(l),p=0,b=0;p<l;b++)_=s.charCodeAt(b),(_&64512)===55296&&b+1<i&&(S=s.charCodeAt(b+1),(S&64512)===56320&&(_=65536+(_-55296<<10)+(S-56320),b++)),_<128?w[p++]=_:_<2048?(w[p++]=192|_>>>6,w[p++]=128|_&63):_<65536?(w[p++]=224|_>>>12,w[p++]=128|_>>>6&63,w[p++]=128|_&63):(w[p++]=240|_>>>18,w[p++]=128|_>>>12&63,w[p++]=128|_>>>6&63,w[p++]=128|_&63);return w};function u(s,w){if(w<65534&&(s.subarray&&t||!s.subarray&&r))return String.fromCharCode.apply(null,y.shrinkBuf(s,w));for(var _="",S=0;S<w;S++)_+=String.fromCharCode(s[S]);return _}n.buf2binstring=function(s){return u(s,s.length)},n.binstring2buf=function(s){for(var w=new y.Buf8(s.length),_=0,S=w.length;_<S;_++)w[_]=s.charCodeAt(_);return w},n.buf2string=function(s,w){var _,S,b,p,i=w||s.length,l=new Array(i*2);for(S=0,_=0;_<i;){if(b=s[_++],b<128){l[S++]=b;continue}if(p=a[b],p>4){l[S++]=65533,_+=p-1;continue}for(b&=p===2?31:p===3?15:7;p>1&&_<i;)b=b<<6|s[_++]&63,p--;if(p>1){l[S++]=65533;continue}b<65536?l[S++]=b:(b-=65536,l[S++]=55296|b>>10&1023,l[S++]=56320|b&1023)}return u(l,S)},n.utf8border=function(s,w){var _;for(w=w||s.length,w>s.length&&(w=s.length),_=w-1;_>=0&&(s[_]&192)===128;)_--;return _<0||_===0?w:_+a[s[_]]>w?_:w}},{"./common":50}],52:[function(e,g,n){function y(r,t,a,f){for(var u=r&65535|0,s=r>>>16&65535|0,w=0;a!==0;){w=a>2e3?2e3:a,a-=w;do u=u+t[f++]|0,s=s+u|0;while(--w);u%=65521,s%=65521}return u|s<<16|0}g.exports=y},{}],53:[function(e,g,n){g.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],54:[function(e,g,n){function y(){for(var a,f=[],u=0;u<256;u++){a=u;for(var s=0;s<8;s++)a=a&1?3988292384^a>>>1:a>>>1;f[u]=a}return f}var r=y();function t(a,f,u,s){var w=r,_=s+u;a^=-1;for(var S=s;S<_;S++)a=a>>>8^w[(a^f[S])&255];return a^-1}g.exports=t},{}],55:[function(e,g,n){var y=e("../utils/common"),r=e("./trees"),t=e("./adler32"),a=e("./crc32"),f=e("./messages"),u=0,s=1,w=3,_=4,S=5,b=0,p=1,i=-2,l=-3,d=-5,C=-1,c=1,E=2,O=3,P=4,W=0,A=2,ee=8,D=9,B=15,U=8,x=29,z=256,K=z+1+x,Y=30,$=19,V=2*K+1,ce=15,ie=3,de=258,ve=de+ie+1,Z=32,j=42,re=69,ue=73,ge=91,me=103,Re=113,Oe=666,ke=1,M=2,N=3,te=4,ae=3;function Se(o,Q){return o.msg=f[Q],Q}function we(o){return(o<<1)-(o>4?9:0)}function R(o){for(var Q=o.length;--Q>=0;)o[Q]=0}function v(o){var Q=o.state,q=Q.pending;q>o.avail_out&&(q=o.avail_out),q!==0&&(y.arraySet(o.output,Q.pending_buf,Q.pending_out,q,o.next_out),o.next_out+=q,Q.pending_out+=q,o.total_out+=q,o.avail_out-=q,Q.pending-=q,Q.pending===0&&(Q.pending_out=0))}function m(o,Q){r._tr_flush_block(o,o.block_start>=0?o.block_start:-1,o.strstart-o.block_start,Q),o.block_start=o.strstart,v(o.strm)}function L(o,Q){o.pending_buf[o.pending++]=Q}function X(o,Q){o.pending_buf[o.pending++]=Q>>>8&255,o.pending_buf[o.pending++]=Q&255}function se(o,Q,q,k){var H=o.avail_in;return H>k&&(H=k),H===0?0:(o.avail_in-=H,y.arraySet(Q,o.input,o.next_in,H,q),o.state.wrap===1?o.adler=t(o.adler,Q,H,q):o.state.wrap===2&&(o.adler=a(o.adler,Q,H,q)),o.next_in+=H,o.total_in+=H,H)}function oe(o,Q){var q=o.max_chain_length,k=o.strstart,H,J,be=o.prev_length,pe=o.nice_match,ye=o.strstart>o.w_size-ve?o.strstart-(o.w_size-ve):0,Me=o.window,qe=o.w_mask,He=o.prev,Be=o.strstart+de,Xe=Me[k+be-1],je=Me[k+be];o.prev_length>=o.good_match&&(q>>=2),pe>o.lookahead&&(pe=o.lookahead);do if(H=Q,!(Me[H+be]!==je||Me[H+be-1]!==Xe||Me[H]!==Me[k]||Me[++H]!==Me[k+1])){k+=2,H++;do;while(Me[++k]===Me[++H]&&Me[++k]===Me[++H]&&Me[++k]===Me[++H]&&Me[++k]===Me[++H]&&Me[++k]===Me[++H]&&Me[++k]===Me[++H]&&Me[++k]===Me[++H]&&Me[++k]===Me[++H]&&k<Be);if(J=de-(Be-k),k=Be-de,J>be){if(o.match_start=Q,be=J,J>=pe)break;Xe=Me[k+be-1],je=Me[k+be]}}while((Q=He[Q&qe])>ye&&--q!==0);return be<=o.lookahead?be:o.lookahead}function Te(o){var Q=o.w_size,q,k,H,J,be;do{if(J=o.window_size-o.lookahead-o.strstart,o.strstart>=Q+(Q-ve)){y.arraySet(o.window,o.window,Q,Q,0),o.match_start-=Q,o.strstart-=Q,o.block_start-=Q,k=o.hash_size,q=k;do H=o.head[--q],o.head[q]=H>=Q?H-Q:0;while(--k);k=Q,q=k;do H=o.prev[--q],o.prev[q]=H>=Q?H-Q:0;while(--k);J+=Q}if(o.strm.avail_in===0)break;if(k=se(o.strm,o.window,o.strstart+o.lookahead,J),o.lookahead+=k,o.lookahead+o.insert>=ie)for(be=o.strstart-o.insert,o.ins_h=o.window[be],o.ins_h=(o.ins_h<<o.hash_shift^o.window[be+1])&o.hash_mask;o.insert&&(o.ins_h=(o.ins_h<<o.hash_shift^o.window[be+ie-1])&o.hash_mask,o.prev[be&o.w_mask]=o.head[o.ins_h],o.head[o.ins_h]=be,be++,o.insert--,!(o.lookahead+o.insert<ie)););}while(o.lookahead<ve&&o.strm.avail_in!==0)}function Ce(o,Q){var q=65535;for(q>o.pending_buf_size-5&&(q=o.pending_buf_size-5);;){if(o.lookahead<=1){if(Te(o),o.lookahead===0&&Q===u)return ke;if(o.lookahead===0)break}o.strstart+=o.lookahead,o.lookahead=0;var k=o.block_start+q;if((o.strstart===0||o.strstart>=k)&&(o.lookahead=o.strstart-k,o.strstart=k,m(o,!1),o.strm.avail_out===0)||o.strstart-o.block_start>=o.w_size-ve&&(m(o,!1),o.strm.avail_out===0))return ke}return o.insert=0,Q===_?(m(o,!0),o.strm.avail_out===0?N:te):(o.strstart>o.block_start&&(m(o,!1),o.strm.avail_out===0),ke)}function Ee(o,Q){for(var q,k;;){if(o.lookahead<ve){if(Te(o),o.lookahead<ve&&Q===u)return ke;if(o.lookahead===0)break}if(q=0,o.lookahead>=ie&&(o.ins_h=(o.ins_h<<o.hash_shift^o.window[o.strstart+ie-1])&o.hash_mask,q=o.prev[o.strstart&o.w_mask]=o.head[o.ins_h],o.head[o.ins_h]=o.strstart),q!==0&&o.strstart-q<=o.w_size-ve&&(o.match_length=oe(o,q)),o.match_length>=ie)if(k=r._tr_tally(o,o.strstart-o.match_start,o.match_length-ie),o.lookahead-=o.match_length,o.match_length<=o.max_lazy_match&&o.lookahead>=ie){o.match_length--;do o.strstart++,o.ins_h=(o.ins_h<<o.hash_shift^o.window[o.strstart+ie-1])&o.hash_mask,q=o.prev[o.strstart&o.w_mask]=o.head[o.ins_h],o.head[o.ins_h]=o.strstart;while(--o.match_length!==0);o.strstart++}else o.strstart+=o.match_length,o.match_length=0,o.ins_h=o.window[o.strstart],o.ins_h=(o.ins_h<<o.hash_shift^o.window[o.strstart+1])&o.hash_mask;else k=r._tr_tally(o,0,o.window[o.strstart]),o.lookahead--,o.strstart++;if(k&&(m(o,!1),o.strm.avail_out===0))return ke}return o.insert=o.strstart<ie-1?o.strstart:ie-1,Q===_?(m(o,!0),o.strm.avail_out===0?N:te):o.last_lit&&(m(o,!1),o.strm.avail_out===0)?ke:M}function Fe(o,Q){for(var q,k,H;;){if(o.lookahead<ve){if(Te(o),o.lookahead<ve&&Q===u)return ke;if(o.lookahead===0)break}if(q=0,o.lookahead>=ie&&(o.ins_h=(o.ins_h<<o.hash_shift^o.window[o.strstart+ie-1])&o.hash_mask,q=o.prev[o.strstart&o.w_mask]=o.head[o.ins_h],o.head[o.ins_h]=o.strstart),o.prev_length=o.match_length,o.prev_match=o.match_start,o.match_length=ie-1,q!==0&&o.prev_length<o.max_lazy_match&&o.strstart-q<=o.w_size-ve&&(o.match_length=oe(o,q),o.match_length<=5&&(o.strategy===c||o.match_length===ie&&o.strstart-o.match_start>4096)&&(o.match_length=ie-1)),o.prev_length>=ie&&o.match_length<=o.prev_length){H=o.strstart+o.lookahead-ie,k=r._tr_tally(o,o.strstart-1-o.prev_match,o.prev_length-ie),o.lookahead-=o.prev_length-1,o.prev_length-=2;do++o.strstart<=H&&(o.ins_h=(o.ins_h<<o.hash_shift^o.window[o.strstart+ie-1])&o.hash_mask,q=o.prev[o.strstart&o.w_mask]=o.head[o.ins_h],o.head[o.ins_h]=o.strstart);while(--o.prev_length!==0);if(o.match_available=0,o.match_length=ie-1,o.strstart++,k&&(m(o,!1),o.strm.avail_out===0))return ke}else if(o.match_available){if(k=r._tr_tally(o,0,o.window[o.strstart-1]),k&&m(o,!1),o.strstart++,o.lookahead--,o.strm.avail_out===0)return ke}else o.match_available=1,o.strstart++,o.lookahead--}return o.match_available&&(k=r._tr_tally(o,0,o.window[o.strstart-1]),o.match_available=0),o.insert=o.strstart<ie-1?o.strstart:ie-1,Q===_?(m(o,!0),o.strm.avail_out===0?N:te):o.last_lit&&(m(o,!1),o.strm.avail_out===0)?ke:M}function Ae(o,Q){for(var q,k,H,J,be=o.window;;){if(o.lookahead<=de){if(Te(o),o.lookahead<=de&&Q===u)return ke;if(o.lookahead===0)break}if(o.match_length=0,o.lookahead>=ie&&o.strstart>0&&(H=o.strstart-1,k=be[H],k===be[++H]&&k===be[++H]&&k===be[++H])){J=o.strstart+de;do;while(k===be[++H]&&k===be[++H]&&k===be[++H]&&k===be[++H]&&k===be[++H]&&k===be[++H]&&k===be[++H]&&k===be[++H]&&H<J);o.match_length=de-(J-H),o.match_length>o.lookahead&&(o.match_length=o.lookahead)}if(o.match_length>=ie?(q=r._tr_tally(o,1,o.match_length-ie),o.lookahead-=o.match_length,o.strstart+=o.match_length,o.match_length=0):(q=r._tr_tally(o,0,o.window[o.strstart]),o.lookahead--,o.strstart++),q&&(m(o,!1),o.strm.avail_out===0))return ke}return o.insert=0,Q===_?(m(o,!0),o.strm.avail_out===0?N:te):o.last_lit&&(m(o,!1),o.strm.avail_out===0)?ke:M}function xe(o,Q){for(var q;;){if(o.lookahead===0&&(Te(o),o.lookahead===0)){if(Q===u)return ke;break}if(o.match_length=0,q=r._tr_tally(o,0,o.window[o.strstart]),o.lookahead--,o.strstart++,q&&(m(o,!1),o.strm.avail_out===0))return ke}return o.insert=0,Q===_?(m(o,!0),o.strm.avail_out===0?N:te):o.last_lit&&(m(o,!1),o.strm.avail_out===0)?ke:M}function Ie(o,Q,q,k,H){this.good_length=o,this.max_lazy=Q,this.nice_length=q,this.max_chain=k,this.func=H}var Ne;Ne=[new Ie(0,0,0,0,Ce),new Ie(4,4,8,4,Ee),new Ie(4,5,16,8,Ee),new Ie(4,6,32,32,Ee),new Ie(4,4,16,16,Fe),new Ie(8,16,32,32,Fe),new Ie(8,16,128,128,Fe),new Ie(8,32,128,256,Fe),new Ie(32,128,258,1024,Fe),new Ie(32,258,258,4096,Fe)];function ze(o){o.window_size=2*o.w_size,R(o.head),o.max_lazy_match=Ne[o.level].max_lazy,o.good_match=Ne[o.level].good_length,o.nice_match=Ne[o.level].nice_length,o.max_chain_length=Ne[o.level].max_chain,o.strstart=0,o.block_start=0,o.lookahead=0,o.insert=0,o.match_length=o.prev_length=ie-1,o.match_available=0,o.ins_h=0}function I(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=ee,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new y.Buf16(V*2),this.dyn_dtree=new y.Buf16((2*Y+1)*2),this.bl_tree=new y.Buf16((2*$+1)*2),R(this.dyn_ltree),R(this.dyn_dtree),R(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new y.Buf16(ce+1),this.heap=new y.Buf16(2*K+1),R(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new y.Buf16(2*K+1),R(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function le(o){var Q;return!o||!o.state?Se(o,i):(o.total_in=o.total_out=0,o.data_type=A,Q=o.state,Q.pending=0,Q.pending_out=0,Q.wrap<0&&(Q.wrap=-Q.wrap),Q.status=Q.wrap?j:Re,o.adler=Q.wrap===2?0:1,Q.last_flush=u,r._tr_init(Q),b)}function he(o){var Q=le(o);return Q===b&&ze(o.state),Q}function _e(o,Q){return!o||!o.state||o.state.wrap!==2?i:(o.state.gzhead=Q,b)}function G(o,Q,q,k,H,J){if(!o)return i;var be=1;if(Q===C&&(Q=6),k<0?(be=0,k=-k):k>15&&(be=2,k-=16),H<1||H>D||q!==ee||k<8||k>15||Q<0||Q>9||J<0||J>P)return Se(o,i);k===8&&(k=9);var pe=new I;return o.state=pe,pe.strm=o,pe.wrap=be,pe.gzhead=null,pe.w_bits=k,pe.w_size=1<<pe.w_bits,pe.w_mask=pe.w_size-1,pe.hash_bits=H+7,pe.hash_size=1<<pe.hash_bits,pe.hash_mask=pe.hash_size-1,pe.hash_shift=~~((pe.hash_bits+ie-1)/ie),pe.window=new y.Buf8(pe.w_size*2),pe.head=new y.Buf16(pe.hash_size),pe.prev=new y.Buf16(pe.w_size),pe.lit_bufsize=1<<H+6,pe.pending_buf_size=pe.lit_bufsize*4,pe.pending_buf=new y.Buf8(pe.pending_buf_size),pe.d_buf=1*pe.lit_bufsize,pe.l_buf=3*pe.lit_bufsize,pe.level=Q,pe.strategy=J,pe.method=q,he(o)}function ne(o,Q){return G(o,Q,ee,B,U,W)}function T(o,Q){var q,k,H,J;if(!o||!o.state||Q>S||Q<0)return o?Se(o,i):i;if(k=o.state,!o.output||!o.input&&o.avail_in!==0||k.status===Oe&&Q!==_)return Se(o,o.avail_out===0?d:i);if(k.strm=o,q=k.last_flush,k.last_flush=Q,k.status===j)if(k.wrap===2)o.adler=0,L(k,31),L(k,139),L(k,8),k.gzhead?(L(k,(k.gzhead.text?1:0)+(k.gzhead.hcrc?2:0)+(k.gzhead.extra?4:0)+(k.gzhead.name?8:0)+(k.gzhead.comment?16:0)),L(k,k.gzhead.time&255),L(k,k.gzhead.time>>8&255),L(k,k.gzhead.time>>16&255),L(k,k.gzhead.time>>24&255),L(k,k.level===9?2:k.strategy>=E||k.level<2?4:0),L(k,k.gzhead.os&255),k.gzhead.extra&&k.gzhead.extra.length&&(L(k,k.gzhead.extra.length&255),L(k,k.gzhead.extra.length>>8&255)),k.gzhead.hcrc&&(o.adler=a(o.adler,k.pending_buf,k.pending,0)),k.gzindex=0,k.status=re):(L(k,0),L(k,0),L(k,0),L(k,0),L(k,0),L(k,k.level===9?2:k.strategy>=E||k.level<2?4:0),L(k,ae),k.status=Re);else{var be=ee+(k.w_bits-8<<4)<<8,pe=-1;k.strategy>=E||k.level<2?pe=0:k.level<6?pe=1:k.level===6?pe=2:pe=3,be|=pe<<6,k.strstart!==0&&(be|=Z),be+=31-be%31,k.status=Re,X(k,be),k.strstart!==0&&(X(k,o.adler>>>16),X(k,o.adler&65535)),o.adler=1}if(k.status===re)if(k.gzhead.extra){for(H=k.pending;k.gzindex<(k.gzhead.extra.length&65535)&&!(k.pending===k.pending_buf_size&&(k.gzhead.hcrc&&k.pending>H&&(o.adler=a(o.adler,k.pending_buf,k.pending-H,H)),v(o),H=k.pending,k.pending===k.pending_buf_size));)L(k,k.gzhead.extra[k.gzindex]&255),k.gzindex++;k.gzhead.hcrc&&k.pending>H&&(o.adler=a(o.adler,k.pending_buf,k.pending-H,H)),k.gzindex===k.gzhead.extra.length&&(k.gzindex=0,k.status=ue)}else k.status=ue;if(k.status===ue)if(k.gzhead.name){H=k.pending;do{if(k.pending===k.pending_buf_size&&(k.gzhead.hcrc&&k.pending>H&&(o.adler=a(o.adler,k.pending_buf,k.pending-H,H)),v(o),H=k.pending,k.pending===k.pending_buf_size)){J=1;break}k.gzindex<k.gzhead.name.length?J=k.gzhead.name.charCodeAt(k.gzindex++)&255:J=0,L(k,J)}while(J!==0);k.gzhead.hcrc&&k.pending>H&&(o.adler=a(o.adler,k.pending_buf,k.pending-H,H)),J===0&&(k.gzindex=0,k.status=ge)}else k.status=ge;if(k.status===ge)if(k.gzhead.comment){H=k.pending;do{if(k.pending===k.pending_buf_size&&(k.gzhead.hcrc&&k.pending>H&&(o.adler=a(o.adler,k.pending_buf,k.pending-H,H)),v(o),H=k.pending,k.pending===k.pending_buf_size)){J=1;break}k.gzindex<k.gzhead.comment.length?J=k.gzhead.comment.charCodeAt(k.gzindex++)&255:J=0,L(k,J)}while(J!==0);k.gzhead.hcrc&&k.pending>H&&(o.adler=a(o.adler,k.pending_buf,k.pending-H,H)),J===0&&(k.status=me)}else k.status=me;if(k.status===me&&(k.gzhead.hcrc?(k.pending+2>k.pending_buf_size&&v(o),k.pending+2<=k.pending_buf_size&&(L(k,o.adler&255),L(k,o.adler>>8&255),o.adler=0,k.status=Re)):k.status=Re),k.pending!==0){if(v(o),o.avail_out===0)return k.last_flush=-1,b}else if(o.avail_in===0&&we(Q)<=we(q)&&Q!==_)return Se(o,d);if(k.status===Oe&&o.avail_in!==0)return Se(o,d);if(o.avail_in!==0||k.lookahead!==0||Q!==u&&k.status!==Oe){var ye=k.strategy===E?xe(k,Q):k.strategy===O?Ae(k,Q):Ne[k.level].func(k,Q);if((ye===N||ye===te)&&(k.status=Oe),ye===ke||ye===N)return o.avail_out===0&&(k.last_flush=-1),b;if(ye===M&&(Q===s?r._tr_align(k):Q!==S&&(r._tr_stored_block(k,0,0,!1),Q===w&&(R(k.head),k.lookahead===0&&(k.strstart=0,k.block_start=0,k.insert=0))),v(o),o.avail_out===0))return k.last_flush=-1,b}return Q!==_?b:k.wrap<=0?p:(k.wrap===2?(L(k,o.adler&255),L(k,o.adler>>8&255),L(k,o.adler>>16&255),L(k,o.adler>>24&255),L(k,o.total_in&255),L(k,o.total_in>>8&255),L(k,o.total_in>>16&255),L(k,o.total_in>>24&255)):(X(k,o.adler>>>16),X(k,o.adler&65535)),v(o),k.wrap>0&&(k.wrap=-k.wrap),k.pending!==0?b:p)}function fe(o){var Q;return!o||!o.state?i:(Q=o.state.status,Q!==j&&Q!==re&&Q!==ue&&Q!==ge&&Q!==me&&Q!==Re&&Q!==Oe?Se(o,i):(o.state=null,Q===Re?Se(o,l):b))}function Le(o,Q){var q=Q.length,k,H,J,be,pe,ye,Me,qe;if(!o||!o.state||(k=o.state,be=k.wrap,be===2||be===1&&k.status!==j||k.lookahead))return i;for(be===1&&(o.adler=t(o.adler,Q,q,0)),k.wrap=0,q>=k.w_size&&(be===0&&(R(k.head),k.strstart=0,k.block_start=0,k.insert=0),qe=new y.Buf8(k.w_size),y.arraySet(qe,Q,q-k.w_size,k.w_size,0),Q=qe,q=k.w_size),pe=o.avail_in,ye=o.next_in,Me=o.input,o.avail_in=q,o.next_in=0,o.input=Q,Te(k);k.lookahead>=ie;){H=k.strstart,J=k.lookahead-(ie-1);do k.ins_h=(k.ins_h<<k.hash_shift^k.window[H+ie-1])&k.hash_mask,k.prev[H&k.w_mask]=k.head[k.ins_h],k.head[k.ins_h]=H,H++;while(--J);k.strstart=H,k.lookahead=ie-1,Te(k)}return k.strstart+=k.lookahead,k.block_start=k.strstart,k.insert=k.lookahead,k.lookahead=0,k.match_length=k.prev_length=ie-1,k.match_available=0,o.next_in=ye,o.input=Me,o.avail_in=pe,k.wrap=be,b}n.deflateInit=ne,n.deflateInit2=G,n.deflateReset=he,n.deflateResetKeep=le,n.deflateSetHeader=_e,n.deflate=T,n.deflateEnd=fe,n.deflateSetDictionary=Le,n.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":50,"./adler32":52,"./crc32":54,"./messages":60,"./trees":61}],56:[function(e,g,n){function y(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}g.exports=y},{}],57:[function(e,g,n){var y=30,r=12;g.exports=function(a,f){var u,s,w,_,S,b,p,i,l,d,C,c,E,O,P,W,A,ee,D,B,U,x,z,K,Y;u=a.state,s=a.next_in,K=a.input,w=s+(a.avail_in-5),_=a.next_out,Y=a.output,S=_-(f-a.avail_out),b=_+(a.avail_out-257),p=u.dmax,i=u.wsize,l=u.whave,d=u.wnext,C=u.window,c=u.hold,E=u.bits,O=u.lencode,P=u.distcode,W=(1<<u.lenbits)-1,A=(1<<u.distbits)-1;e:do{E<15&&(c+=K[s++]<<E,E+=8,c+=K[s++]<<E,E+=8),ee=O[c&W];t:for(;;){if(D=ee>>>24,c>>>=D,E-=D,D=ee>>>16&255,D===0)Y[_++]=ee&65535;else if(D&16){B=ee&65535,D&=15,D&&(E<D&&(c+=K[s++]<<E,E+=8),B+=c&(1<<D)-1,c>>>=D,E-=D),E<15&&(c+=K[s++]<<E,E+=8,c+=K[s++]<<E,E+=8),ee=P[c&A];r:for(;;){if(D=ee>>>24,c>>>=D,E-=D,D=ee>>>16&255,D&16){if(U=ee&65535,D&=15,E<D&&(c+=K[s++]<<E,E+=8,E<D&&(c+=K[s++]<<E,E+=8)),U+=c&(1<<D)-1,U>p){a.msg="invalid distance too far back",u.mode=y;break e}if(c>>>=D,E-=D,D=_-S,U>D){if(D=U-D,D>l&&u.sane){a.msg="invalid distance too far back",u.mode=y;break e}if(x=0,z=C,d===0){if(x+=i-D,D<B){B-=D;do Y[_++]=C[x++];while(--D);x=_-U,z=Y}}else if(d<D){if(x+=i+d-D,D-=d,D<B){B-=D;do Y[_++]=C[x++];while(--D);if(x=0,d<B){D=d,B-=D;do Y[_++]=C[x++];while(--D);x=_-U,z=Y}}}else if(x+=d-D,D<B){B-=D;do Y[_++]=C[x++];while(--D);x=_-U,z=Y}for(;B>2;)Y[_++]=z[x++],Y[_++]=z[x++],Y[_++]=z[x++],B-=3;B&&(Y[_++]=z[x++],B>1&&(Y[_++]=z[x++]))}else{x=_-U;do Y[_++]=Y[x++],Y[_++]=Y[x++],Y[_++]=Y[x++],B-=3;while(B>2);B&&(Y[_++]=Y[x++],B>1&&(Y[_++]=Y[x++]))}}else if((D&64)===0){ee=P[(ee&65535)+(c&(1<<D)-1)];continue r}else{a.msg="invalid distance code",u.mode=y;break e}break}}else if((D&64)===0){ee=O[(ee&65535)+(c&(1<<D)-1)];continue t}else if(D&32){u.mode=r;break e}else{a.msg="invalid literal/length code",u.mode=y;break e}break}}while(s<w&&_<b);B=E>>3,s-=B,E-=B<<3,c&=(1<<E)-1,a.next_in=s,a.next_out=_,a.avail_in=s<w?5+(w-s):5-(s-w),a.avail_out=_<b?257+(b-_):257-(_-b),u.hold=c,u.bits=E}},{}],58:[function(e,g,n){var y=e("../utils/common"),r=e("./adler32"),t=e("./crc32"),a=e("./inffast"),f=e("./inftrees"),u=0,s=1,w=2,_=4,S=5,b=6,p=0,i=1,l=2,d=-2,C=-3,c=-4,E=-5,O=8,P=1,W=2,A=3,ee=4,D=5,B=6,U=7,x=8,z=9,K=10,Y=11,$=12,V=13,ce=14,ie=15,de=16,ve=17,Z=18,j=19,re=20,ue=21,ge=22,me=23,Re=24,Oe=25,ke=26,M=27,N=28,te=29,ae=30,Se=31,we=32,R=852,v=592,m=15,L=m;function X(G){return(G>>>24&255)+(G>>>8&65280)+((G&65280)<<8)+((G&255)<<24)}function se(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new y.Buf16(320),this.work=new y.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function oe(G){var ne;return!G||!G.state?d:(ne=G.state,G.total_in=G.total_out=ne.total=0,G.msg="",ne.wrap&&(G.adler=ne.wrap&1),ne.mode=P,ne.last=0,ne.havedict=0,ne.dmax=32768,ne.head=null,ne.hold=0,ne.bits=0,ne.lencode=ne.lendyn=new y.Buf32(R),ne.distcode=ne.distdyn=new y.Buf32(v),ne.sane=1,ne.back=-1,p)}function Te(G){var ne;return!G||!G.state?d:(ne=G.state,ne.wsize=0,ne.whave=0,ne.wnext=0,oe(G))}function Ce(G,ne){var T,fe;return!G||!G.state||(fe=G.state,ne<0?(T=0,ne=-ne):(T=(ne>>4)+1,ne<48&&(ne&=15)),ne&&(ne<8||ne>15))?d:(fe.window!==null&&fe.wbits!==ne&&(fe.window=null),fe.wrap=T,fe.wbits=ne,Te(G))}function Ee(G,ne){var T,fe;return G?(fe=new se,G.state=fe,fe.window=null,T=Ce(G,ne),T!==p&&(G.state=null),T):d}function Fe(G){return Ee(G,L)}var Ae=!0,xe,Ie;function Ne(G){if(Ae){var ne;for(xe=new y.Buf32(512),Ie=new y.Buf32(32),ne=0;ne<144;)G.lens[ne++]=8;for(;ne<256;)G.lens[ne++]=9;for(;ne<280;)G.lens[ne++]=7;for(;ne<288;)G.lens[ne++]=8;for(f(s,G.lens,0,288,xe,0,G.work,{bits:9}),ne=0;ne<32;)G.lens[ne++]=5;f(w,G.lens,0,32,Ie,0,G.work,{bits:5}),Ae=!1}G.lencode=xe,G.lenbits=9,G.distcode=Ie,G.distbits=5}function ze(G,ne,T,fe){var Le,o=G.state;return o.window===null&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new y.Buf8(o.wsize)),fe>=o.wsize?(y.arraySet(o.window,ne,T-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):(Le=o.wsize-o.wnext,Le>fe&&(Le=fe),y.arraySet(o.window,ne,T-fe,Le,o.wnext),fe-=Le,fe?(y.arraySet(o.window,ne,T-fe,fe,0),o.wnext=fe,o.whave=o.wsize):(o.wnext+=Le,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=Le))),0}function I(G,ne){var T,fe,Le,o,Q,q,k,H,J,be,pe,ye,Me,qe,He=0,Be,Xe,je,Ve,st,ot,Ue,Ye,Ke=new y.Buf8(4),$e,Je,pt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!G||!G.state||!G.output||!G.input&&G.avail_in!==0)return d;T=G.state,T.mode===$&&(T.mode=V),Q=G.next_out,Le=G.output,k=G.avail_out,o=G.next_in,fe=G.input,q=G.avail_in,H=T.hold,J=T.bits,be=q,pe=k,Ye=p;e:for(;;)switch(T.mode){case P:if(T.wrap===0){T.mode=V;break}for(;J<16;){if(q===0)break e;q--,H+=fe[o++]<<J,J+=8}if(T.wrap&2&&H===35615){T.check=0,Ke[0]=H&255,Ke[1]=H>>>8&255,T.check=t(T.check,Ke,2,0),H=0,J=0,T.mode=W;break}if(T.flags=0,T.head&&(T.head.done=!1),!(T.wrap&1)||(((H&255)<<8)+(H>>8))%31){G.msg="incorrect header check",T.mode=ae;break}if((H&15)!==O){G.msg="unknown compression method",T.mode=ae;break}if(H>>>=4,J-=4,Ue=(H&15)+8,T.wbits===0)T.wbits=Ue;else if(Ue>T.wbits){G.msg="invalid window size",T.mode=ae;break}T.dmax=1<<Ue,G.adler=T.check=1,T.mode=H&512?K:$,H=0,J=0;break;case W:for(;J<16;){if(q===0)break e;q--,H+=fe[o++]<<J,J+=8}if(T.flags=H,(T.flags&255)!==O){G.msg="unknown compression method",T.mode=ae;break}if(T.flags&57344){G.msg="unknown header flags set",T.mode=ae;break}T.head&&(T.head.text=H>>8&1),T.flags&512&&(Ke[0]=H&255,Ke[1]=H>>>8&255,T.check=t(T.check,Ke,2,0)),H=0,J=0,T.mode=A;case A:for(;J<32;){if(q===0)break e;q--,H+=fe[o++]<<J,J+=8}T.head&&(T.head.time=H),T.flags&512&&(Ke[0]=H&255,Ke[1]=H>>>8&255,Ke[2]=H>>>16&255,Ke[3]=H>>>24&255,T.check=t(T.check,Ke,4,0)),H=0,J=0,T.mode=ee;case ee:for(;J<16;){if(q===0)break e;q--,H+=fe[o++]<<J,J+=8}T.head&&(T.head.xflags=H&255,T.head.os=H>>8),T.flags&512&&(Ke[0]=H&255,Ke[1]=H>>>8&255,T.check=t(T.check,Ke,2,0)),H=0,J=0,T.mode=D;case D:if(T.flags&1024){for(;J<16;){if(q===0)break e;q--,H+=fe[o++]<<J,J+=8}T.length=H,T.head&&(T.head.extra_len=H),T.flags&512&&(Ke[0]=H&255,Ke[1]=H>>>8&255,T.check=t(T.check,Ke,2,0)),H=0,J=0}else T.head&&(T.head.extra=null);T.mode=B;case B:if(T.flags&1024&&(ye=T.length,ye>q&&(ye=q),ye&&(T.head&&(Ue=T.head.extra_len-T.length,T.head.extra||(T.head.extra=new Array(T.head.extra_len)),y.arraySet(T.head.extra,fe,o,ye,Ue)),T.flags&512&&(T.check=t(T.check,fe,ye,o)),q-=ye,o+=ye,T.length-=ye),T.length))break e;T.length=0,T.mode=U;case U:if(T.flags&2048){if(q===0)break e;ye=0;do Ue=fe[o+ye++],T.head&&Ue&&T.length<65536&&(T.head.name+=String.fromCharCode(Ue));while(Ue&&ye<q);if(T.flags&512&&(T.check=t(T.check,fe,ye,o)),q-=ye,o+=ye,Ue)break e}else T.head&&(T.head.name=null);T.length=0,T.mode=x;case x:if(T.flags&4096){if(q===0)break e;ye=0;do Ue=fe[o+ye++],T.head&&Ue&&T.length<65536&&(T.head.comment+=String.fromCharCode(Ue));while(Ue&&ye<q);if(T.flags&512&&(T.check=t(T.check,fe,ye,o)),q-=ye,o+=ye,Ue)break e}else T.head&&(T.head.comment=null);T.mode=z;case z:if(T.flags&512){for(;J<16;){if(q===0)break e;q--,H+=fe[o++]<<J,J+=8}if(H!==(T.check&65535)){G.msg="header crc mismatch",T.mode=ae;break}H=0,J=0}T.head&&(T.head.hcrc=T.flags>>9&1,T.head.done=!0),G.adler=T.check=0,T.mode=$;break;case K:for(;J<32;){if(q===0)break e;q--,H+=fe[o++]<<J,J+=8}G.adler=T.check=X(H),H=0,J=0,T.mode=Y;case Y:if(T.havedict===0)return G.next_out=Q,G.avail_out=k,G.next_in=o,G.avail_in=q,T.hold=H,T.bits=J,l;G.adler=T.check=1,T.mode=$;case $:if(ne===S||ne===b)break e;case V:if(T.last){H>>>=J&7,J-=J&7,T.mode=M;break}for(;J<3;){if(q===0)break e;q--,H+=fe[o++]<<J,J+=8}switch(T.last=H&1,H>>>=1,J-=1,H&3){case 0:T.mode=ce;break;case 1:if(Ne(T),T.mode=re,ne===b){H>>>=2,J-=2;break e}break;case 2:T.mode=ve;break;case 3:G.msg="invalid block type",T.mode=ae}H>>>=2,J-=2;break;case ce:for(H>>>=J&7,J-=J&7;J<32;){if(q===0)break e;q--,H+=fe[o++]<<J,J+=8}if((H&65535)!==(H>>>16^65535)){G.msg="invalid stored block lengths",T.mode=ae;break}if(T.length=H&65535,H=0,J=0,T.mode=ie,ne===b)break e;case ie:T.mode=de;case de:if(ye=T.length,ye){if(ye>q&&(ye=q),ye>k&&(ye=k),ye===0)break e;y.arraySet(Le,fe,o,ye,Q),q-=ye,o+=ye,k-=ye,Q+=ye,T.length-=ye;break}T.mode=$;break;case ve:for(;J<14;){if(q===0)break e;q--,H+=fe[o++]<<J,J+=8}if(T.nlen=(H&31)+257,H>>>=5,J-=5,T.ndist=(H&31)+1,H>>>=5,J-=5,T.ncode=(H&15)+4,H>>>=4,J-=4,T.nlen>286||T.ndist>30){G.msg="too many length or distance symbols",T.mode=ae;break}T.have=0,T.mode=Z;case Z:for(;T.have<T.ncode;){for(;J<3;){if(q===0)break e;q--,H+=fe[o++]<<J,J+=8}T.lens[pt[T.have++]]=H&7,H>>>=3,J-=3}for(;T.have<19;)T.lens[pt[T.have++]]=0;if(T.lencode=T.lendyn,T.lenbits=7,$e={bits:T.lenbits},Ye=f(u,T.lens,0,19,T.lencode,0,T.work,$e),T.lenbits=$e.bits,Ye){G.msg="invalid code lengths set",T.mode=ae;break}T.have=0,T.mode=j;case j:for(;T.have<T.nlen+T.ndist;){for(;He=T.lencode[H&(1<<T.lenbits)-1],Be=He>>>24,Xe=He>>>16&255,je=He&65535,!(Be<=J);){if(q===0)break e;q--,H+=fe[o++]<<J,J+=8}if(je<16)H>>>=Be,J-=Be,T.lens[T.have++]=je;else{if(je===16){for(Je=Be+2;J<Je;){if(q===0)break e;q--,H+=fe[o++]<<J,J+=8}if(H>>>=Be,J-=Be,T.have===0){G.msg="invalid bit length repeat",T.mode=ae;break}Ue=T.lens[T.have-1],ye=3+(H&3),H>>>=2,J-=2}else if(je===17){for(Je=Be+3;J<Je;){if(q===0)break e;q--,H+=fe[o++]<<J,J+=8}H>>>=Be,J-=Be,Ue=0,ye=3+(H&7),H>>>=3,J-=3}else{for(Je=Be+7;J<Je;){if(q===0)break e;q--,H+=fe[o++]<<J,J+=8}H>>>=Be,J-=Be,Ue=0,ye=11+(H&127),H>>>=7,J-=7}if(T.have+ye>T.nlen+T.ndist){G.msg="invalid bit length repeat",T.mode=ae;break}for(;ye--;)T.lens[T.have++]=Ue}}if(T.mode===ae)break;if(T.lens[256]===0){G.msg="invalid code -- missing end-of-block",T.mode=ae;break}if(T.lenbits=9,$e={bits:T.lenbits},Ye=f(s,T.lens,0,T.nlen,T.lencode,0,T.work,$e),T.lenbits=$e.bits,Ye){G.msg="invalid literal/lengths set",T.mode=ae;break}if(T.distbits=6,T.distcode=T.distdyn,$e={bits:T.distbits},Ye=f(w,T.lens,T.nlen,T.ndist,T.distcode,0,T.work,$e),T.distbits=$e.bits,Ye){G.msg="invalid distances set",T.mode=ae;break}if(T.mode=re,ne===b)break e;case re:T.mode=ue;case ue:if(q>=6&&k>=258){G.next_out=Q,G.avail_out=k,G.next_in=o,G.avail_in=q,T.hold=H,T.bits=J,a(G,pe),Q=G.next_out,Le=G.output,k=G.avail_out,o=G.next_in,fe=G.input,q=G.avail_in,H=T.hold,J=T.bits,T.mode===$&&(T.back=-1);break}for(T.back=0;He=T.lencode[H&(1<<T.lenbits)-1],Be=He>>>24,Xe=He>>>16&255,je=He&65535,!(Be<=J);){if(q===0)break e;q--,H+=fe[o++]<<J,J+=8}if(Xe&&(Xe&240)===0){for(Ve=Be,st=Xe,ot=je;He=T.lencode[ot+((H&(1<<Ve+st)-1)>>Ve)],Be=He>>>24,Xe=He>>>16&255,je=He&65535,!(Ve+Be<=J);){if(q===0)break e;q--,H+=fe[o++]<<J,J+=8}H>>>=Ve,J-=Ve,T.back+=Ve}if(H>>>=Be,J-=Be,T.back+=Be,T.length=je,Xe===0){T.mode=ke;break}if(Xe&32){T.back=-1,T.mode=$;break}if(Xe&64){G.msg="invalid literal/length code",T.mode=ae;break}T.extra=Xe&15,T.mode=ge;case ge:if(T.extra){for(Je=T.extra;J<Je;){if(q===0)break e;q--,H+=fe[o++]<<J,J+=8}T.length+=H&(1<<T.extra)-1,H>>>=T.extra,J-=T.extra,T.back+=T.extra}T.was=T.length,T.mode=me;case me:for(;He=T.distcode[H&(1<<T.distbits)-1],Be=He>>>24,Xe=He>>>16&255,je=He&65535,!(Be<=J);){if(q===0)break e;q--,H+=fe[o++]<<J,J+=8}if((Xe&240)===0){for(Ve=Be,st=Xe,ot=je;He=T.distcode[ot+((H&(1<<Ve+st)-1)>>Ve)],Be=He>>>24,Xe=He>>>16&255,je=He&65535,!(Ve+Be<=J);){if(q===0)break e;q--,H+=fe[o++]<<J,J+=8}H>>>=Ve,J-=Ve,T.back+=Ve}if(H>>>=Be,J-=Be,T.back+=Be,Xe&64){G.msg="invalid distance code",T.mode=ae;break}T.offset=je,T.extra=Xe&15,T.mode=Re;case Re:if(T.extra){for(Je=T.extra;J<Je;){if(q===0)break e;q--,H+=fe[o++]<<J,J+=8}T.offset+=H&(1<<T.extra)-1,H>>>=T.extra,J-=T.extra,T.back+=T.extra}if(T.offset>T.dmax){G.msg="invalid distance too far back",T.mode=ae;break}T.mode=Oe;case Oe:if(k===0)break e;if(ye=pe-k,T.offset>ye){if(ye=T.offset-ye,ye>T.whave&&T.sane){G.msg="invalid distance too far back",T.mode=ae;break}ye>T.wnext?(ye-=T.wnext,Me=T.wsize-ye):Me=T.wnext-ye,ye>T.length&&(ye=T.length),qe=T.window}else qe=Le,Me=Q-T.offset,ye=T.length;ye>k&&(ye=k),k-=ye,T.length-=ye;do Le[Q++]=qe[Me++];while(--ye);T.length===0&&(T.mode=ue);break;case ke:if(k===0)break e;Le[Q++]=T.length,k--,T.mode=ue;break;case M:if(T.wrap){for(;J<32;){if(q===0)break e;q--,H|=fe[o++]<<J,J+=8}if(pe-=k,G.total_out+=pe,T.total+=pe,pe&&(G.adler=T.check=T.flags?t(T.check,Le,pe,Q-pe):r(T.check,Le,pe,Q-pe)),pe=k,(T.flags?H:X(H))!==T.check){G.msg="incorrect data check",T.mode=ae;break}H=0,J=0}T.mode=N;case N:if(T.wrap&&T.flags){for(;J<32;){if(q===0)break e;q--,H+=fe[o++]<<J,J+=8}if(H!==(T.total&4294967295)){G.msg="incorrect length check",T.mode=ae;break}H=0,J=0}T.mode=te;case te:Ye=i;break e;case ae:Ye=C;break e;case Se:return c;case we:default:return d}return G.next_out=Q,G.avail_out=k,G.next_in=o,G.avail_in=q,T.hold=H,T.bits=J,(T.wsize||pe!==G.avail_out&&T.mode<ae&&(T.mode<M||ne!==_))&&ze(G,G.output,G.next_out,pe-G.avail_out),be-=G.avail_in,pe-=G.avail_out,G.total_in+=be,G.total_out+=pe,T.total+=pe,T.wrap&&pe&&(G.adler=T.check=T.flags?t(T.check,Le,pe,G.next_out-pe):r(T.check,Le,pe,G.next_out-pe)),G.data_type=T.bits+(T.last?64:0)+(T.mode===$?128:0)+(T.mode===re||T.mode===ie?256:0),(be===0&&pe===0||ne===_)&&Ye===p&&(Ye=E),Ye}function le(G){if(!G||!G.state)return d;var ne=G.state;return ne.window&&(ne.window=null),G.state=null,p}function he(G,ne){var T;return!G||!G.state||(T=G.state,(T.wrap&2)===0)?d:(T.head=ne,ne.done=!1,p)}function _e(G,ne){var T=ne.length,fe,Le,o;return!G||!G.state||(fe=G.state,fe.wrap!==0&&fe.mode!==Y)?d:fe.mode===Y&&(Le=1,Le=r(Le,ne,T,0),Le!==fe.check)?C:(o=ze(G,ne,T,T),o?(fe.mode=Se,c):(fe.havedict=1,p))}n.inflateReset=Te,n.inflateReset2=Ce,n.inflateResetKeep=oe,n.inflateInit=Fe,n.inflateInit2=Ee,n.inflate=I,n.inflateEnd=le,n.inflateGetHeader=he,n.inflateSetDictionary=_e,n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":50,"./adler32":52,"./crc32":54,"./inffast":57,"./inftrees":59}],59:[function(e,g,n){var y=e("../utils/common"),r=15,t=852,a=592,f=0,u=1,s=2,w=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],_=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],S=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],b=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];g.exports=function(i,l,d,C,c,E,O,P){var W=P.bits,A=0,ee=0,D=0,B=0,U=0,x=0,z=0,K=0,Y=0,$=0,V,ce,ie,de,ve,Z=null,j=0,re,ue=new y.Buf16(r+1),ge=new y.Buf16(r+1),me=null,Re=0,Oe,ke,M;for(A=0;A<=r;A++)ue[A]=0;for(ee=0;ee<C;ee++)ue[l[d+ee]]++;for(U=W,B=r;B>=1&&ue[B]===0;B--);if(U>B&&(U=B),B===0)return c[E++]=1<<24|64<<16|0,c[E++]=1<<24|64<<16|0,P.bits=1,0;for(D=1;D<B&&ue[D]===0;D++);for(U<D&&(U=D),K=1,A=1;A<=r;A++)if(K<<=1,K-=ue[A],K<0)return-1;if(K>0&&(i===f||B!==1))return-1;for(ge[1]=0,A=1;A<r;A++)ge[A+1]=ge[A]+ue[A];for(ee=0;ee<C;ee++)l[d+ee]!==0&&(O[ge[l[d+ee]]++]=ee);if(i===f?(Z=me=O,re=19):i===u?(Z=w,j-=257,me=_,Re-=257,re=256):(Z=S,me=b,re=-1),$=0,ee=0,A=D,ve=E,x=U,z=0,ie=-1,Y=1<<U,de=Y-1,i===u&&Y>t||i===s&&Y>a)return 1;for(;;){Oe=A-z,O[ee]<re?(ke=0,M=O[ee]):O[ee]>re?(ke=me[Re+O[ee]],M=Z[j+O[ee]]):(ke=96,M=0),V=1<<A-z,ce=1<<x,D=ce;do ce-=V,c[ve+($>>z)+ce]=Oe<<24|ke<<16|M|0;while(ce!==0);for(V=1<<A-1;$&V;)V>>=1;if(V!==0?($&=V-1,$+=V):$=0,ee++,--ue[A]===0){if(A===B)break;A=l[d+O[ee]]}if(A>U&&($&de)!==ie){for(z===0&&(z=U),ve+=D,x=A-z,K=1<<x;x+z<B&&(K-=ue[x+z],!(K<=0));)x++,K<<=1;if(Y+=1<<x,i===u&&Y>t||i===s&&Y>a)return 1;ie=$&de,c[ie]=U<<24|x<<16|ve-E|0}}return $!==0&&(c[ve+$]=A-z<<24|64<<16|0),P.bits=U,0}},{"../utils/common":50}],60:[function(e,g,n){g.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],61:[function(e,g,n){var y=e("../utils/common"),r=4,t=0,a=1,f=2;function u(I){for(var le=I.length;--le>=0;)I[le]=0}var s=0,w=1,_=2,S=3,b=258,p=29,i=256,l=i+1+p,d=30,C=19,c=2*l+1,E=15,O=16,P=7,W=256,A=16,ee=17,D=18,B=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],U=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],K=512,Y=new Array((l+2)*2);u(Y);var $=new Array(d*2);u($);var V=new Array(K);u(V);var ce=new Array(b-S+1);u(ce);var ie=new Array(p);u(ie);var de=new Array(d);u(de);function ve(I,le,he,_e,G){this.static_tree=I,this.extra_bits=le,this.extra_base=he,this.elems=_e,this.max_length=G,this.has_stree=I&&I.length}var Z,j,re;function ue(I,le){this.dyn_tree=I,this.max_code=0,this.stat_desc=le}function ge(I){return I<256?V[I]:V[256+(I>>>7)]}function me(I,le){I.pending_buf[I.pending++]=le&255,I.pending_buf[I.pending++]=le>>>8&255}function Re(I,le,he){I.bi_valid>O-he?(I.bi_buf|=le<<I.bi_valid&65535,me(I,I.bi_buf),I.bi_buf=le>>O-I.bi_valid,I.bi_valid+=he-O):(I.bi_buf|=le<<I.bi_valid&65535,I.bi_valid+=he)}function Oe(I,le,he){Re(I,he[le*2],he[le*2+1])}function ke(I,le){var he=0;do he|=I&1,I>>>=1,he<<=1;while(--le>0);return he>>>1}function M(I){I.bi_valid===16?(me(I,I.bi_buf),I.bi_buf=0,I.bi_valid=0):I.bi_valid>=8&&(I.pending_buf[I.pending++]=I.bi_buf&255,I.bi_buf>>=8,I.bi_valid-=8)}function N(I,le){var he=le.dyn_tree,_e=le.max_code,G=le.stat_desc.static_tree,ne=le.stat_desc.has_stree,T=le.stat_desc.extra_bits,fe=le.stat_desc.extra_base,Le=le.stat_desc.max_length,o,Q,q,k,H,J,be=0;for(k=0;k<=E;k++)I.bl_count[k]=0;for(he[I.heap[I.heap_max]*2+1]=0,o=I.heap_max+1;o<c;o++)Q=I.heap[o],k=he[he[Q*2+1]*2+1]+1,k>Le&&(k=Le,be++),he[Q*2+1]=k,!(Q>_e)&&(I.bl_count[k]++,H=0,Q>=fe&&(H=T[Q-fe]),J=he[Q*2],I.opt_len+=J*(k+H),ne&&(I.static_len+=J*(G[Q*2+1]+H)));if(be!==0){do{for(k=Le-1;I.bl_count[k]===0;)k--;I.bl_count[k]--,I.bl_count[k+1]+=2,I.bl_count[Le]--,be-=2}while(be>0);for(k=Le;k!==0;k--)for(Q=I.bl_count[k];Q!==0;)q=I.heap[--o],!(q>_e)&&(he[q*2+1]!==k&&(I.opt_len+=(k-he[q*2+1])*he[q*2],he[q*2+1]=k),Q--)}}function te(I,le,he){var _e=new Array(E+1),G=0,ne,T;for(ne=1;ne<=E;ne++)_e[ne]=G=G+he[ne-1]<<1;for(T=0;T<=le;T++){var fe=I[T*2+1];fe!==0&&(I[T*2]=ke(_e[fe]++,fe))}}function ae(){var I,le,he,_e,G,ne=new Array(E+1);for(he=0,_e=0;_e<p-1;_e++)for(ie[_e]=he,I=0;I<1<<B[_e];I++)ce[he++]=_e;for(ce[he-1]=_e,G=0,_e=0;_e<16;_e++)for(de[_e]=G,I=0;I<1<<U[_e];I++)V[G++]=_e;for(G>>=7;_e<d;_e++)for(de[_e]=G<<7,I=0;I<1<<U[_e]-7;I++)V[256+G++]=_e;for(le=0;le<=E;le++)ne[le]=0;for(I=0;I<=143;)Y[I*2+1]=8,I++,ne[8]++;for(;I<=255;)Y[I*2+1]=9,I++,ne[9]++;for(;I<=279;)Y[I*2+1]=7,I++,ne[7]++;for(;I<=287;)Y[I*2+1]=8,I++,ne[8]++;for(te(Y,l+1,ne),I=0;I<d;I++)$[I*2+1]=5,$[I*2]=ke(I,5);Z=new ve(Y,B,i+1,l,E),j=new ve($,U,0,d,E),re=new ve(new Array(0),x,0,C,P)}function Se(I){var le;for(le=0;le<l;le++)I.dyn_ltree[le*2]=0;for(le=0;le<d;le++)I.dyn_dtree[le*2]=0;for(le=0;le<C;le++)I.bl_tree[le*2]=0;I.dyn_ltree[W*2]=1,I.opt_len=I.static_len=0,I.last_lit=I.matches=0}function we(I){I.bi_valid>8?me(I,I.bi_buf):I.bi_valid>0&&(I.pending_buf[I.pending++]=I.bi_buf),I.bi_buf=0,I.bi_valid=0}function R(I,le,he,_e){we(I),me(I,he),me(I,~he),y.arraySet(I.pending_buf,I.window,le,he,I.pending),I.pending+=he}function v(I,le,he,_e){var G=le*2,ne=he*2;return I[G]<I[ne]||I[G]===I[ne]&&_e[le]<=_e[he]}function m(I,le,he){for(var _e=I.heap[he],G=he<<1;G<=I.heap_len&&(G<I.heap_len&&v(le,I.heap[G+1],I.heap[G],I.depth)&&G++,!v(le,_e,I.heap[G],I.depth));)I.heap[he]=I.heap[G],he=G,G<<=1;I.heap[he]=_e}function L(I,le,he){var _e,G,ne=0,T,fe;if(I.last_lit!==0)do _e=I.pending_buf[I.d_buf+ne*2]<<8|I.pending_buf[I.d_buf+ne*2+1],G=I.pending_buf[I.l_buf+ne],ne++,_e===0?Oe(I,G,le):(T=ce[G],Oe(I,T+i+1,le),fe=B[T],fe!==0&&(G-=ie[T],Re(I,G,fe)),_e--,T=ge(_e),Oe(I,T,he),fe=U[T],fe!==0&&(_e-=de[T],Re(I,_e,fe)));while(ne<I.last_lit);Oe(I,W,le)}function X(I,le){var he=le.dyn_tree,_e=le.stat_desc.static_tree,G=le.stat_desc.has_stree,ne=le.stat_desc.elems,T,fe,Le=-1,o;for(I.heap_len=0,I.heap_max=c,T=0;T<ne;T++)he[T*2]!==0?(I.heap[++I.heap_len]=Le=T,I.depth[T]=0):he[T*2+1]=0;for(;I.heap_len<2;)o=I.heap[++I.heap_len]=Le<2?++Le:0,he[o*2]=1,I.depth[o]=0,I.opt_len--,G&&(I.static_len-=_e[o*2+1]);for(le.max_code=Le,T=I.heap_len>>1;T>=1;T--)m(I,he,T);o=ne;do T=I.heap[1],I.heap[1]=I.heap[I.heap_len--],m(I,he,1),fe=I.heap[1],I.heap[--I.heap_max]=T,I.heap[--I.heap_max]=fe,he[o*2]=he[T*2]+he[fe*2],I.depth[o]=(I.depth[T]>=I.depth[fe]?I.depth[T]:I.depth[fe])+1,he[T*2+1]=he[fe*2+1]=o,I.heap[1]=o++,m(I,he,1);while(I.heap_len>=2);I.heap[--I.heap_max]=I.heap[1],N(I,le),te(he,Le,I.bl_count)}function se(I,le,he){var _e,G=-1,ne,T=le[1],fe=0,Le=7,o=4;for(T===0&&(Le=138,o=3),le[(he+1)*2+1]=65535,_e=0;_e<=he;_e++)ne=T,T=le[(_e+1)*2+1],!(++fe<Le&&ne===T)&&(fe<o?I.bl_tree[ne*2]+=fe:ne!==0?(ne!==G&&I.bl_tree[ne*2]++,I.bl_tree[A*2]++):fe<=10?I.bl_tree[ee*2]++:I.bl_tree[D*2]++,fe=0,G=ne,T===0?(Le=138,o=3):ne===T?(Le=6,o=3):(Le=7,o=4))}function oe(I,le,he){var _e,G=-1,ne,T=le[1],fe=0,Le=7,o=4;for(T===0&&(Le=138,o=3),_e=0;_e<=he;_e++)if(ne=T,T=le[(_e+1)*2+1],!(++fe<Le&&ne===T)){if(fe<o)do Oe(I,ne,I.bl_tree);while(--fe!==0);else ne!==0?(ne!==G&&(Oe(I,ne,I.bl_tree),fe--),Oe(I,A,I.bl_tree),Re(I,fe-3,2)):fe<=10?(Oe(I,ee,I.bl_tree),Re(I,fe-3,3)):(Oe(I,D,I.bl_tree),Re(I,fe-11,7));fe=0,G=ne,T===0?(Le=138,o=3):ne===T?(Le=6,o=3):(Le=7,o=4)}}function Te(I){var le;for(se(I,I.dyn_ltree,I.l_desc.max_code),se(I,I.dyn_dtree,I.d_desc.max_code),X(I,I.bl_desc),le=C-1;le>=3&&I.bl_tree[z[le]*2+1]===0;le--);return I.opt_len+=3*(le+1)+5+5+4,le}function Ce(I,le,he,_e){var G;for(Re(I,le-257,5),Re(I,he-1,5),Re(I,_e-4,4),G=0;G<_e;G++)Re(I,I.bl_tree[z[G]*2+1],3);oe(I,I.dyn_ltree,le-1),oe(I,I.dyn_dtree,he-1)}function Ee(I){var le=4093624447,he;for(he=0;he<=31;he++,le>>>=1)if(le&1&&I.dyn_ltree[he*2]!==0)return t;if(I.dyn_ltree[18]!==0||I.dyn_ltree[20]!==0||I.dyn_ltree[26]!==0)return a;for(he=32;he<i;he++)if(I.dyn_ltree[he*2]!==0)return a;return t}var Fe=!1;function Ae(I){Fe||(ae(),Fe=!0),I.l_desc=new ue(I.dyn_ltree,Z),I.d_desc=new ue(I.dyn_dtree,j),I.bl_desc=new ue(I.bl_tree,re),I.bi_buf=0,I.bi_valid=0,Se(I)}function xe(I,le,he,_e){Re(I,(s<<1)+(_e?1:0),3),R(I,le,he)}function Ie(I){Re(I,w<<1,3),Oe(I,W,Y),M(I)}function Ne(I,le,he,_e){var G,ne,T=0;I.level>0?(I.strm.data_type===f&&(I.strm.data_type=Ee(I)),X(I,I.l_desc),X(I,I.d_desc),T=Te(I),G=I.opt_len+3+7>>>3,ne=I.static_len+3+7>>>3,ne<=G&&(G=ne)):G=ne=he+5,he+4<=G&&le!==-1?xe(I,le,he,_e):I.strategy===r||ne===G?(Re(I,(w<<1)+(_e?1:0),3),L(I,Y,$)):(Re(I,(_<<1)+(_e?1:0),3),Ce(I,I.l_desc.max_code+1,I.d_desc.max_code+1,T+1),L(I,I.dyn_ltree,I.dyn_dtree)),Se(I),_e&&we(I)}function ze(I,le,he){return I.pending_buf[I.d_buf+I.last_lit*2]=le>>>8&255,I.pending_buf[I.d_buf+I.last_lit*2+1]=le&255,I.pending_buf[I.l_buf+I.last_lit]=he&255,I.last_lit++,le===0?I.dyn_ltree[he*2]++:(I.matches++,le--,I.dyn_ltree[(ce[he]+i+1)*2]++,I.dyn_dtree[ge(le)*2]++),I.last_lit===I.lit_bufsize-1}n._tr_init=Ae,n._tr_stored_block=xe,n._tr_flush_block=Ne,n._tr_tally=ze,n._tr_align=Ie},{"../utils/common":50}],62:[function(e,g,n){function y(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}g.exports=y},{}],63:[function(e,g,n){(function(y){typeof y>"u"||!y.version||y.version.indexOf("v0.")===0||y.version.indexOf("v1.")===0&&y.version.indexOf("v1.8.")!==0?g.exports={nextTick:r}:g.exports=y;function r(t,a,f,u){if(typeof t!="function")throw new TypeError('"callback" argument must be a function');var s=arguments.length,w,_;switch(s){case 0:case 1:return y.nextTick(t);case 2:return y.nextTick(function(){t.call(null,a)});case 3:return y.nextTick(function(){t.call(null,a,f)});case 4:return y.nextTick(function(){t.call(null,a,f,u)});default:for(w=new Array(s-1),_=0;_<w.length;)w[_++]=arguments[_];return y.nextTick(function(){t.apply(null,w)})}}}).call(this,e("_process"))},{_process:64}],64:[function(e,g,n){var y=g.exports={},r,t;function a(){throw new Error("setTimeout has not been defined")}function f(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?r=setTimeout:r=a}catch{r=a}try{typeof clearTimeout=="function"?t=clearTimeout:t=f}catch{t=f}})();function u(C){if(r===setTimeout)return setTimeout(C,0);if((r===a||!r)&&setTimeout)return r=setTimeout,setTimeout(C,0);try{return r(C,0)}catch{try{return r.call(null,C,0)}catch{return r.call(this,C,0)}}}function s(C){if(t===clearTimeout)return clearTimeout(C);if((t===f||!t)&&clearTimeout)return t=clearTimeout,clearTimeout(C);try{return t(C)}catch{try{return t.call(null,C)}catch{return t.call(this,C)}}}var w=[],_=!1,S,b=-1;function p(){!_||!S||(_=!1,S.length?w=S.concat(w):b=-1,w.length&&i())}function i(){if(!_){var C=u(p);_=!0;for(var c=w.length;c;){for(S=w,w=[];++b<c;)S&&S[b].run();b=-1,c=w.length}S=null,_=!1,s(C)}}y.nextTick=function(C){var c=new Array(arguments.length-1);if(arguments.length>1)for(var E=1;E<arguments.length;E++)c[E-1]=arguments[E];w.push(new l(C,c)),w.length===1&&!_&&u(i)};function l(C,c){this.fun=C,this.array=c}l.prototype.run=function(){this.fun.apply(null,this.array)},y.title="browser",y.browser=!0,y.env={},y.argv=[],y.version="",y.versions={};function d(){}y.on=d,y.addListener=d,y.once=d,y.off=d,y.removeListener=d,y.removeAllListeners=d,y.emit=d,y.prependListener=d,y.prependOnceListener=d,y.listeners=function(C){return[]},y.binding=function(C){throw new Error("process.binding is not supported")},y.cwd=function(){return"/"},y.chdir=function(C){throw new Error("process.chdir is not supported")},y.umask=function(){return 0}},{}],65:[function(e,g,n){g.exports=e("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":66}],66:[function(e,g,n){var y=e("process-nextick-args"),r=Object.keys||function(p){var i=[];for(var l in p)i.push(l);return i};g.exports=_;var t=Object.create(e("core-util-is"));t.inherits=e("inherits");var a=e("./_stream_readable"),f=e("./_stream_writable");t.inherits(_,a);for(var u=r(f.prototype),s=0;s<u.length;s++){var w=u[s];_.prototype[w]||(_.prototype[w]=f.prototype[w])}function _(p){if(!(this instanceof _))return new _(p);a.call(this,p),f.call(this,p),p&&p.readable===!1&&(this.readable=!1),p&&p.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,p&&p.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",S)}Object.defineProperty(_.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function S(){this.allowHalfOpen||this._writableState.ended||y.nextTick(b,this)}function b(p){p.end()}Object.defineProperty(_.prototype,"destroyed",{get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(p){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=p,this._writableState.destroyed=p)}}),_.prototype._destroy=function(p,i){this.push(null),this.end(),y.nextTick(i,p)}},{"./_stream_readable":68,"./_stream_writable":70,"core-util-is":4,inherits:8,"process-nextick-args":63}],67:[function(e,g,n){g.exports=t;var y=e("./_stream_transform"),r=Object.create(e("core-util-is"));r.inherits=e("inherits"),r.inherits(t,y);function t(a){if(!(this instanceof t))return new t(a);y.call(this,a)}t.prototype._transform=function(a,f,u){u(null,a)}},{"./_stream_transform":69,"core-util-is":4,inherits:8}],68:[function(e,g,n){(function(y,r){var t=e("process-nextick-args");g.exports=W;var a=e("isarray"),f;W.ReadableState=P,e("events").EventEmitter;var u=function(M,N){return M.listeners(N).length},s=e("./internal/streams/stream"),w=e("safe-buffer").Buffer,_=r.Uint8Array||function(){};function S(M){return w.from(M)}function b(M){return w.isBuffer(M)||M instanceof _}var p=Object.create(e("core-util-is"));p.inherits=e("inherits");var i=e("util"),l=void 0;i&&i.debuglog?l=i.debuglog("stream"):l=function(){};var d=e("./internal/streams/BufferList"),C=e("./internal/streams/destroy"),c;p.inherits(W,s);var E=["error","close","destroy","pause","resume"];function O(M,N,te){if(typeof M.prependListener=="function")return M.prependListener(N,te);!M._events||!M._events[N]?M.on(N,te):a(M._events[N])?M._events[N].unshift(te):M._events[N]=[te,M._events[N]]}function P(M,N){f=f||e("./_stream_duplex"),M=M||{};var te=N instanceof f;this.objectMode=!!M.objectMode,te&&(this.objectMode=this.objectMode||!!M.readableObjectMode);var ae=M.highWaterMark,Se=M.readableHighWaterMark,we=this.objectMode?16:16*1024;ae||ae===0?this.highWaterMark=ae:te&&(Se||Se===0)?this.highWaterMark=Se:this.highWaterMark=we,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new d,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=M.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,M.encoding&&(c||(c=e("string_decoder/").StringDecoder),this.decoder=new c(M.encoding),this.encoding=M.encoding)}function W(M){if(f=f||e("./_stream_duplex"),!(this instanceof W))return new W(M);this._readableState=new P(M,this),this.readable=!0,M&&(typeof M.read=="function"&&(this._read=M.read),typeof M.destroy=="function"&&(this._destroy=M.destroy)),s.call(this)}Object.defineProperty(W.prototype,"destroyed",{get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(M){this._readableState&&(this._readableState.destroyed=M)}}),W.prototype.destroy=C.destroy,W.prototype._undestroy=C.undestroy,W.prototype._destroy=function(M,N){this.push(null),N(M)},W.prototype.push=function(M,N){var te=this._readableState,ae;return te.objectMode?ae=!0:typeof M=="string"&&(N=N||te.defaultEncoding,N!==te.encoding&&(M=w.from(M,N),N=""),ae=!0),A(this,M,N,!1,ae)},W.prototype.unshift=function(M){return A(this,M,null,!0,!1)};function A(M,N,te,ae,Se){var we=M._readableState;if(N===null)we.reading=!1,K(M,we);else{var R;Se||(R=D(we,N)),R?M.emit("error",R):we.objectMode||N&&N.length>0?(typeof N!="string"&&!we.objectMode&&Object.getPrototypeOf(N)!==w.prototype&&(N=S(N)),ae?we.endEmitted?M.emit("error",new Error("stream.unshift() after end event")):ee(M,we,N,!0):we.ended?M.emit("error",new Error("stream.push() after EOF")):(we.reading=!1,we.decoder&&!te?(N=we.decoder.write(N),we.objectMode||N.length!==0?ee(M,we,N,!1):V(M,we)):ee(M,we,N,!1))):ae||(we.reading=!1)}return B(we)}function ee(M,N,te,ae){N.flowing&&N.length===0&&!N.sync?(M.emit("data",te),M.read(0)):(N.length+=N.objectMode?1:te.length,ae?N.buffer.unshift(te):N.buffer.push(te),N.needReadable&&Y(M)),V(M,N)}function D(M,N){var te;return!b(N)&&typeof N!="string"&&N!==void 0&&!M.objectMode&&(te=new TypeError("Invalid non-string/buffer chunk")),te}function B(M){return!M.ended&&(M.needReadable||M.length<M.highWaterMark||M.length===0)}W.prototype.isPaused=function(){return this._readableState.flowing===!1},W.prototype.setEncoding=function(M){return c||(c=e("string_decoder/").StringDecoder),this._readableState.decoder=new c(M),this._readableState.encoding=M,this};var U=8388608;function x(M){return M>=U?M=U:(M--,M|=M>>>1,M|=M>>>2,M|=M>>>4,M|=M>>>8,M|=M>>>16,M++),M}function z(M,N){return M<=0||N.length===0&&N.ended?0:N.objectMode?1:M!==M?N.flowing&&N.length?N.buffer.head.data.length:N.length:(M>N.highWaterMark&&(N.highWaterMark=x(M)),M<=N.length?M:N.ended?N.length:(N.needReadable=!0,0))}W.prototype.read=function(M){l("read",M),M=parseInt(M,10);var N=this._readableState,te=M;if(M!==0&&(N.emittedReadable=!1),M===0&&N.needReadable&&(N.length>=N.highWaterMark||N.ended))return l("read: emitReadable",N.length,N.ended),N.length===0&&N.ended?Re(this):Y(this),null;if(M=z(M,N),M===0&&N.ended)return N.length===0&&Re(this),null;var ae=N.needReadable;l("need readable",ae),(N.length===0||N.length-M<N.highWaterMark)&&(ae=!0,l("length less than watermark",ae)),N.ended||N.reading?(ae=!1,l("reading or ended",ae)):ae&&(l("do read"),N.reading=!0,N.sync=!0,N.length===0&&(N.needReadable=!0),this._read(N.highWaterMark),N.sync=!1,N.reading||(M=z(te,N)));var Se;return M>0?Se=re(M,N):Se=null,Se===null?(N.needReadable=!0,M=0):N.length-=M,N.length===0&&(N.ended||(N.needReadable=!0),te!==M&&N.ended&&Re(this)),Se!==null&&this.emit("data",Se),Se};function K(M,N){if(!N.ended){if(N.decoder){var te=N.decoder.end();te&&te.length&&(N.buffer.push(te),N.length+=N.objectMode?1:te.length)}N.ended=!0,Y(M)}}function Y(M){var N=M._readableState;N.needReadable=!1,N.emittedReadable||(l("emitReadable",N.flowing),N.emittedReadable=!0,N.sync?t.nextTick($,M):$(M))}function $(M){l("emit readable"),M.emit("readable"),j(M)}function V(M,N){N.readingMore||(N.readingMore=!0,t.nextTick(ce,M,N))}function ce(M,N){for(var te=N.length;!N.reading&&!N.flowing&&!N.ended&&N.length<N.highWaterMark&&(l("maybeReadMore read 0"),M.read(0),te!==N.length);)te=N.length;N.readingMore=!1}W.prototype._read=function(M){this.emit("error",new Error("_read() is not implemented"))},W.prototype.pipe=function(M,N){var te=this,ae=this._readableState;switch(ae.pipesCount){case 0:ae.pipes=M;break;case 1:ae.pipes=[ae.pipes,M];break;default:ae.pipes.push(M);break}ae.pipesCount+=1,l("pipe count=%d opts=%j",ae.pipesCount,N);var Se=(!N||N.end!==!1)&&M!==y.stdout&&M!==y.stderr,we=Se?v:Fe;ae.endEmitted?t.nextTick(we):te.once("end",we),M.on("unpipe",R);function R(Ae,xe){l("onunpipe"),Ae===te&&xe&&xe.hasUnpiped===!1&&(xe.hasUnpiped=!0,X())}function v(){l("onend"),M.end()}var m=ie(te);M.on("drain",m);var L=!1;function X(){l("cleanup"),M.removeListener("close",Ce),M.removeListener("finish",Ee),M.removeListener("drain",m),M.removeListener("error",Te),M.removeListener("unpipe",R),te.removeListener("end",v),te.removeListener("end",Fe),te.removeListener("data",oe),L=!0,ae.awaitDrain&&(!M._writableState||M._writableState.needDrain)&&m()}var se=!1;te.on("data",oe);function oe(Ae){l("ondata"),se=!1;var xe=M.write(Ae);xe===!1&&!se&&((ae.pipesCount===1&&ae.pipes===M||ae.pipesCount>1&&ke(ae.pipes,M)!==-1)&&!L&&(l("false write response, pause",te._readableState.awaitDrain),te._readableState.awaitDrain++,se=!0),te.pause())}function Te(Ae){l("onerror",Ae),Fe(),M.removeListener("error",Te),u(M,"error")===0&&M.emit("error",Ae)}O(M,"error",Te);function Ce(){M.removeListener("finish",Ee),Fe()}M.once("close",Ce);function Ee(){l("onfinish"),M.removeListener("close",Ce),Fe()}M.once("finish",Ee);function Fe(){l("unpipe"),te.unpipe(M)}return M.emit("pipe",te),ae.flowing||(l("pipe resume"),te.resume()),M};function ie(M){return function(){var N=M._readableState;l("pipeOnDrain",N.awaitDrain),N.awaitDrain&&N.awaitDrain--,N.awaitDrain===0&&u(M,"data")&&(N.flowing=!0,j(M))}}W.prototype.unpipe=function(M){var N=this._readableState,te={hasUnpiped:!1};if(N.pipesCount===0)return this;if(N.pipesCount===1)return M&&M!==N.pipes?this:(M||(M=N.pipes),N.pipes=null,N.pipesCount=0,N.flowing=!1,M&&M.emit("unpipe",this,te),this);if(!M){var ae=N.pipes,Se=N.pipesCount;N.pipes=null,N.pipesCount=0,N.flowing=!1;for(var we=0;we<Se;we++)ae[we].emit("unpipe",this,te);return this}var R=ke(N.pipes,M);return R===-1?this:(N.pipes.splice(R,1),N.pipesCount-=1,N.pipesCount===1&&(N.pipes=N.pipes[0]),M.emit("unpipe",this,te),this)},W.prototype.on=function(M,N){var te=s.prototype.on.call(this,M,N);if(M==="data")this._readableState.flowing!==!1&&this.resume();else if(M==="readable"){var ae=this._readableState;!ae.endEmitted&&!ae.readableListening&&(ae.readableListening=ae.needReadable=!0,ae.emittedReadable=!1,ae.reading?ae.length&&Y(this):t.nextTick(de,this))}return te},W.prototype.addListener=W.prototype.on;function de(M){l("readable nexttick read 0"),M.read(0)}W.prototype.resume=function(){var M=this._readableState;return M.flowing||(l("resume"),M.flowing=!0,ve(this,M)),this};function ve(M,N){N.resumeScheduled||(N.resumeScheduled=!0,t.nextTick(Z,M,N))}function Z(M,N){N.reading||(l("resume read 0"),M.read(0)),N.resumeScheduled=!1,N.awaitDrain=0,M.emit("resume"),j(M),N.flowing&&!N.reading&&M.read(0)}W.prototype.pause=function(){return l("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(l("pause"),this._readableState.flowing=!1,this.emit("pause")),this};function j(M){var N=M._readableState;for(l("flow",N.flowing);N.flowing&&M.read()!==null;);}W.prototype.wrap=function(M){var N=this,te=this._readableState,ae=!1;M.on("end",function(){if(l("wrapped end"),te.decoder&&!te.ended){var R=te.decoder.end();R&&R.length&&N.push(R)}N.push(null)}),M.on("data",function(R){if(l("wrapped data"),te.decoder&&(R=te.decoder.write(R)),!(te.objectMode&&R==null)&&!(!te.objectMode&&(!R||!R.length))){var v=N.push(R);v||(ae=!0,M.pause())}});for(var Se in M)this[Se]===void 0&&typeof M[Se]=="function"&&(this[Se]=(function(R){return function(){return M[R].apply(M,arguments)}})(Se));for(var we=0;we<E.length;we++)M.on(E[we],this.emit.bind(this,E[we]));return this._read=function(R){l("wrapped _read",R),ae&&(ae=!1,M.resume())},this},Object.defineProperty(W.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),W._fromList=re;function re(M,N){if(N.length===0)return null;var te;return N.objectMode?te=N.buffer.shift():!M||M>=N.length?(N.decoder?te=N.buffer.join(""):N.buffer.length===1?te=N.buffer.head.data:te=N.buffer.concat(N.length),N.buffer.clear()):te=ue(M,N.buffer,N.decoder),te}function ue(M,N,te){var ae;return M<N.head.data.length?(ae=N.head.data.slice(0,M),N.head.data=N.head.data.slice(M)):M===N.head.data.length?ae=N.shift():ae=te?ge(M,N):me(M,N),ae}function ge(M,N){var te=N.head,ae=1,Se=te.data;for(M-=Se.length;te=te.next;){var we=te.data,R=M>we.length?we.length:M;if(R===we.length?Se+=we:Se+=we.slice(0,M),M-=R,M===0){R===we.length?(++ae,te.next?N.head=te.next:N.head=N.tail=null):(N.head=te,te.data=we.slice(R));break}++ae}return N.length-=ae,Se}function me(M,N){var te=w.allocUnsafe(M),ae=N.head,Se=1;for(ae.data.copy(te),M-=ae.data.length;ae=ae.next;){var we=ae.data,R=M>we.length?we.length:M;if(we.copy(te,te.length-M,0,R),M-=R,M===0){R===we.length?(++Se,ae.next?N.head=ae.next:N.head=N.tail=null):(N.head=ae,ae.data=we.slice(R));break}++Se}return N.length-=Se,te}function Re(M){var N=M._readableState;if(N.length>0)throw new Error('"endReadable()" called on non-empty stream');N.endEmitted||(N.ended=!0,t.nextTick(Oe,N,M))}function Oe(M,N){!M.endEmitted&&M.length===0&&(M.endEmitted=!0,N.readable=!1,N.emit("end"))}function ke(M,N){for(var te=0,ae=M.length;te<ae;te++)if(M[te]===N)return te;return-1}}).call(this,e("_process"),typeof lt<"u"?lt:typeof self<"u"?self:typeof window<"u"?window:{})},{"./_stream_duplex":66,"./internal/streams/BufferList":71,"./internal/streams/destroy":72,"./internal/streams/stream":73,_process:64,"core-util-is":4,events:5,inherits:8,isarray:10,"process-nextick-args":63,"safe-buffer":78,"string_decoder/":81,util:2}],69:[function(e,g,n){g.exports=a;var y=e("./_stream_duplex"),r=Object.create(e("core-util-is"));r.inherits=e("inherits"),r.inherits(a,y);function t(s,w){var _=this._transformState;_.transforming=!1;var S=_.writecb;if(!S)return this.emit("error",new Error("write callback called multiple times"));_.writechunk=null,_.writecb=null,w!=null&&this.push(w),S(s);var b=this._readableState;b.reading=!1,(b.needReadable||b.length<b.highWaterMark)&&this._read(b.highWaterMark)}function a(s){if(!(this instanceof a))return new a(s);y.call(this,s),this._transformState={afterTransform:t.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,s&&(typeof s.transform=="function"&&(this._transform=s.transform),typeof s.flush=="function"&&(this._flush=s.flush)),this.on("prefinish",f)}function f(){var s=this;typeof this._flush=="function"?this._flush(function(w,_){u(s,w,_)}):u(this,null,null)}a.prototype.push=function(s,w){return this._transformState.needTransform=!1,y.prototype.push.call(this,s,w)},a.prototype._transform=function(s,w,_){throw new Error("_transform() is not implemented")},a.prototype._write=function(s,w,_){var S=this._transformState;if(S.writecb=_,S.writechunk=s,S.writeencoding=w,!S.transforming){var b=this._readableState;(S.needTransform||b.needReadable||b.length<b.highWaterMark)&&this._read(b.highWaterMark)}},a.prototype._read=function(s){var w=this._transformState;w.writechunk!==null&&w.writecb&&!w.transforming?(w.transforming=!0,this._transform(w.writechunk,w.writeencoding,w.afterTransform)):w.needTransform=!0},a.prototype._destroy=function(s,w){var _=this;y.prototype._destroy.call(this,s,function(S){w(S),_.emit("close")})};function u(s,w,_){if(w)return s.emit("error",w);if(_!=null&&s.push(_),s._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(s._transformState.transforming)throw new Error("Calling transform done when still transforming");return s.push(null)}},{"./_stream_duplex":66,"core-util-is":4,inherits:8}],70:[function(e,g,n){(function(y,r,t){var a=e("process-nextick-args");g.exports=O;function f(Z){var j=this;this.next=null,this.entry=null,this.finish=function(){ve(j,Z)}}var u=!y.browser&&["v0.10","v0.9."].indexOf(y.version.slice(0,5))>-1?t:a.nextTick,s;O.WritableState=c;var w=Object.create(e("core-util-is"));w.inherits=e("inherits");var _={deprecate:e("util-deprecate")},S=e("./internal/streams/stream"),b=e("safe-buffer").Buffer,p=r.Uint8Array||function(){};function i(Z){return b.from(Z)}function l(Z){return b.isBuffer(Z)||Z instanceof p}var d=e("./internal/streams/destroy");w.inherits(O,S);function C(){}function c(Z,j){s=s||e("./_stream_duplex"),Z=Z||{};var re=j instanceof s;this.objectMode=!!Z.objectMode,re&&(this.objectMode=this.objectMode||!!Z.writableObjectMode);var ue=Z.highWaterMark,ge=Z.writableHighWaterMark,me=this.objectMode?16:16*1024;ue||ue===0?this.highWaterMark=ue:re&&(ge||ge===0)?this.highWaterMark=ge:this.highWaterMark=me,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var Re=Z.decodeStrings===!1;this.decodeStrings=!Re,this.defaultEncoding=Z.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(Oe){x(j,Oe)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new f(this)}c.prototype.getBuffer=function(){for(var j=this.bufferedRequest,re=[];j;)re.push(j),j=j.next;return re},(function(){try{Object.defineProperty(c.prototype,"buffer",{get:_.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}})();var E;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(E=Function.prototype[Symbol.hasInstance],Object.defineProperty(O,Symbol.hasInstance,{value:function(Z){return E.call(this,Z)?!0:this!==O?!1:Z&&Z._writableState instanceof c}})):E=function(Z){return Z instanceof this};function O(Z){if(s=s||e("./_stream_duplex"),!E.call(O,this)&&!(this instanceof s))return new O(Z);this._writableState=new c(Z,this),this.writable=!0,Z&&(typeof Z.write=="function"&&(this._write=Z.write),typeof Z.writev=="function"&&(this._writev=Z.writev),typeof Z.destroy=="function"&&(this._destroy=Z.destroy),typeof Z.final=="function"&&(this._final=Z.final)),S.call(this)}O.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))};function P(Z,j){var re=new Error("write after end");Z.emit("error",re),a.nextTick(j,re)}function W(Z,j,re,ue){var ge=!0,me=!1;return re===null?me=new TypeError("May not write null values to stream"):typeof re!="string"&&re!==void 0&&!j.objectMode&&(me=new TypeError("Invalid non-string/buffer chunk")),me&&(Z.emit("error",me),a.nextTick(ue,me),ge=!1),ge}O.prototype.write=function(Z,j,re){var ue=this._writableState,ge=!1,me=!ue.objectMode&&l(Z);return me&&!b.isBuffer(Z)&&(Z=i(Z)),typeof j=="function"&&(re=j,j=null),me?j="buffer":j||(j=ue.defaultEncoding),typeof re!="function"&&(re=C),ue.ended?P(this,re):(me||W(this,ue,Z,re))&&(ue.pendingcb++,ge=ee(this,ue,me,Z,j,re)),ge},O.prototype.cork=function(){var Z=this._writableState;Z.corked++},O.prototype.uncork=function(){var Z=this._writableState;Z.corked&&(Z.corked--,!Z.writing&&!Z.corked&&!Z.finished&&!Z.bufferProcessing&&Z.bufferedRequest&&Y(this,Z))},O.prototype.setDefaultEncoding=function(j){if(typeof j=="string"&&(j=j.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((j+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+j);return this._writableState.defaultEncoding=j,this};function A(Z,j,re){return!Z.objectMode&&Z.decodeStrings!==!1&&typeof j=="string"&&(j=b.from(j,re)),j}Object.defineProperty(O.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function ee(Z,j,re,ue,ge,me){if(!re){var Re=A(j,ue,ge);ue!==Re&&(re=!0,ge="buffer",ue=Re)}var Oe=j.objectMode?1:ue.length;j.length+=Oe;var ke=j.length<j.highWaterMark;if(ke||(j.needDrain=!0),j.writing||j.corked){var M=j.lastBufferedRequest;j.lastBufferedRequest={chunk:ue,encoding:ge,isBuf:re,callback:me,next:null},M?M.next=j.lastBufferedRequest:j.bufferedRequest=j.lastBufferedRequest,j.bufferedRequestCount+=1}else D(Z,j,!1,Oe,ue,ge,me);return ke}function D(Z,j,re,ue,ge,me,Re){j.writelen=ue,j.writecb=Re,j.writing=!0,j.sync=!0,re?Z._writev(ge,j.onwrite):Z._write(ge,me,j.onwrite),j.sync=!1}function B(Z,j,re,ue,ge){--j.pendingcb,re?(a.nextTick(ge,ue),a.nextTick(ie,Z,j),Z._writableState.errorEmitted=!0,Z.emit("error",ue)):(ge(ue),Z._writableState.errorEmitted=!0,Z.emit("error",ue),ie(Z,j))}function U(Z){Z.writing=!1,Z.writecb=null,Z.length-=Z.writelen,Z.writelen=0}function x(Z,j){var re=Z._writableState,ue=re.sync,ge=re.writecb;if(U(re),j)B(Z,re,ue,j,ge);else{var me=$(re);!me&&!re.corked&&!re.bufferProcessing&&re.bufferedRequest&&Y(Z,re),ue?u(z,Z,re,me,ge):z(Z,re,me,ge)}}function z(Z,j,re,ue){re||K(Z,j),j.pendingcb--,ue(),ie(Z,j)}function K(Z,j){j.length===0&&j.needDrain&&(j.needDrain=!1,Z.emit("drain"))}function Y(Z,j){j.bufferProcessing=!0;var re=j.bufferedRequest;if(Z._writev&&re&&re.next){var ue=j.bufferedRequestCount,ge=new Array(ue),me=j.corkedRequestsFree;me.entry=re;for(var Re=0,Oe=!0;re;)ge[Re]=re,re.isBuf||(Oe=!1),re=re.next,Re+=1;ge.allBuffers=Oe,D(Z,j,!0,j.length,ge,"",me.finish),j.pendingcb++,j.lastBufferedRequest=null,me.next?(j.corkedRequestsFree=me.next,me.next=null):j.corkedRequestsFree=new f(j),j.bufferedRequestCount=0}else{for(;re;){var ke=re.chunk,M=re.encoding,N=re.callback,te=j.objectMode?1:ke.length;if(D(Z,j,!1,te,ke,M,N),re=re.next,j.bufferedRequestCount--,j.writing)break}re===null&&(j.lastBufferedRequest=null)}j.bufferedRequest=re,j.bufferProcessing=!1}O.prototype._write=function(Z,j,re){re(new Error("_write() is not implemented"))},O.prototype._writev=null,O.prototype.end=function(Z,j,re){var ue=this._writableState;typeof Z=="function"?(re=Z,Z=null,j=null):typeof j=="function"&&(re=j,j=null),Z!=null&&this.write(Z,j),ue.corked&&(ue.corked=1,this.uncork()),!ue.ending&&!ue.finished&&de(this,ue,re)};function $(Z){return Z.ending&&Z.length===0&&Z.bufferedRequest===null&&!Z.finished&&!Z.writing}function V(Z,j){Z._final(function(re){j.pendingcb--,re&&Z.emit("error",re),j.prefinished=!0,Z.emit("prefinish"),ie(Z,j)})}function ce(Z,j){!j.prefinished&&!j.finalCalled&&(typeof Z._final=="function"?(j.pendingcb++,j.finalCalled=!0,a.nextTick(V,Z,j)):(j.prefinished=!0,Z.emit("prefinish")))}function ie(Z,j){var re=$(j);return re&&(ce(Z,j),j.pendingcb===0&&(j.finished=!0,Z.emit("finish"))),re}function de(Z,j,re){j.ending=!0,ie(Z,j),re&&(j.finished?a.nextTick(re):Z.once("finish",re)),j.ended=!0,Z.writable=!1}function ve(Z,j,re){var ue=Z.entry;for(Z.entry=null;ue;){var ge=ue.callback;j.pendingcb--,ge(re),ue=ue.next}j.corkedRequestsFree?j.corkedRequestsFree.next=Z:j.corkedRequestsFree=Z}Object.defineProperty(O.prototype,"destroyed",{get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(Z){this._writableState&&(this._writableState.destroyed=Z)}}),O.prototype.destroy=d.destroy,O.prototype._undestroy=d.undestroy,O.prototype._destroy=function(Z,j){this.end(),j(Z)}}).call(this,e("_process"),typeof lt<"u"?lt:typeof self<"u"?self:typeof window<"u"?window:{},e("timers").setImmediate)},{"./_stream_duplex":66,"./internal/streams/destroy":72,"./internal/streams/stream":73,_process:64,"core-util-is":4,inherits:8,"process-nextick-args":63,"safe-buffer":78,timers:82,"util-deprecate":83}],71:[function(e,g,n){function y(f,u){if(!(f instanceof u))throw new TypeError("Cannot call a class as a function")}var r=e("safe-buffer").Buffer,t=e("util");function a(f,u,s){f.copy(u,s)}g.exports=(function(){function f(){y(this,f),this.head=null,this.tail=null,this.length=0}return f.prototype.push=function(s){var w={data:s,next:null};this.length>0?this.tail.next=w:this.head=w,this.tail=w,++this.length},f.prototype.unshift=function(s){var w={data:s,next:this.head};this.length===0&&(this.tail=w),this.head=w,++this.length},f.prototype.shift=function(){if(this.length!==0){var s=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,s}},f.prototype.clear=function(){this.head=this.tail=null,this.length=0},f.prototype.join=function(s){if(this.length===0)return"";for(var w=this.head,_=""+w.data;w=w.next;)_+=s+w.data;return _},f.prototype.concat=function(s){if(this.length===0)return r.alloc(0);if(this.length===1)return this.head.data;for(var w=r.allocUnsafe(s>>>0),_=this.head,S=0;_;)a(_.data,w,S),S+=_.data.length,_=_.next;return w},f})(),t&&t.inspect&&t.inspect.custom&&(g.exports.prototype[t.inspect.custom]=function(){var f=t.inspect({length:this.length});return this.constructor.name+" "+f})},{"safe-buffer":78,util:2}],72:[function(e,g,n){var y=e("process-nextick-args");function r(f,u){var s=this,w=this._readableState&&this._readableState.destroyed,_=this._writableState&&this._writableState.destroyed;return w||_?(u?u(f):f&&(!this._writableState||!this._writableState.errorEmitted)&&y.nextTick(a,this,f),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(f||null,function(S){!u&&S?(y.nextTick(a,s,S),s._writableState&&(s._writableState.errorEmitted=!0)):u&&u(S)}),this)}function t(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function a(f,u){f.emit("error",u)}g.exports={destroy:r,undestroy:t}},{"process-nextick-args":63}],73:[function(e,g,n){g.exports=e("events").EventEmitter},{events:5}],74:[function(e,g,n){g.exports=e("./readable").PassThrough},{"./readable":75}],75:[function(e,g,n){n=g.exports=e("./lib/_stream_readable.js"),n.Stream=n,n.Readable=n,n.Writable=e("./lib/_stream_writable.js"),n.Duplex=e("./lib/_stream_duplex.js"),n.Transform=e("./lib/_stream_transform.js"),n.PassThrough=e("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":66,"./lib/_stream_passthrough.js":67,"./lib/_stream_readable.js":68,"./lib/_stream_transform.js":69,"./lib/_stream_writable.js":70}],76:[function(e,g,n){g.exports=e("./readable").Transform},{"./readable":75}],77:[function(e,g,n){g.exports=e("./lib/_stream_writable.js")},{"./lib/_stream_writable.js":70}],78:[function(e,g,n){var y=e("buffer"),r=y.Buffer;function t(f,u){for(var s in f)u[s]=f[s]}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?g.exports=y:(t(y,n),n.Buffer=a);function a(f,u,s){return r(f,u,s)}t(r,a),a.from=function(f,u,s){if(typeof f=="number")throw new TypeError("Argument must not be a number");return r(f,u,s)},a.alloc=function(f,u,s){if(typeof f!="number")throw new TypeError("Argument must be a number");var w=r(f);return u!==void 0?typeof s=="string"?w.fill(u,s):w.fill(u):w.fill(0),w},a.allocUnsafe=function(f){if(typeof f!="number")throw new TypeError("Argument must be a number");return r(f)},a.allocUnsafeSlow=function(f){if(typeof f!="number")throw new TypeError("Argument must be a number");return y.SlowBuffer(f)}},{buffer:3}],79:[function(e,g,n){(function(y){g.exports=typeof y=="function"?y:function(){var t=[].slice.apply(arguments);t.splice(1,0,0),setTimeout.apply(null,t)}}).call(this,e("timers").setImmediate)},{timers:82}],80:[function(e,g,n){g.exports=t;var y=e("events").EventEmitter,r=e("inherits");r(t,y),t.Readable=e("readable-stream/readable.js"),t.Writable=e("readable-stream/writable.js"),t.Duplex=e("readable-stream/duplex.js"),t.Transform=e("readable-stream/transform.js"),t.PassThrough=e("readable-stream/passthrough.js"),t.Stream=t;function t(){y.call(this)}t.prototype.pipe=function(a,f){var u=this;function s(l){a.writable&&a.write(l)===!1&&u.pause&&u.pause()}u.on("data",s);function w(){u.readable&&u.resume&&u.resume()}a.on("drain",w),!a._isStdio&&(!f||f.end!==!1)&&(u.on("end",S),u.on("close",b));var _=!1;function S(){_||(_=!0,a.end())}function b(){_||(_=!0,typeof a.destroy=="function"&&a.destroy())}function p(l){if(i(),y.listenerCount(this,"error")===0)throw l}u.on("error",p),a.on("error",p);function i(){u.removeListener("data",s),a.removeListener("drain",w),u.removeListener("end",S),u.removeListener("close",b),u.removeListener("error",p),a.removeListener("error",p),u.removeListener("end",i),u.removeListener("close",i),a.removeListener("close",i)}return u.on("end",i),u.on("close",i),a.on("close",i),a.emit("pipe",u),a}},{events:5,inherits:8,"readable-stream/duplex.js":65,"readable-stream/passthrough.js":74,"readable-stream/readable.js":75,"readable-stream/transform.js":76,"readable-stream/writable.js":77}],81:[function(e,g,n){var y=e("safe-buffer").Buffer,r=y.isEncoding||function(E){switch(E=""+E,E&&E.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function t(E){if(!E)return"utf8";for(var O;;)switch(E){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return E;default:if(O)return;E=(""+E).toLowerCase(),O=!0}}function a(E){var O=t(E);if(typeof O!="string"&&(y.isEncoding===r||!r(E)))throw new Error("Unknown encoding: "+E);return O||E}n.StringDecoder=f;function f(E){this.encoding=a(E);var O;switch(this.encoding){case"utf16le":this.text=p,this.end=i,O=4;break;case"utf8":this.fillLast=_,O=4;break;case"base64":this.text=l,this.end=d,O=3;break;default:this.write=C,this.end=c;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=y.allocUnsafe(O)}f.prototype.write=function(E){if(E.length===0)return"";var O,P;if(this.lastNeed){if(O=this.fillLast(E),O===void 0)return"";P=this.lastNeed,this.lastNeed=0}else P=0;return P<E.length?O?O+this.text(E,P):this.text(E,P):O||""},f.prototype.end=b,f.prototype.text=S,f.prototype.fillLast=function(E){if(this.lastNeed<=E.length)return E.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);E.copy(this.lastChar,this.lastTotal-this.lastNeed,0,E.length),this.lastNeed-=E.length};function u(E){return E<=127?0:E>>5===6?2:E>>4===14?3:E>>3===30?4:E>>6===2?-1:-2}function s(E,O,P){var W=O.length-1;if(W<P)return 0;var A=u(O[W]);return A>=0?(A>0&&(E.lastNeed=A-1),A):--W<P||A===-2?0:(A=u(O[W]),A>=0?(A>0&&(E.lastNeed=A-2),A):--W<P||A===-2?0:(A=u(O[W]),A>=0?(A>0&&(A===2?A=0:E.lastNeed=A-3),A):0))}function w(E,O,P){if((O[0]&192)!==128)return E.lastNeed=0,"";if(E.lastNeed>1&&O.length>1){if((O[1]&192)!==128)return E.lastNeed=1,"";if(E.lastNeed>2&&O.length>2&&(O[2]&192)!==128)return E.lastNeed=2,""}}function _(E){var O=this.lastTotal-this.lastNeed,P=w(this,E);if(P!==void 0)return P;if(this.lastNeed<=E.length)return E.copy(this.lastChar,O,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);E.copy(this.lastChar,O,0,E.length),this.lastNeed-=E.length}function S(E,O){var P=s(this,E,O);if(!this.lastNeed)return E.toString("utf8",O);this.lastTotal=P;var W=E.length-(P-this.lastNeed);return E.copy(this.lastChar,0,W),E.toString("utf8",O,W)}function b(E){var O=E&&E.length?this.write(E):"";return this.lastNeed?O+"":O}function p(E,O){if((E.length-O)%2===0){var P=E.toString("utf16le",O);if(P){var W=P.charCodeAt(P.length-1);if(W>=55296&&W<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=E[E.length-2],this.lastChar[1]=E[E.length-1],P.slice(0,-1)}return P}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=E[E.length-1],E.toString("utf16le",O,E.length-1)}function i(E){var O=E&&E.length?this.write(E):"";if(this.lastNeed){var P=this.lastTotal-this.lastNeed;return O+this.lastChar.toString("utf16le",0,P)}return O}function l(E,O){var P=(E.length-O)%3;return P===0?E.toString("base64",O):(this.lastNeed=3-P,this.lastTotal=3,P===1?this.lastChar[0]=E[E.length-1]:(this.lastChar[0]=E[E.length-2],this.lastChar[1]=E[E.length-1]),E.toString("base64",O,E.length-P))}function d(E){var O=E&&E.length?this.write(E):"";return this.lastNeed?O+this.lastChar.toString("base64",0,3-this.lastNeed):O}function C(E){return E.toString(this.encoding)}function c(E){return E&&E.length?this.write(E):""}},{"safe-buffer":78}],82:[function(e,g,n){(function(y,r){var t=e("process/browser.js").nextTick,a=Function.prototype.apply,f=Array.prototype.slice,u={},s=0;n.setTimeout=function(){return new w(a.call(setTimeout,window,arguments),clearTimeout)},n.setInterval=function(){return new w(a.call(setInterval,window,arguments),clearInterval)},n.clearTimeout=n.clearInterval=function(_){_.close()};function w(_,S){this._id=_,this._clearFn=S}w.prototype.unref=w.prototype.ref=function(){},w.prototype.close=function(){this._clearFn.call(window,this._id)},n.enroll=function(_,S){clearTimeout(_._idleTimeoutId),_._idleTimeout=S},n.unenroll=function(_){clearTimeout(_._idleTimeoutId),_._idleTimeout=-1},n._unrefActive=n.active=function(_){clearTimeout(_._idleTimeoutId);var S=_._idleTimeout;S>=0&&(_._idleTimeoutId=setTimeout(function(){_._onTimeout&&_._onTimeout()},S))},n.setImmediate=typeof y=="function"?y:function(_){var S=s++,b=arguments.length<2?!1:f.call(arguments,1);return u[S]=!0,t(function(){u[S]&&(b?_.apply(null,b):_.call(null),n.clearImmediate(S))}),S},n.clearImmediate=typeof r=="function"?r:function(_){delete u[_]}}).call(this,e("timers").setImmediate,e("timers").clearImmediate)},{"process/browser.js":64,timers:82}],83:[function(e,g,n){(function(y){g.exports=r;function r(a,f){if(t("noDeprecation"))return a;var u=!1;function s(){if(!u){if(t("throwDeprecation"))throw new Error(f);t("traceDeprecation")?console.trace(f):console.warn(f),u=!0}return a.apply(this,arguments)}return s}function t(a){try{if(!y.localStorage)return!1}catch{return!1}var f=y.localStorage[a];return f==null?!1:String(f).toLowerCase()==="true"}}).call(this,typeof lt<"u"?lt:typeof self<"u"?self:typeof window<"u"?window:{})},{}],84:[function(e,g,n){var y=function(f){return f&&f.__esModule?f:{default:f}};Object.defineProperty(n,"__esModule",{value:!0}),n.HandleZip=void 0;var r=y(e("jszip")),t=e("./common/method"),a=(function(){function f(u){this.uploadFile=u}return f.prototype.unzipFile=function(u,s){r.default.loadAsync(this.uploadFile).then(function(w){var _={},S=Object.keys(w.files).length,b=0;w.forEach(function(p,i){var l=i.name,d=l.split("."),C=d[d.length-1].toLowerCase(),c="string";C in{png:1,jpeg:1,jpg:1,gif:1,bmp:1,tif:1,webp:1}?c="base64":C=="emf"&&(c="arraybuffer"),i.async(c).then(function(E){c=="base64"&&(E="data:image/"+C+";base64,"+E),_[i.name]=E,S==b+1&&u(_),b++})})},function(w){s(w)})},f.prototype.unzipFileByUrl=function(u,s,w){new r.default,t.getBinaryContent(u,function(_,S){if(_)throw _;r.default.loadAsync(S).then(function(b){var p={},i=Object.keys(b.files).length,l=0;b.forEach(function(d,C){var c=C.name,E=c.split("."),O=E[E.length-1].toLowerCase(),P="string";O in{png:1,jpeg:1,jpg:1,gif:1,bmp:1,tif:1,webp:1}?P="base64":O=="emf"&&(P="arraybuffer"),C.async(P).then(function(W){P=="base64"&&(W="data:image/"+O+";base64,"+W),p[C.name]=W,i==l+1&&s(p),l++})})},function(b){w(b)})})},f.prototype.newZipFile=function(){var u=new r.default;this.workBook=u},f.prototype.addToZipFile=function(u,s){if(this.workBook==null){var w=new r.default;this.workBook=w}this.workBook.file(u,s)},f})();n.HandleZip=a},{"./common/method":93,jszip:20}],85:[function(e,g,n){Object.defineProperty(n,"__esModule",{value:!0}),n.LuckyImageBase=n.LuckysheetCalcChain=n.LuckySheetConfigMerge=n.LuckySheetborderInfoCellValueStyle=n.LuckySheetborderInfoCellValue=n.LuckySheetborderInfoCellForImp=n.LuckyConfig=n.LuckyInlineString=n.LuckySheetCellFormat=n.LuckySheetCelldataValue=n.LuckySheetCelldataBase=n.LuckyFileInfo=n.LuckySheetBase=n.LuckyFileBase=void 0;var y=(function(){function d(){}return d})();n.LuckyFileBase=y;var r=(function(){function d(){}return d})();n.LuckySheetBase=r;var t=(function(){function d(){}return d})();n.LuckyFileInfo=t;var a=(function(){function d(){}return d})();n.LuckySheetCelldataBase=a;var f=(function(){function d(){}return d})();n.LuckySheetCelldataValue=f;var u=(function(){function d(){}return d})();n.LuckySheetCellFormat=u;var s=(function(){function d(){}return d})();n.LuckyInlineString=s;var w=(function(){function d(){}return d})();n.LuckyConfig=w;var _=(function(){function d(){}return d})();n.LuckySheetborderInfoCellForImp=_;var S=(function(){function d(){}return d})();n.LuckySheetborderInfoCellValue=S;var b=(function(){function d(){}return d})();n.LuckySheetborderInfoCellValueStyle=b;var p=(function(){function d(){}return d})();n.LuckySheetConfigMerge=p;var i=(function(){function d(){}return d})();n.LuckysheetCalcChain=i;var l=(function(){function d(){}return d})();n.LuckyImageBase=l},{}],86:[function(e,g,n){var y=(function(){var s=function(_,S){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,p){b.__proto__=p}||function(b,p){for(var i in p)p.hasOwnProperty(i)&&(b[i]=p[i])},s(_,S)};return function(w,_){s(w,_);function S(){this.constructor=w}w.prototype=_===null?Object.create(_):(S.prototype=_.prototype,new S)}})();Object.defineProperty(n,"__esModule",{value:!0}),n.LuckySheetCelldata=void 0;var r=e("./ReadXml"),t=e("../common/method"),a=e("../common/constant"),f=e("./LuckyBase"),u=(function(s){y(w,s);function w(_,S,b,p,i,l){var d=s.call(this)||this;d.cell=_,d.sheetFile=i,d.styles=S,d.sharedStrings=b,d.readXml=l,d.mergeCells=p;var C=_.attributeList,c=C.r,E=C.s,O=C.t,P=t.getcellrange(c);return d.r=P.row[0],d.c=P.column[0],d.v=d.generateValue(E,O),d}return w.prototype.generateValue=function(_,S){var b=this,p=this.cell.getInnerElements("v"),i=this.cell.getInnerElements("f");p==null&&(p=this.cell.getInnerElements("t"));var l=this.styles.cellXfs,d=this.styles.cellStyleXfs;this.styles.cellStyles;var C=this.styles.fonts,c=this.styles.fills,E=this.styles.borders,O=this.styles.numfmts,P=this.styles.clrScheme,W=this.sharedStrings,A=new f.LuckySheetCelldataValue;if(i!=null){var ee=i[0],D=ee.attributeList,B=D.t,U=D.ref,x=D.si,z=i[0].value;B=="shared"&&(this._fomulaRef=U,this._formulaType=B,this._formulaSi=x),(U!=null||z!=null&&z.length>0)&&(z=t.escapeCharacter(z),A.f="="+z)}var K=null,Y;if(_!=null){var $=parseInt(_),V=l[$],ce=V.attributeList.xfId,ie=void 0,de=void 0,ve=void 0,Z=void 0,j=void 0,re=void 0,ue=void 0,ge=void 0;if(ce!=null){var me=d[parseInt(ce)],D=me.attributeList,Re=D.applyNumberFormat,Oe=D.applyFont,ke=D.applyFill,M=D.applyBorder,N=D.applyAlignment;if(D.applyProtection,Y=D.quotePrefix,Re!="0"&&D.numFmtId!=null&&(ie=D.numFmtId),Oe!="0"&&D.fontId!=null&&(de=D.fontId),ke!="0"&&D.fillId!=null&&(ve=D.fillId),M!="0"&&D.borderId!=null&&(Z=D.borderId),N!=null&&N!="0"){var te=me.getInnerElements("alignment");if(te!=null){var ae=te[0].attributeList;ae.horizontal!=null&&(j=ae.horizontal),ae.vertical!=null&&(re=ae.vertical),ae.wrapText!=null&&(ue=ae.wrapText),ae.textRotation!=null&&(ge=ae.textRotation),ae.shrinkToFit!=null&&ae.shrinkToFit,ae.indent!=null&&ae.indent}}}var Se=V.attributeList.applyNumberFormat,we=V.attributeList.applyFont,R=V.attributeList.applyFill,v=V.attributeList.applyBorder,m=V.attributeList.applyAlignment;if(V.attributeList.applyProtection!=null&&V.attributeList.applyProtection,V.attributeList.quotePrefix!=null&&(Y=V.attributeList.quotePrefix),Se!="0"&&V.attributeList.numFmtId!=null&&(ie=V.attributeList.numFmtId),we!="0"&&(de=V.attributeList.fontId),R!="0"&&(ve=V.attributeList.fillId),v!="0"&&(Z=V.attributeList.borderId),m!="0"){var te=V.getInnerElements("alignment");if(te!=null&&te.length>0){var D=te[0].attributeList;D.horizontal!=null&&(j=D.horizontal),D.vertical!=null&&(re=D.vertical),D.wrapText!=null&&(ue=D.wrapText),D.textRotation!=null&&(ge=D.textRotation),D.shrinkToFit!=null&&D.shrinkToFit,D.indent!=null&&D.indent}}if(ie!=null){var L=O[parseInt(ie)],X=new f.LuckySheetCellFormat;X.fa=t.escapeCharacter(L),X.t=S,A.ct=X}if(ve!=null){var se=parseInt(ve),oe=c[se],Te=this.getBackgroundByFill(oe,P);Te!=null&&(A.bg=Te)}if(de!=null){var Ce=parseInt(de),Ee=C[Ce];if(Ee!=null){var Fe=Ee.getInnerElements("sz"),Ae=Ee.getInnerElements("color"),xe=Ee.getInnerElements("name"),Ie=Ee.getInnerElements("family");Ee.getInnerElements("charset");var Ne=Ee.getInnerElements("b"),ze=Ee.getInnerElements("i"),I=Ee.getInnerElements("strike"),le=Ee.getInnerElements("u");if(Fe!=null&&Fe.length>0){var he=Fe[0].attributeList.val;he!=null&&(A.fs=parseInt(he))}if(Ae!=null&&Ae.length>0){var _e=Ae[0],G=r.getColor(_e,this.styles,"t");G!=null&&(A.fc=G)}if(Ie!=null&&Ie.length>0){var ne=Ie[0].attributeList.val;ne!=null&&(K=a.fontFamilys[ne])}if(xe!=null&&xe.length>0){var ne=xe[0].attributeList.val;ne!=null&&(A.ff=ne)}if(Ne!=null&&Ne.length>0){var T=Ne[0].attributeList.val;T=="0"?A.bl=0:A.bl=1}if(ze!=null&&ze.length>0){var fe=ze[0].attributeList.val;fe=="0"?A.it=0:A.it=1}if(I!=null&&I.length>0){var Le=I[0].attributeList.val;Le=="0"?A.cl=0:A.cl=1}if(le!=null&&le.length>0){var o=le[0].attributeList.val;o=="single"?A.un=1:o=="double"?A.un=2:o=="singleAccounting"?A.un=3:o=="doubleAccounting"?A.un=4:A.un=0}}}if(j!=null&&(j=="center"||j=="centerContinuous"?A.ht=0:j=="left"?A.ht=1:j=="right"?A.ht=2:j=="distributed"?A.ht=0:j=="fill"||j=="general"?A.ht=1:j=="justify"?A.ht=0:A.ht=1),re!=null&&(re=="bottom"?A.vt=2:re=="center"||re=="distributed"||re=="justify"?A.vt=0:(re=="top",A.vt=1)),ue!=null&&ue=="1"?A.tb=2:A.tb=1,ge!=null&&(ge=="255"?A.tr=3:(A.tr=0,A.rt=parseInt(ge))),Z!=null){var Q=parseInt(Z),q=E[Q],k=new f.LuckySheetborderInfoCellForImp;k.rangeType="cell";var H=new f.LuckySheetborderInfoCellValue;H.row_index=this.r,H.col_index=this.c;var J=q.getInnerElements("left"),be=q.getInnerElements("right"),pe=q.getInnerElements("top"),ye=q.getInnerElements("bottom"),Me=q.getInnerElements("diagonal"),qe=q.getInnerElements("start"),He=q.getInnerElements("end"),Be=this.getBorderInfo(J),Xe=this.getBorderInfo(be),je=this.getBorderInfo(pe),Ve=this.getBorderInfo(ye);this.getBorderInfo(Me);var st=this.getBorderInfo(qe),ot=this.getBorderInfo(He),Ue=!1;st!=null&&st.color!=null&&(H.l=st,Ue=!0),ot!=null&&ot.color!=null&&(H.r=ot,Ue=!0),Be!=null&&Be.color!=null&&(H.l=Be,Ue=!0),Xe!=null&&Xe.color!=null&&(H.r=Xe,Ue=!0),je!=null&&je.color!=null&&(H.t=je,Ue=!0),Ve!=null&&Ve.color!=null&&(H.b=Ve,Ue=!0),Ue&&(k.value=H,this._borderObject=k)}}else A.tb=1;if(p!=null){var Ye=p[0].value;if(/&#\d+;/.test(Ye)&&(Ye=this.htmlDecode(Ye)),S==a.ST_CellType.SharedString){var Ke=parseInt(p[0].value),$e=W[Ke],Je=$e.getInnerElements("r");if(Je==null){var pt=$e.getInnerElements("t");if(pt!=null){var et="";if(pt.forEach(function(Br){et+=Br.value}),et=t.escapeCharacter(et),K=="Roman"&&et.length>0){var St=et.split(""),Tt=null,vt="",Mt=null,rr="Times New Roman";A.ff!=null&&(rr=A.ff);var X=A.ct;X==null&&(X=new f.LuckySheetCellFormat),X.s==null&&(X.s=[]);for(var gt=0;gt<St.length;gt++){var ft=St[gt],ct=null,ht=rr;if(t.isChinese(ft)?(ct="c",ht=""):t.isJapanese(ft)?(ct="j",ht="Yu Gothic"):t.isKoera(ft)?(ct="k",ht="Malgun Gothic"):ct="e",ct!=Tt&&Tt!=null||gt==St.length-1){var Ze=new f.LuckyInlineString;if(Ze.ff=Mt,A.fc!=null&&(Ze.fc=A.fc),A.fs!=null&&(Ze.fs=A.fs),A.cl!=null&&(Ze.cl=A.cl),A.un!=null&&(Ze.un=A.un),A.bl!=null&&(Ze.bl=A.bl),A.it!=null&&(Ze.it=A.it),gt==St.length-1)if(ct==Tt)Ze.ff=ht,Ze.v=vt+ft;else{Ze.ff=Mt,Ze.v=vt,X.s.push(Ze);var at=new f.LuckyInlineString;at.ff=ht,at.v=ft,A.fc!=null&&(at.fc=A.fc),A.fs!=null&&(at.fs=A.fs),A.cl!=null&&(at.cl=A.cl),A.un!=null&&(at.un=A.un),A.bl!=null&&(at.bl=A.bl),A.it!=null&&(at.it=A.it),X.s.push(at);break}else Ze.v=vt;X.s.push(Ze),vt=ft}else vt+=ft;Tt=ct,Mt=ht}X.t="inlineStr",A.ct=X}else if(et=this.replaceSpecialWrap(et),et.indexOf(`\r
`)>-1||et.indexOf(`
`)>-1){var Ze=new f.LuckyInlineString;Ze.v=et;var X=A.ct;X==null&&(X=new f.LuckySheetCellFormat),A.ff!=null&&(Ze.ff=A.ff),A.fc!=null&&(Ze.fc=A.fc),A.fs!=null&&(Ze.fs=A.fs),A.cl!=null&&(Ze.cl=A.cl),A.un!=null&&(Ze.un=A.un),A.bl!=null&&(Ze.bl=A.bl),A.it!=null&&(Ze.it=A.it),X.t="inlineStr",X.s=[Ze],A.ct=X}else A.v=et,Y="1"}}else{var ir=[];Je.forEach(function(nr){var Dt=nr.getInnerElements("t"),Nt=nr.getInnerElements("rPr"),Pe=new f.LuckyInlineString;if(Dt!=null&&Dt.length>0){var mt=Dt[0].value;mt=b.replaceSpecialWrap(mt),mt=t.escapeCharacter(mt),Pe.v=mt}if(Nt!=null&&Nt.length>0){var tt=Nt[0],ar=r.getlineStringAttr(tt,"sz"),sr=r.getlineStringAttr(tt,"rFont");r.getlineStringAttr(tt,"family"),r.getlineStringAttr(tt,"charset"),r.getlineStringAttr(tt,"scheme");var or=r.getlineStringAttr(tt,"b"),lr=r.getlineStringAttr(tt,"i"),ur=r.getlineStringAttr(tt,"u"),fr=r.getlineStringAttr(tt,"strike"),cr=r.getlineStringAttr(tt,"vertAlign"),Pt=void 0,xt=tt.getInnerElements("color");xt!=null&&xt.length>0&&(Pt=r.getColor(xt[0],b.styles,"t"));var Ut=void 0;sr!=null&&(Ut=sr),Ut!=null?Pe.ff=Ut:A.ff!=null&&(Pe.ff=A.ff),Pt!=null?Pe.fc=Pt:A.fc!=null&&(Pe.fc=A.fc),ar!=null?Pe.fs=parseInt(ar):A.fs!=null&&(Pe.fs=A.fs),fr!=null?Pe.cl=parseInt(fr):A.cl!=null&&(Pe.cl=A.cl),ur!=null?Pe.un=parseInt(ur):A.un!=null&&(Pe.un=A.un),or!=null?Pe.bl=parseInt(or):A.bl!=null&&(Pe.bl=A.bl),lr!=null?Pe.it=parseInt(lr):A.it!=null&&(Pe.it=A.it),cr!=null&&(Pe.va=parseInt(cr))}else Pe.ff==null&&A.ff!=null&&(Pe.ff=A.ff),Pe.fc==null&&A.fc!=null&&(Pe.fc=A.fc),Pe.fs==null&&A.fs!=null&&(Pe.fs=A.fs),Pe.cl==null&&A.cl!=null&&(Pe.cl=A.cl),Pe.un==null&&A.un!=null&&(Pe.un=A.un),Pe.bl==null&&A.bl!=null&&(Pe.bl=A.bl),Pe.it==null&&A.it!=null&&(Pe.it=A.it);ir.push(Pe)});var X=A.ct;X==null&&(X=new f.LuckySheetCellFormat),X.t="inlineStr",X.s=ir,A.ct=X}}else Ye=t.escapeCharacter(Ye),A.v=Ye}return Y!=null&&(A.qp=parseInt(Y)),A},w.prototype.replaceSpecialWrap=function(_){return _=_.replace(/_x000D_/g,"").replace(/&#13;&#10;/g,`\r
`).replace(/&#13;/g,"\r").replace(/&#10;/g,`
`),_},w.prototype.getBackgroundByFill=function(_,S){var b=_.getInnerElements("patternFill");if(b!=null){var p=b[0],i=p.getInnerElements("fgColor"),l=p.getInnerElements("bgColor"),d=void 0,C=void 0;if(i!=null){var c=i[0];d=r.getColor(c,this.styles)}if(l!=null){var E=l[0];C=r.getColor(E,this.styles)}if(d!=null)return d;if(C!=null)return C}else{var O=_.getInnerElements("gradientFill");if(O!=null)return null}},w.prototype.getBorderInfo=function(_){if(_==null)return null;var S=_[0],b=S.attributeList;this.styles.clrScheme;var p=b.style;if(p==null||p=="none")return null;var i=S.getInnerElements("color"),l="#000000";if(i!=null){var d=i[0];l=r.getColor(d,this.styles,"b"),l==null&&(l="#000000")}var C=new f.LuckySheetborderInfoCellValueStyle;return C.style=a.borderTypes[p],C.color=l,C},w.prototype.htmlDecode=function(_){return _.replace(/&#(x)?([^&]{1,5});?/g,function(S,b,p){return String.fromCharCode(parseInt(p,b?16:10))})},w})(f.LuckySheetCelldataBase);n.LuckySheetCelldata=u},{"../common/constant":91,"../common/method":93,"./LuckyBase":85,"./ReadXml":90}],87:[function(e,g,n){var y=(function(){var _=function(b,p){return _=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,l){i.__proto__=l}||function(i,l){for(var d in l)l.hasOwnProperty(d)&&(i[d]=l[d])},_(b,p)};return function(S,b){_(S,b);function p(){this.constructor=S}S.prototype=b===null?Object.create(b):(p.prototype=b.prototype,new p)}})();Object.defineProperty(n,"__esModule",{value:!0}),n.LuckyFile=void 0;var r=e("./LuckySheet"),t=e("../common/constant"),a=e("./ReadXml"),f=e("../common/method"),u=e("./LuckyBase"),s=e("./LuckyImage"),w=(function(_){y(S,_);function S(b,p){var i=_.call(this)||this;i.columnWidthSet=[],i.rowHeightSet=[],i.files=b,i.fileName=p,i.readXml=new a.ReadXml(b),i.getSheetNameList(),i.sharedStrings=i.readXml.getElementsByTagName("sst/si",t.sharedStringsFile),i.calcChain=i.readXml.getElementsByTagName("calcChain/c",t.calcChainFile),i.styles={},i.styles.cellXfs=i.readXml.getElementsByTagName("cellXfs/xf",t.stylesFile),i.styles.cellStyleXfs=i.readXml.getElementsByTagName("cellStyleXfs/xf",t.stylesFile),i.styles.cellStyles=i.readXml.getElementsByTagName("cellStyles/cellStyle",t.stylesFile),i.styles.fonts=i.readXml.getElementsByTagName("fonts/font",t.stylesFile),i.styles.fills=i.readXml.getElementsByTagName("fills/fill",t.stylesFile),i.styles.borders=i.readXml.getElementsByTagName("borders/border",t.stylesFile),i.styles.clrScheme=i.readXml.getElementsByTagName("a:clrScheme/a:dk1|a:lt1|a:dk2|a:lt2|a:accent1|a:accent2|a:accent3|a:accent4|a:accent5|a:accent6|a:hlink|a:folHlink",t.theme1File),i.styles.indexedColors=i.readXml.getElementsByTagName("colors/indexedColors/rgbColor",t.stylesFile),i.styles.mruColors=i.readXml.getElementsByTagName("colors/mruColors/color",t.stylesFile),i.imageList=new s.ImageList(b);for(var l=i.readXml.getElementsByTagName("numFmt/numFmt",t.stylesFile),d=JSON.parse(JSON.stringify(t.numFmtDefault)),C=0;C<l.length;C++){var c=l[C].attributeList,E=f.getXmlAttibute(c,"numFmtId","49"),O=f.getXmlAttibute(c,"formatCode","@");E in t.numFmtDefault||(d[E]=O)}return i.styles.numfmts=d,i}return S.prototype.getSheetNameList=function(){var b=this.readXml.getElementsByTagName("Relationships/Relationship",t.workbookRels);if(b!=null){for(var p=new RegExp("worksheets/[^/]*?.xml"),i={},l=0;l<b.length;l++){var d=b[l],C=d.attributeList,c=C.Id,E=C.Target;p.test(E)&&(E.startsWith("/xl")?i[c]=E.substr(1):i[c]="xl/"+E)}this.sheetNameList=i}},S.prototype.getSheetFileBysheetId=function(b){return this.sheetNameList[b]},S.prototype.getWorkBookInfo=function(){var b=this.readXml.getElementsByTagName("Company",t.appFile),p=this.readXml.getElementsByTagName("AppVersion",t.appFile),i=this.readXml.getElementsByTagName("dc:creator",t.coreFile),l=this.readXml.getElementsByTagName("cp:lastModifiedBy",t.coreFile),d=this.readXml.getElementsByTagName("dcterms:created",t.coreFile),C=this.readXml.getElementsByTagName("dcterms:modified",t.coreFile);this.info=new u.LuckyFileInfo,this.info.name=this.fileName,this.info.creator=i.length>0?i[0].value:"",this.info.lastmodifiedby=l.length>0?l[0].value:"",this.info.createdTime=d.length>0?d[0].value:"",this.info.modifiedTime=C.length>0?C[0].value:"",this.info.company=b.length>0?b[0].value:"",this.info.appversion=p.length>0?p[0].value:""},S.prototype.getSheetsFull=function(b){b===void 0&&(b=!0);var p=this.readXml.getElementsByTagName("sheets/sheet",t.workBookFile),i={};for(var l in p){var d=p[l];i[d.attributeList.name]=d.attributeList.sheetId}this.sheets=[];var C=0;for(var l in p){var d=p[l],c=d.attributeList.name,E=d.attributeList.sheetId,O=d.attributeList["r:id"],P=this.getSheetFileBysheetId(O),W=this.readXml.getElementsByTagName("worksheet/drawing",P),A=void 0,ee=void 0;if(W!=null&&W.length>0){var D=W[0].attributeList,B=f.getXmlAttibute(D,"r:id",null);B!=null&&(A=this.getDrawingFile(B,P),ee=this.getDrawingRelsFile(A))}if(P!=null){var U=new r.LuckySheet(c,E,C,b,{sheetFile:P,readXml:this.readXml,sheetList:i,styles:this.styles,sharedStrings:this.sharedStrings,calcChain:this.calcChain,imageList:this.imageList,drawingFile:A,drawingRelsFile:ee});this.columnWidthSet=[],this.rowHeightSet=[],this.imagePositionCaculation(U),this.sheets.push(U),C++}}},S.prototype.extendArray=function(b,p,i,l,d){if(!(b<p.length)){var C=p.length,c=b,E=0;C>0&&(E=p[C-1]);for(var O=C;O<=c;O++){var P=i,W=O.toString();W in l?P=0:W in d&&(P=d[W]),E+=Math.round(P+1),p.push(E)}}},S.prototype.imagePositionCaculation=function(b){var p=b.images,i=b.defaultColWidth,l=b.defaultRowHeight,d={};b.config.colhidden&&(d=b.config.colhidden);var C={};b.config.columnlen&&(C=b.config.columnlen);var c={};b.config.rowhidden&&(c=b.config.rowhidden);var E={};b.config.rowlen&&(E=b.config.rowlen);for(var O in p){var P=p[O],W=P.fromCol,A=P.fromColOff,ee=P.fromRow,D=P.fromRowOff,B=P.toCol,U=P.toColOff,x=P.toRow,z=P.toRowOff,K=0,Y=0,$=0,V=0;W>=this.columnWidthSet.length&&this.extendArray(W,this.columnWidthSet,i,d,C),W==0?K=0:K=this.columnWidthSet[W-1],K=K+A,ee>=this.rowHeightSet.length&&this.extendArray(ee,this.rowHeightSet,l,c,E),ee==0?Y=0:Y=this.rowHeightSet[ee-1],Y=Y+D,B>=this.columnWidthSet.length&&this.extendArray(B,this.columnWidthSet,i,d,C),B==0?$=0:$=this.columnWidthSet[B-1],$=$+U-K,x>=this.rowHeightSet.length&&this.extendArray(x,this.rowHeightSet,l,c,E),x==0?V=0:V=this.rowHeightSet[x-1],V=V+z-Y,console.log(i,d,C),console.log(W,this.columnWidthSet[W],A),console.log(B,this.columnWidthSet[B],U,JSON.stringify(this.columnWidthSet)),P.originWidth=$,P.originHeight=V,P.crop.height=V,P.crop.width=$,P.default.height=V,P.default.left=K,P.default.top=Y,P.default.width=$}console.log(this.columnWidthSet,this.rowHeightSet)},S.prototype.getDrawingFile=function(b,p){var i="xl/worksheets/_rels/",l=p.split("/"),d=l[l.length-1],C=i+d+".rels",c=this.readXml.getElementsByTagName("Relationships/Relationship",C);if(c.length>0)for(var E=0;E<c.length;E++){var O=c[E],P=O.attributeList,W=f.getXmlAttibute(P,"Id",null);if(W==b){var A=f.getXmlAttibute(P,"Target",null);if(A!=null)return A.replace(/\.\.\//g,"")}}return null},S.prototype.getDrawingRelsFile=function(b){var p="xl/drawings/_rels/",i=b.split("/"),l=i[i.length-1],d=p+l+".rels";return d},S.prototype.getSheetsWithoutCell=function(){this.getSheetsFull(!1)},S.prototype.Parse=function(){return this.getWorkBookInfo(),this.getSheetsFull(),this.toJsonString(this)},S.prototype.toJsonString=function(b){var p=new u.LuckyFileBase;return p.info=b.info,p.sheets=[],b.sheets.forEach(function(i){var l=new u.LuckySheetBase;i.name!=null&&(l.name=i.name),i.color!=null&&(l.color=i.color),i.config!=null&&(l.config=i.config),i.index!=null&&(l.index=i.index),i.status!=null&&(l.status=i.status),i.order!=null&&(l.order=i.order),i.row!=null&&(l.row=i.row),i.column!=null&&(l.column=i.column),i.luckysheet_select_save!=null&&(l.luckysheet_select_save=i.luckysheet_select_save),i.scrollLeft!=null&&(l.scrollLeft=i.scrollLeft),i.scrollTop!=null&&(l.scrollTop=i.scrollTop),i.zoomRatio!=null&&(l.zoomRatio=i.zoomRatio),i.showGridLines!=null&&(l.showGridLines=i.showGridLines),i.defaultColWidth!=null&&(l.defaultColWidth=i.defaultColWidth),i.defaultRowHeight!=null&&(l.defaultRowHeight=i.defaultRowHeight),i.celldata!=null&&(l.celldata=[],i.celldata.forEach(function(d){var C=new u.LuckySheetCelldataBase;C.r=d.r,C.c=d.c,C.v=d.v,l.celldata.push(C)})),i.chart!=null&&(l.chart=i.chart),i.isPivotTable!=null&&(l.isPivotTable=i.isPivotTable),i.pivotTable!=null&&(l.pivotTable=i.pivotTable),i.luckysheet_conditionformat_save!=null&&(l.luckysheet_conditionformat_save=i.luckysheet_conditionformat_save),i.freezen!=null&&(l.freezen=i.freezen),i.calcChain!=null&&(l.calcChain=i.calcChain),i.images!=null&&(l.images=i.images),p.sheets.push(l)}),JSON.stringify(p)},S})(u.LuckyFileBase);n.LuckyFile=w},{"../common/constant":91,"../common/method":93,"./LuckyBase":85,"./LuckyImage":88,"./LuckySheet":89,"./ReadXml":90}],88:[function(e,g,n){var y=(function(){var u=function(w,_){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(S,b){S.__proto__=b}||function(S,b){for(var p in b)b.hasOwnProperty(p)&&(S[p]=b[p])},u(w,_)};return function(s,w){u(s,w);function _(){this.constructor=s}s.prototype=w===null?Object.create(w):(_.prototype=w.prototype,new _)}})();Object.defineProperty(n,"__esModule",{value:!0}),n.ImageList=void 0;var r=e("./LuckyBase"),t=e("../common/emf"),a=(function(){function u(s){if(s!=null){this.images={};for(var w in s)if(w.indexOf("xl/media/")>-1){var _=w.split("."),S=_[_.length-1].toLowerCase();if(S in{png:1,jpeg:1,jpg:1,gif:1,bmp:1,tif:1,webp:1,emf:1})if(S=="emf"){var b=0,p=1,i=new t.ToContext2D(b,p),l,d,C;t.FromEMF.K=[],l=t.FromEMF.C,d=t.FromEMF.K,C=4;for(var c in l)d[l[c]]=c.slice(C);t.FromEMF.Parse(s[w],i),this.images[w]=i.canvas.toDataURL("image/png")}else this.images[w]=s[w]}}}return u.prototype.getImageByName=function(s){if(s in this.images){var w=this.images[s];return new f(s,w)}return null},u})();n.ImageList=a;var f=(function(u){y(s,u);function s(w,_){var S=u.call(this)||this;return S.src=_,S}return s.prototype.setDefault=function(){},s})(r.LuckyImageBase)},{"../common/emf":92,"./LuckyBase":85}],89:[function(e,g,n){var y=(function(){var s=function(_,S){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,p){b.__proto__=p}||function(b,p){for(var i in p)p.hasOwnProperty(i)&&(b[i]=p[i])},s(_,S)};return function(w,_){s(w,_);function S(){this.constructor=w}w.prototype=_===null?Object.create(_):(S.prototype=_.prototype,new S)}})();Object.defineProperty(n,"__esModule",{value:!0}),n.LuckySheet=void 0;var r=e("./LuckyCell"),t=e("../common/method"),a=e("./ReadXml"),f=e("./LuckyBase"),u=(function(s){y(w,s);function w(_,S,b,p,i){p===void 0&&(p=!1);var l=s.call(this)||this;l.isInitialCell=p,l.readXml=i.readXml,l.sheetFile=i.sheetFile,l.styles=i.styles,l.sharedStrings=i.sharedStrings,l.calcChainEles=i.calcChain,l.sheetList=i.sheetList,l.imageList=i.imageList,l.name=_,l.index=S,l.order=b.toString(),l.config=new f.LuckyConfig,l.celldata=[],l.mergeCells=l.readXml.getElementsByTagName("mergeCells/mergeCell",l.sheetFile),l.styles.clrScheme;var d=l.readXml.getElementsByTagName("sheetViews/sheetView",l.sheetFile),C="1",c="0",E="100",O="A1";if(d.length>0){var P=d[0].attributeList;C=t.getXmlAttibute(P,"showGridLines","1"),c=t.getXmlAttibute(P,"tabSelected","0"),E=t.getXmlAttibute(P,"zoomScale","100");var W=d[0].getInnerElements("selection");if(W!=null&&W.length>0){O=t.getXmlAttibute(W[0].attributeList,"activeCell","A1");var A=t.getcellrange(O,l.sheetList,S);l.luckysheet_select_save=[],l.luckysheet_select_save.push(A)}}l.showGridLines=C,l.status=c,l.zoomRatio=parseInt(E)/100;var ee=l.readXml.getElementsByTagName("sheetPr/tabColor",l.sheetFile);if(ee!=null&&ee.length>0){var D=ee[0],P=D.attributeList,B=a.getColor(D,l.styles,"b");l.color=B}var U=l.readXml.getElementsByTagName("sheetFormatPr",l.sheetFile),x,z;if(U.length>0){var P=U[0].attributeList;x=t.getXmlAttibute(P,"defaultColWidth","9.21"),z=t.getXmlAttibute(P,"defaultRowHeight","19")}l.defaultColWidth=t.getColumnWidthPixel(parseFloat(x)),l.defaultRowHeight=t.getRowHeightPixel(parseFloat(z)),l.generateConfigColumnLenAndHidden();var K=l.generateConfigRowLenAndHiddenAddCell();if(l.formulaRefList!=null)for(var Y in l.formulaRefList){var $=l.formulaRefList[Y],V=$.mainRef,ce=V.cellValue,ie=V.fv,de=ce.r,ve=ce.c;for(var Z in $)if(Z!="mainRef"){var j=$[Z],re=j.cellValue;if(re!=null){var ue=re.r,ge=re.c,me=ie,Re=ue-de,Oe=ge-ve;Re>0?me="="+t.fromulaRef.functionCopy(me,"down",Re):Re<0&&(me="="+t.fromulaRef.functionCopy(me,"up",Math.abs(Re))),Oe>0?me="="+t.fromulaRef.functionCopy(me,"right",Oe):Oe<0&&(me="="+t.fromulaRef.functionCopy(me,"left",Math.abs(Oe))),re.v.f=me}}}l.calcChain==null&&(l.calcChain=[]);for(var ke={},ge=0;ge<l.calcChainEles.length;ge++){var M=l.calcChainEles[ge],P=M.attributeList;if(P.i==S){var ue=P.r,N=P.i;P.l,P.s,P.a,P.t;var A=t.getcellrange(ue),te=new f.LuckysheetCalcChain;te.r=A.row[0],te.c=A.column[0],te.index=l.index,l.calcChain.push(te),ke["r"+ue+"c"+ge]=null}}for(var Y in K.formulaList)if(!(Y in ke)){var ae=K.formulaList[Y],te=new f.LuckysheetCalcChain;te.r=ae.r,te.c=ae.c,te.index=l.index,l.calcChain.push(te)}if(l.mergeCells!=null)for(var N=0;N<l.mergeCells.length;N++){var Se=l.mergeCells[N],P=Se.attributeList,we=P.ref;if(we!=null){var A=t.getcellrange(we,l.sheetList,S),R=new f.LuckySheetConfigMerge;R.r=A.row[0],R.c=A.column[0],R.rs=A.row[1]-A.row[0]+1,R.cs=A.column[1]-A.column[0]+1,l.config.merge==null&&(l.config.merge={}),l.config.merge[A.row[0]+"_"+A.column[0]]=R}}var v=i.drawingFile,m=i.drawingRelsFile;if(v!=null&&m!=null){var L=l.readXml.getElementsByTagName("xdr:twoCellAnchor",v);if(L!=null&&L.length>0)for(var N=0;N<L.length;N++){var X=L[N],se=t.getXmlAttibute(X.attributeList,"editAs","twoCell"),oe=X.getInnerElements("xdr:from"),Te=X.getInnerElements("xdr:to"),Ce=X.getInnerElements("a:blip");if(oe!=null&&Ce!=null&&oe.length>0&&Ce.length>0){var Ee=oe[0],Fe=Te[0],Ae=Ce[0],xe=t.getXmlAttibute(Ae.attributeList,"r:embed",null),Ie=l.getBase64ByRid(xe,m),Ne=0,ze=0,I=0,le=0;Ie.fromCol=l.getXdrValue(Ee.getInnerElements("xdr:col")),Ie.fromColOff=t.getPxByEMUs(l.getXdrValue(Ee.getInnerElements("xdr:colOff"))),Ie.fromRow=l.getXdrValue(Ee.getInnerElements("xdr:row")),Ie.fromRowOff=t.getPxByEMUs(l.getXdrValue(Ee.getInnerElements("xdr:rowOff"))),Ie.toCol=l.getXdrValue(Fe.getInnerElements("xdr:col")),Ie.toColOff=t.getPxByEMUs(l.getXdrValue(Fe.getInnerElements("xdr:colOff"))),Ie.toRow=l.getXdrValue(Fe.getInnerElements("xdr:row")),Ie.toRowOff=t.getPxByEMUs(l.getXdrValue(Fe.getInnerElements("xdr:rowOff"))),Ie.originWidth=I,Ie.originHeight=le,se=="absolute"?Ie.type="3":se=="oneCell"?Ie.type="2":Ie.type="1",Ie.isFixedPos=!1,Ie.fixedLeft=0,Ie.fixedTop=0;var he={color:"#000",radius:0,style:"solid",width:0};Ie.border=he;var _e={height:le,offsetLeft:0,offsetTop:0,width:I};Ie.crop=_e;var G={height:le,left:Ne,top:ze,width:I};Ie.default=G,l.images==null&&(l.images={}),l.images[t.generateRandomIndex("image")]=Ie}}}return l}return w.prototype.getXdrValue=function(_){return _==null||_.length==0?null:parseInt(_[0].value)},w.prototype.getBase64ByRid=function(_,S){var b=this.readXml.getElementsByTagName("Relationships/Relationship",S);if(b!=null&&b.length>0)for(var p=0;p<b.length;p++){var i=b[p],l=i.attributeList,d=t.getXmlAttibute(l,"Id",null),C=t.getXmlAttibute(l,"Target",null);if(d==_){C=C.replace(/\.\.\//g,""),C="xl/"+C;var c=this.imageList.getImageByName(C);return c}}return null},w.prototype.generateConfigColumnLenAndHidden=function(){for(var _=this.readXml.getElementsByTagName("cols/col",this.sheetFile),S=0;S<_.length;S++){var b=_[S],p=b.attributeList,i=t.getXmlAttibute(p,"min",null),l=t.getXmlAttibute(p,"max",null),d=t.getXmlAttibute(p,"width",null),C=t.getXmlAttibute(p,"hidden",null),c=t.getXmlAttibute(p,"customWidth",null);if(!(i==null||l==null))for(var E=parseInt(i)-1,O=parseInt(l)-1,P=parseFloat(d),W=E;W<=O;W++)d!=null&&(this.config.columnlen==null&&(this.config.columnlen={}),this.config.columnlen[W]=t.getColumnWidthPixel(P)),C=="1"&&(this.config.colhidden==null&&(this.config.colhidden={}),this.config.colhidden[W]=0,this.config.columnlen&&delete this.config.columnlen[W]),c!=null&&(this.config.customWidth==null&&(this.config.customWidth={}),this.config.customWidth[W]=1)}},w.prototype.generateConfigRowLenAndHiddenAddCell=function(){var _=this.readXml.getElementsByTagName("sheetData/row",this.sheetFile),S={},b={};S.formulaList=b;for(var p=0;p<_.length;p++){var i=_[p],l=i.attributeList,d=t.getXmlAttibute(l,"r",null),C=t.getXmlAttibute(l,"ht",null),c=t.getXmlAttibute(l,"hidden",null),E=t.getXmlAttibute(l,"customHeight",null);if(d!=null){var O=parseInt(d)-1;if(C!=null){var P=parseFloat(C);this.config.rowlen==null&&(this.config.rowlen={}),this.config.rowlen[O]=t.getRowHeightPixel(P)}if(c=="1"&&(this.config.rowhidden==null&&(this.config.rowhidden={}),this.config.rowhidden[O]=0,this.config.rowlen&&delete this.config.rowlen[O]),E!=null&&(this.config.customHeight==null&&(this.config.customHeight={}),this.config.customHeight[O]=1),this.isInitialCell){var W=i.getInnerElements("c");for(var A in W){var ee=W[A],D=new r.LuckySheetCelldata(ee,this.styles,this.sharedStrings,this.mergeCells,this.sheetFile,this.readXml);if(D._borderObject!=null&&(this.config.borderInfo==null&&(this.config.borderInfo=[]),this.config.borderInfo.push(D._borderObject),delete D._borderObject),D._formulaType=="shared"){this.formulaRefList==null&&(this.formulaRefList={}),this.formulaRefList[D._formulaSi]==null&&(this.formulaRefList[D._formulaSi]={});var B=void 0;D.v!=null&&(B=D.v.f);var U={t:D._formulaType,ref:D._fomulaRef,si:D._formulaSi,fv:B,cellValue:D};D._fomulaRef!=null?this.formulaRefList[D._formulaSi].mainRef=U:this.formulaRefList[D._formulaSi][D.r+"_"+D.c]=U}if(D.v!=null&&D.v.f!=null){var x={r:D.r,c:D.c};S.formulaList["r"+D.r+"c"+D.c]=x}this.celldata.push(D)}}}}return S},w})(f.LuckySheetBase);n.LuckySheet=u},{"../common/method":93,"./LuckyBase":85,"./LuckyCell":86,"./ReadXml":90}],90:[function(e,g,n){var y=(function(){var S=function(p,i){return S=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,d){l.__proto__=d}||function(l,d){for(var C in d)d.hasOwnProperty(C)&&(l[C]=d[C])},S(p,i)};return function(b,p){S(b,p);function i(){this.constructor=b}b.prototype=p===null?Object.create(p):(i.prototype=p.prototype,new i)}})();Object.defineProperty(n,"__esModule",{value:!0}),n.getlineStringAttr=n.getColor=n.Element=n.ReadXml=void 0;var r=e("../common/constant"),t=e("../common/method"),a=(function(){function S(){}return S.prototype.getElementsByOneTag=function(b,p){var i;if(b.indexOf("|")>-1){for(var l=b.split("|"),d="",C=0;C<l.length;C++){var c=l[C];d+="|<"+c+" [^>]+?[^/]>[\\s\\S]*?</"+c+">|<"+c+" [^>]+?/>|<"+c+">[\\s\\S]*?</"+c+">|<"+c+"/>"}d=d.substr(1,d.length),i=new RegExp(d,"g")}else i=new RegExp("<"+b+" [^>]+?[^/]>[\\s\\S]*?</"+b+">|<"+b+" [^>]+?/>|<"+b+">[\\s\\S]*?</"+b+">|<"+b+"/>","g");var E=p.match(i);return E??[]},S})(),f=(function(S){y(b,S);function b(p){var i=S.call(this)||this;return i.originFile=p,i}return b.prototype.getElementsByTagName=function(p,i){var l=this.getFileByName(i),d=p.split("/"),C;for(var c in d){var E=d[c];if(C==null)C=this.getElementsByOneTag(E,l);else if(C instanceof Array){var O=[];for(var P in C){var W=C[P];O=O.concat(this.getElementsByOneTag(E,W))}C=O}else C=this.getElementsByOneTag(E,C)}for(var A=[],ee=0;ee<C.length;ee++){var D=new u(C[ee]);A.push(D)}return A},b.prototype.getFileByName=function(p){for(var i in this.originFile)if(i.indexOf(p)>-1)return this.originFile[i];return""},b})(a);n.ReadXml=f;var u=(function(S){y(b,S);function b(p){var i=S.call(this)||this;i.elementString=p,i.setValue();var l=new RegExp('[a-zA-Z0-9_:]*?=".*?"',"g"),d=i.container.match(l);if(i.attributeList={},d!=null)for(var C in d){var c=d[C];if(c.length!=0){var E=c.substr(0,c.indexOf("=")),O=c.substr(c.indexOf("=")+1);E==null||O==null||E.length==0||O.length==0||(i.attributeList[E]=O.substr(1,O.length-2))}}return i}return b.prototype.get=function(p){return this.attributeList[p]},b.prototype.getInnerElements=function(p){for(var i=this.getElementsByOneTag(p,this.elementString),l=[],d=0;d<i.length;d++){var C=new b(i[d]);l.push(C)}return l.length==0?null:l},b.prototype.setValue=function(){var p=this.elementString;if(p.substr(p.length-2,2)=="/>")this.value="",this.container=p;else{var i=this.getFirstTag(),l=new RegExp("(<"+i+" [^>]+?[^/]>)([\\s\\S]*?)</"+i+">|(<"+i+">)([\\s\\S]*?)</"+i+">","g"),d=l.exec(p);d!=null&&(d[1]!=null?(this.container=d[1],this.value=d[2]):(this.container=d[3],this.value=d[4]))}},b.prototype.getFirstTag=function(){var p=this.elementString,i=p.substr(0,p.indexOf(" "));return(i==""||i.indexOf(">")>-1)&&(i=p.substr(0,p.indexOf(">"))),i=i.substr(1,i.length),i},b})(a);n.Element=u;function s(S,b){var p={};if(S==null||S.length==0)return b;for(var i in b){var l=b[i],d=parseInt(i),C=S[d];if(C==null)p[i]=l;else{var c=C.attributeList.rgb;p[i]=c}}return p}function w(S,b,p){var i=S.attributeList,l=b.clrScheme,d=b.indexedColors;b.mruColors;var C=s(d,r.indexedColors),c=i.indexed,E=i.rgb,O=i.theme,P=i.tint,W;if(c!=null){var A=parseInt(c);W=C[A],W!=null&&(W=W.substring(W.length-6,W.length),W="#"+W)}else if(E!=null)E=E.substring(E.length-6,E.length),W="#"+E;else if(O!=null){var ee=parseInt(O);ee==0?ee=1:ee==1?ee=0:ee==2?ee=3:ee==3&&(ee=2);var D=l[ee];if(D!=null){var B=D.getInnerElements("a:sysClr|a:srgbClr");if(B!=null){var U=B[0],x=U.attributeList;U.container.indexOf("sysClr")>-1?x.lastClr!=null?W="#"+x.lastClr:x.val!=null&&(W="#"+x.val):U.container.indexOf("srgbClr")>-1&&(W="#"+x.val)}}}if(P!=null){var z=parseFloat(P);W!=null&&(W=t.LightenDarkenColor(W,z))}return W}n.getColor=w;function _(S,b){var p=S.getInnerElements(b),i;if(p!=null&&p.length>0)if(b=="b"||b=="i"||b=="strike")i="1";else if(b=="u"){var l=p[0].attributeList.val;l=="double"?i="2":l=="singleAccounting"?i="3":l=="doubleAccounting"?i="4":i="1"}else if(b=="vertAlign"){var l=p[0].attributeList.val;l=="subscript"?i="1":l=="superscript"&&(i="2")}else i=p[0].attributeList.val;return i}n.getlineStringAttr=_},{"../common/constant":91,"../common/method":93}],91:[function(e,g,n){Object.defineProperty(n,"__esModule",{value:!0}),n.fontFamilys=n.borderTypes=n.OEM_CHARSET=n.indexedColors=n.numFmtDefault=n.BuiltInCellStyles=n.ST_CellType=n.workbookRels=n.theme1File=n.worksheetFilePath=n.sharedStringsFile=n.stylesFile=n.calcChainFile=n.workBookFile=n.contentTypesFile=n.appFile=n.coreFile=n.columeHeader_word_index=n.columeHeader_word=void 0,n.columeHeader_word=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],n.columeHeader_word_index={A:0,B:1,C:2,D:3,E:4,F:5,G:6,H:7,I:8,J:9,K:10,L:11,M:12,N:13,O:14,P:15,Q:16,R:17,S:18,T:19,U:20,V:21,W:22,X:23,Y:24,Z:25},n.coreFile="docProps/core.xml",n.appFile="docProps/app.xml",n.contentTypesFile="[Content_Types].xml",n.workBookFile="xl/workbook.xml",n.calcChainFile="xl/calcChain.xml",n.stylesFile="xl/styles.xml",n.sharedStringsFile="xl/sharedStrings.xml",n.worksheetFilePath="xl/worksheets/",n.theme1File="xl/theme/theme1.xml",n.workbookRels="xl/_rels/workbook.xml.rels",n.ST_CellType={Boolean:"b",Date:"d",Error:"e",InlineString:"inlineStr",Number:"n",SharedString:"s",String:"str"},n.BuiltInCellStyles={0:"Normal"},n.numFmtDefault={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@"},n.indexedColors={0:"00000000",1:"00FFFFFF",2:"00FF0000",3:"0000FF00",4:"000000FF",5:"00FFFF00",6:"00FF00FF",7:"0000FFFF",8:"00000000",9:"00FFFFFF",10:"00FF0000",11:"0000FF00",12:"000000FF",13:"00FFFF00",14:"00FF00FF",15:"0000FFFF",16:"00800000",17:"00008000",18:"00000080",19:"00808000",20:"00800080",21:"00008080",22:"00C0C0C0",23:"00808080",24:"009999FF",25:"00993366",26:"00FFFFCC",27:"00CCFFFF",28:"00660066",29:"00FF8080",30:"000066CC",31:"00CCCCFF",32:"00000080",33:"00FF00FF",34:"00FFFF00",35:"0000FFFF",36:"00800080",37:"00800000",38:"00008080",39:"000000FF",40:"0000CCFF",41:"00CCFFFF",42:"00CCFFCC",43:"00FFFF99",44:"0099CCFF",45:"00FF99CC",46:"00CC99FF",47:"00FFCC99",48:"003366FF",49:"0033CCCC",50:"0099CC00",51:"00FFCC00",52:"00FF9900",53:"00FF6600",54:"00666699",55:"00969696",56:"00003366",57:"00339966",58:"00003300",59:"00333300",60:"00993300",61:"00993366",62:"00333399",63:"00333333",64:null,65:null},n.OEM_CHARSET={0:"ANSI_CHARSET",1:"DEFAULT_CHARSET",2:"SYMBOL_CHARSET",77:"MAC_CHARSET",128:"SHIFTJIS_CHARSET",129:"HANGUL_CHARSET",130:"JOHAB_CHARSET",134:"GB2312_CHARSET",136:"CHINESEBIG5_CHARSET",161:"GREEK_CHARSET",162:"TURKISH_CHARSET",163:"VIETNAMESE_CHARSET",177:"HEBREW_CHARSET",178:"ARABIC_CHARSET",186:"BALTIC_CHARSET",204:"RUSSIAN_CHARSET",222:"THAI_CHARSET",238:"EASTEUROPE_CHARSET",255:"OEM_CHARSET"},n.borderTypes={none:0,thin:1,hair:2,dotted:3,dashed:4,dashDot:5,dashDotDot:6,double:7,medium:8,mediumDashed:9,mediumDashDot:10,mediumDashDotDot:11,slantDashDot:12,thick:13},n.fontFamilys={0:"defualt",1:"Roman",2:"Swiss",3:"Modern",4:"Script",5:"Decorative"}},{}],92:[function(e,g,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ToContext2D=n.FromEMF=n.UDOC=void 0,n.UDOC={},n.UDOC.G={concat:function(t,a){for(var f=0;f<a.cmds.length;f++)t.cmds.push(a.cmds[f]);for(var f=0;f<a.crds.length;f++)t.crds.push(a.crds[f])},getBB:function(t){for(var a=1e99,f=1e99,u=-a,s=-f,w=0;w<t.length;w+=2){var _=t[w],S=t[w+1];_<a?a=_:_>u&&(u=_),S<f?f=S:S>s&&(s=S)}return[a,f,u,s]},rectToPath:function(t){return{cmds:["M","L","L","L","Z"],crds:[t[0],t[1],t[2],t[1],t[2],t[3],t[0],t[3]]}},insideBox:function(t,a){return a[0]<=t[0]&&a[1]<=t[1]&&t[2]<=a[2]&&t[3]<=a[3]},isBox:function(t,a){var f=function(l,d){for(var C=0;C<8;C+=2){for(var c=!0,E=0;E<8;E++)if(Math.abs(d[E]-l[E+C&7])>=2){c=!1;break}if(c)return!0}return!1};if(t.cmds.length>10)return!1;var u=t.cmds.join(""),s=t.crds,w=!1;if(u=="MLLLZ"&&s.length==8||u=="MLLLLZ"&&s.length==10){s.length==10&&(s=s.slice(0,8));var _=a[0],S=a[1],b=a[2],p=a[3];w||(w=f(s,[_,S,b,S,b,p,_,p])),w||(w=f(s,[_,p,b,p,b,S,_,S]))}return w},boxArea:function(t){var a=t[2]-t[0],f=t[3]-t[1];return a*f},newPath:function(t){t.pth={cmds:[],crds:[]}},moveTo:function(t,a,f){var u=n.UDOC.M.multPoint(t.ctm,[a,f]);t.pth.cmds.push("M"),t.pth.crds.push(u[0],u[1]),t.cpos=u},lineTo:function(t,a,f){var u=n.UDOC.M.multPoint(t.ctm,[a,f]);t.cpos[0]==u[0]&&t.cpos[1]==u[1]||(t.pth.cmds.push("L"),t.pth.crds.push(u[0],u[1]),t.cpos=u)},curveTo:function(t,a,f,u,s,w,_){var S;S=n.UDOC.M.multPoint(t.ctm,[a,f]),a=S[0],f=S[1],S=n.UDOC.M.multPoint(t.ctm,[u,s]),u=S[0],s=S[1],S=n.UDOC.M.multPoint(t.ctm,[w,_]),w=S[0],_=S[1],t.cpos=S,t.pth.cmds.push("C"),t.pth.crds.push(a,f,u,s,w,_)},closePath:function(t){t.pth.cmds.push("Z")},arc:function(t,a,U,u,s,w,_){if(_)for(;w>s;)w-=2*Math.PI;else for(;w<s;)w+=2*Math.PI;var S=(w-s)/4,b=Math.cos(S/2),p=-Math.sin(S/2),i=(4-b)/3,l=p==0?p:(1-b)*(3-b)/(3*p),d=i,C=-l,c=b,E=-p,O=[i,l],P=[d,C],W=[c,E],A={cmds:[t.pth.cmds.length==0?"M":"L","C","C","C","C"],crds:[b,p,i,l,d,C,c,E]},ee=[1,0,0,1,0,0];n.UDOC.M.rotate(ee,-S);for(var D=0;D<3;D++)O=n.UDOC.M.multPoint(ee,O),P=n.UDOC.M.multPoint(ee,P),W=n.UDOC.M.multPoint(ee,W),A.crds.push(O[0],O[1],P[0],P[1],W[0],W[1]);var B=[u,0,0,u,a,U];n.UDOC.M.rotate(ee,-s+S/2),n.UDOC.M.concat(ee,B),n.UDOC.M.multArray(ee,A.crds),n.UDOC.M.multArray(t.ctm,A.crds),n.UDOC.G.concat(t.pth,A);var U=A.crds.pop();a=A.crds.pop(),t.cpos=[a,U]},toPoly:function(t){if(t.cmds[0]!="M"||t.cmds[t.cmds.length-1]!="Z")return null;for(var a=1;a<t.cmds.length-1;a++)if(t.cmds[a]!="L")return null;var f=[],u=t.crds.length;t.crds[0]==t.crds[u-2]&&t.crds[1]==t.crds[u-1]&&(u-=2);for(var a=0;a<u;a+=2)f.push([t.crds[a],t.crds[a+1]]);return n.UDOC.G.polyArea(t.crds)<0&&f.reverse(),f},fromPoly:function(t){for(var a={cmds:[],crds:[]},f=0;f<t.length;f++)a.crds.push(t[f][0],t[f][1]),a.cmds.push(f==0?"M":"L");return a.cmds.push("Z"),a},polyArea:function(t){if(t.length<6)return 0;for(var a=t.length-2,f=(t[0]-t[a])*(t[a+1]+t[1]),u=0;u<a;u+=2)f+=(t[u+2]-t[u])*(t[u+1]+t[u+3]);return-f*.5},polyClip:function(t,a){var f,u,s,w,_=function(C){return(u[0]-f[0])*(C[1]-f[1])>(u[1]-f[1])*(C[0]-f[0])},S=function(){var C=[f[0]-u[0],f[1]-u[1]],c=[s[0]-w[0],s[1]-w[1]],E=f[0]*u[1]-f[1]*u[0],O=s[0]*w[1]-s[1]*w[0],P=1/(C[0]*c[1]-C[1]*c[0]);return[(E*c[0]-O*C[0])*P,(E*c[1]-O*C[1])*P]},b=t;f=a[a.length-1];for(var p in a){var u=a[p],i=b;b=[],s=i[i.length-1];for(var l in i){var w=i[l];_(w)?(_(s)||b.push(S()),b.push(w)):_(s)&&b.push(S()),s=w}f=u}return b}},n.UDOC.M={getScale:function(t){return Math.sqrt(Math.abs(t[0]*t[3]-t[1]*t[2]))},translate:function(t,a,f){n.UDOC.M.concat(t,[1,0,0,1,a,f])},rotate:function(t,a){n.UDOC.M.concat(t,[Math.cos(a),-Math.sin(a),Math.sin(a),Math.cos(a),0,0])},scale:function(t,a,f){n.UDOC.M.concat(t,[a,0,0,f,0,0])},concat:function(t,a){var f=t[0],u=t[1],s=t[2],w=t[3],_=t[4],S=t[5];t[0]=f*a[0]+u*a[2],t[1]=f*a[1]+u*a[3],t[2]=s*a[0]+w*a[2],t[3]=s*a[1]+w*a[3],t[4]=_*a[0]+S*a[2]+a[4],t[5]=_*a[1]+S*a[3]+a[5]},invert:function(t){var a=t[0],f=t[1],u=t[2],s=t[3],w=t[4],_=t[5],S=a*s-f*u;t[0]=s/S,t[1]=-f/S,t[2]=-u/S,t[3]=a/S,t[4]=(u*_-s*w)/S,t[5]=(f*w-a*_)/S},multPoint:function(t,a){var f=a[0],u=a[1];return[f*t[0]+u*t[2]+t[4],f*t[1]+u*t[3]+t[5]]},multArray:function(t,a){for(var f=0;f<a.length;f+=2){var u=a[f],s=a[f+1];a[f]=u*t[0]+s*t[2]+t[4],a[f+1]=u*t[1]+s*t[3]+t[5]}}},n.UDOC.C={srgbGamma:function(t){return t<.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055},cmykToRgb:function(t){var a=t[0],f=t[1],u=t[2],s=t[3],w=255+a*(-4.387332384609988*a+54.48615194189176*f+18.82290502165302*u+212.25662451639585*s+-285.2331026137004)+f*(1.7149763477362134*f-5.6096736904047315*u+-17.873870861415444*s-5.497006427196366)+u*(-2.5217340131683033*u-21.248923337353073*s+17.5119270841813)+s*(-21.86122147463605*s-189.48180835922747),_=255+a*(8.841041422036149*a+60.118027045597366*f+6.871425592049007*u+31.159100130055922*s+-79.2970844816548)+f*(-15.310361306967817*f+17.575251261109482*u+131.35250912493976*s-190.9453302588951)+u*(4.444339102852739*u+9.8632861493405*s-24.86741582555878)+s*(-20.737325471181034*s-187.80453709719578),S=255+a*(.8842522430003296*a+8.078677503112928*f+30.89978309703729*u-.23883238689178934*s+-14.183576799673286)+f*(10.49593273432072*f+63.02378494754052*u+50.606957656360734*s-112.23884253719248)+u*(.03296041114873217*u+115.60384449646641*s+-193.58209356861505)+s*(-22.33816807309886*s-180.12613974708367);return[Math.max(0,Math.min(1,w/255)),Math.max(0,Math.min(1,_/255)),Math.max(0,Math.min(1,S/255))]},labToRgb:function(t){for(var a=903.3,f=.008856,u=t[0],s=t[1],w=t[2],_=(u+16)/116,S=_*_*_,b=_-w/200,p=b*b*b,i=s/500+_,l=i*i*i,d=p>f?p:(116*b-16)/a,C=S>f?S:(116*_-16)/a,c=l>f?l:(116*i-16)/a,E=c*96.72,O=C*100,P=d*81.427,W=[E/100,O/100,P/100],A=[3.1338561,-1.6168667,-.4906146,-.9787684,1.9161415,.033454,.0719453,-.2289914,1.4052427],ee=[A[0]*W[0]+A[1]*W[1]+A[2]*W[2],A[3]*W[0]+A[4]*W[1]+A[5]*W[2],A[6]*W[0]+A[7]*W[1]+A[8]*W[2]],D=0;D<3;D++)ee[D]=Math.max(0,Math.min(1,n.UDOC.C.srgbGamma(ee[D])));return ee}},n.UDOC.getState=function(r){return{font:n.UDOC.getFont(),dd:{flat:1},space:"/DeviceGray",ca:1,colr:[0,0,0],sspace:"/DeviceGray",CA:1,COLR:[0,0,0],bmode:"/Normal",SA:!1,OPM:0,AIS:!1,OP:!1,op:!1,SMask:"/None",lwidth:1,lcap:0,ljoin:0,mlimit:10,SM:.1,doff:0,dash:[],ctm:[1,0,0,1,0,0],cpos:[0,0],pth:{cmds:[],crds:[]},cpth:r?n.UDOC.G.rectToPath(r):null}},n.UDOC.getFont=function(){return{Tc:0,Tw:0,Th:100,Tl:0,Tf:"Helvetica-Bold",Tfs:1,Tmode:0,Trise:0,Tk:0,Tal:0,Tun:0,Tm:[1,0,0,1,0,0],Tlm:[1,0,0,1,0,0],Trm:[1,0,0,1,0,0]}},n.FromEMF=function(){},n.FromEMF.Parse=function(r,t){r=new Uint8Array(r);for(var a=0,f={fill:!1,strk:!1,bb:[0,0,1,1],wbb:[0,0,1,1],fnt:{nam:"Arial",hgh:25,und:!1,orn:0},tclr:[0,0,0],talg:0},u,s=[],w=[],_=n.FromEMF.B.readShort,S=n.FromEMF.B.readUshort,b=n.FromEMF.B.readInt,p=n.FromEMF.B.readUint,i=n.FromEMF.B.readFloat;;){var l=p(r,a);a+=4;var d=n.FromEMF.K[l],C=p(r,a);a+=4;var c=a,E=null,O=0;if(d=="EOF")break;if(d=="HEADER")f.bb=n.FromEMF._readBox(r,c),c+=16,t.StartPage(f.bb[0],f.bb[1],f.bb[2],f.bb[3]),u=n.UDOC.getState(f.bb);else if(d=="SAVEDC")w.push(JSON.stringify(u),JSON.stringify(f));else if(d=="RESTOREDC"){var P=b(r,c);for(c+=4;P<-1;)w.pop(),w.pop();f=JSON.parse(w.pop()),u=JSON.parse(w.pop())}else if(d=="SELECTCLIPPATH")u.cpth=JSON.parse(JSON.stringify(u.pth));else if(["SETMAPMODE","SETPOLYFILLMODE","SETBKMODE","SETICMMODE","SETROP2","EXTSELECTCLIPRGN"].indexOf(d)==-1){if(d=="SETMITERLIMIT")u.mlimit=p(r,c);else if(d=="SETTEXTCOLOR")f.tclr=[r[c]/255,r[c+1]/255,r[c+2]/255];else if(d=="SETTEXTALIGN")f.talg=p(r,c);else if(d=="SETVIEWPORTEXTEX"||d=="SETVIEWPORTORGEX"){f.vbb==null&&(f.vbb=[]);var W=d=="SETVIEWPORTORGEX"?0:2;f.vbb[W]=b(r,c),c+=4,f.vbb[W+1]=b(r,c),c+=4,d=="SETVIEWPORTEXTEX"&&n.FromEMF._updateCtm(f,u)}else if(d=="SETWINDOWEXTEX"||d=="SETWINDOWORGEX"){var W=d=="SETWINDOWORGEX"?0:2;f.wbb[W]=b(r,c),c+=4,f.wbb[W+1]=b(r,c),c+=4,d=="SETWINDOWEXTEX"&&n.FromEMF._updateCtm(f,u)}else if(d=="COMMENT")p(r,c),c+=4;else if(d=="SELECTOBJECT"){var A=p(r,c);if(c+=4,A==2147483648)f.fill=!0,u.colr=[1,1,1];else if(A==2147483653)f.fill=!1;else if(A==2147483655)f.strk=!0,f.lwidth=1,u.COLR=[0,0,0];else if(A==2147483656)f.strk=!1;else if(A!=2147483661){if(A!=2147483662){var ee=s[A];if(ee.t=="b"){if(f.fill=ee.stl!=1,ee.stl!=0){if(ee.stl!=1)throw ee.stl+" e"}u.colr=ee.clr}else if(ee.t=="p")f.strk=ee.stl!=5,u.lwidth=ee.wid,u.COLR=ee.clr;else if(ee.t=="f")f.fnt=ee,u.font.Tf=ee.nam,u.font.Tfs=Math.abs(ee.hgh),u.font.Tun=ee.und;else throw"e"}}}else if(d=="DELETEOBJECT"){var A=p(r,c);if(c+=4,s[A]!=null)s[A]=null;else throw"e"}else if(d=="CREATEBRUSHINDIRECT")O=p(r,c),c+=4,E={t:"b"},E.stl=p(r,c),c+=4,E.clr=[r[c]/255,r[c+1]/255,r[c+2]/255],c+=4,E.htc=p(r,c),c+=4;else if(d=="CREATEPEN"||d=="EXTCREATEPEN")O=p(r,c),c+=4,E={t:"p"},d=="EXTCREATEPEN"?(c+=16,E.stl=p(r,c),c+=4,E.wid=p(r,c),c+=4,c+=4):(E.stl=p(r,c),c+=4,E.wid=p(r,c),c+=4,c+=4),E.clr=[r[c]/255,r[c+1]/255,r[c+2]/255],c+=4;else if(d=="EXTCREATEFONTINDIRECTW"){O=p(r,c),c+=4,E={t:"f",nam:""},E.hgh=b(r,c),c+=4,c+=8,E.orn=b(r,c)/10,c+=4;var D=p(r,c);for(c+=4,E.und=r[c+1],E.stk=r[c+2],c+=8;S(r,c)!=0;)E.nam+=String.fromCharCode(S(r,c)),c+=2;D>500&&(E.nam+="-Bold")}else if(d=="EXTTEXTOUTW"){c+=16;var B=p(r,c);c+=4,i(r,c),c+=4,i(r,c),c+=4;var U=b(r,c);c+=4;var x=b(r,c);c+=4,u.font.Tm=[1,0,0,-1,0,0],n.UDOC.M.rotate(u.font.Tm,f.fnt.orn*Math.PI/180),n.UDOC.M.translate(u.font.Tm,U,x);var z=f.talg;if((z&6)==6)u.font.Tal=2;else if((z&7)==0)u.font.Tal=0;else throw z+" e";if((z&24)!=24)if((z&24)==0)n.UDOC.M.translate(u.font.Tm,0,u.font.Tfs);else throw"e";var K=p(r,c);c+=4;var Y=p(r,c);c+=4,p(r,c),c+=4,c+=16,p(r,c),c+=4,Y+=a-8;for(var $="",V=0;V<K;V++){var ce=S(r,Y+V*2);$+=String.fromCharCode(ce)}var ie=u.colr;u.colr=f.tclr,t.PutText(u,$,$.length*u.font.Tfs*.5),u.colr=ie}else if(d=="BEGINPATH")n.UDOC.G.newPath(u);else if(d!="ENDPATH")if(d=="CLOSEFIGURE")n.UDOC.G.closePath(u);else if(d=="MOVETOEX")n.UDOC.G.moveTo(u,b(r,c),b(r,c+4));else if(d=="LINETO"){if(u.pth.cmds.length==0){var de=u.ctm.slice(0);n.UDOC.M.invert(de);var ve=n.UDOC.M.multPoint(de,u.cpos);n.UDOC.G.moveTo(u,ve[0],ve[1])}n.UDOC.G.lineTo(u,b(r,c),b(r,c+4))}else if(d=="POLYGON"||d=="POLYGON16"||d=="POLYLINE"||d=="POLYLINE16"||d=="POLYLINETO"||d=="POLYLINETO16"){c+=16;var Z=d.startsWith("POLYGON"),j=d.indexOf("TO")!=-1,re=p(r,c);c+=4,j||n.UDOC.G.newPath(u),c=n.FromEMF._drawPoly(r,c,re,u,d.endsWith("16")?2:4,Z,j),j||n.FromEMF._draw(t,u,f,Z)}else if(d=="POLYPOLYGON16"){c+=16;var Z=d.startsWith("POLYPOLYGON"),j=d.indexOf("TO")!=-1,ue=p(r,c);c+=4,c+=4;var ge=c;c+=ue*4,j||n.UDOC.G.newPath(u);for(var V=0;V<ue;V++){var me=S(r,ge+V*4);c=n.FromEMF._drawPoly(r,c,me,u,d.endsWith("16")?2:4,Z,j)}j||n.FromEMF._draw(t,u,f,Z)}else if(d=="POLYBEZIER"||d=="POLYBEZIER16"||d=="POLYBEZIERTO"||d=="POLYBEZIERTO16"){c+=16;var Re=d.endsWith("16"),Oe=Re?_:b,ke=Re?2:4,re=p(r,c);for(c+=4,d.indexOf("TO")==-1&&(n.UDOC.G.moveTo(u,Oe(r,c),Oe(r,c+ke)),c+=2*ke,re--);re>0;)n.UDOC.G.curveTo(u,Oe(r,c),Oe(r,c+ke),Oe(r,c+2*ke),Oe(r,c+3*ke),Oe(r,c+4*ke),Oe(r,c+5*ke)),c+=6*ke,re-=3}else if(d=="RECTANGLE"||d=="ELLIPSE"){n.UDOC.G.newPath(u);var M=n.FromEMF._readBox(r,c);if(d=="RECTANGLE")n.UDOC.G.moveTo(u,M[0],M[1]),n.UDOC.G.lineTo(u,M[2],M[1]),n.UDOC.G.lineTo(u,M[2],M[3]),n.UDOC.G.lineTo(u,M[0],M[3]);else{var N=(M[0]+M[2])/2,te=(M[1]+M[3])/2;n.UDOC.G.arc(u,N,te,(M[2]-M[0])/2,0,2*Math.PI,!1)}n.UDOC.G.closePath(u),n.FromEMF._draw(t,u,f,!0)}else if(d=="FILLPATH")t.Fill(u,!1);else if(d=="STROKEPATH")t.Stroke(u);else if(d=="STROKEANDFILLPATH")t.Fill(u,!1),t.Stroke(u);else if(d=="SETWORLDTRANSFORM"||d=="MODIFYWORLDTRANSFORM"){for(var ae=[],V=0;V<6;V++)ae.push(i(r,c+V*4));if(c+=24,d=="SETWORLDTRANSFORM")u.ctm=ae;else{var B=p(r,c);if(c+=4,B==2){var Se=u.ctm;u.ctm=ae,n.UDOC.M.concat(u.ctm,Se)}else throw"e"}}else if(d=="SETSTRETCHBLTMODE")p(r,c),c+=4;else if(d=="STRETCHDIBITS"){var M=n.FromEMF._readBox(r,c);c+=16;var we=b(r,c);c+=4;var R=b(r,c);c+=4,b(r,c),c+=4,b(r,c),c+=4;var v=b(r,c);c+=4;var m=b(r,c);c+=4;var L=p(r,c)+a-8;c+=4,p(r,c),c+=4;var X=p(r,c)+a-8;c+=4,p(r,c),c+=4;var se=p(r,c);if(c+=4,se!=0)throw"e";p(r,c),c+=4;var oe=b(r,c);c+=4;var Te=b(r,c);c+=4,p(r,L),L+=4;var Ce=p(r,L);L+=4;var Ee=p(r,L);if(L+=4,Ce!=v||Ee!=m)throw"e";var Fe=S(r,L);L+=2;var Ae=S(r,L);if(L+=2,Ae!=8&&Ae!=24&&Ae!=32)throw Ae+" e";var xe=p(r,L);if(L+=4,xe!=0)throw xe+" e";p(r,L),L+=4,p(r,L),L+=4,p(r,L),L+=4,p(r,L),L+=4,p(r,L),L+=4;var Ie=Math.floor((Ce*Fe*Ae+31&-32)/8),Ne=new Uint8Array(Ce*Ee*4);if(Ae==8)for(var te=0;te<Ee;te++)for(var N=0;N<Ce;N++){var ze=te*Ce+N<<2,A=r[X+(Ee-1-te)*Ie+N]<<2;Ne[ze]=r[L+A+2],Ne[ze+1]=r[L+A+1],Ne[ze+2]=r[L+A+0],Ne[ze+3]=255}if(Ae==24)for(var te=0;te<Ee;te++)for(var N=0;N<Ce;N++){var ze=te*Ce+N<<2,I=X+(Ee-1-te)*Ie+N*3;Ne[ze]=r[I+2],Ne[ze+1]=r[I+1],Ne[ze+2]=r[I+0],Ne[ze+3]=255}if(Ae==32)for(var te=0;te<Ee;te++)for(var N=0;N<Ce;N++){var ze=te*Ce+N<<2,I=X+(Ee-1-te)*Ie+N*4;Ne[ze]=r[I+2],Ne[ze+1]=r[I+1],Ne[ze+2]=r[I+0],Ne[ze+3]=r[I+3]}var le=u.ctm.slice(0);u.ctm=[1,0,0,1,0,0],n.UDOC.M.scale(u.ctm,oe,-Te),n.UDOC.M.translate(u.ctm,we,R+Te),n.UDOC.M.concat(u.ctm,le),t.PutImage(u,Ne,Ce,Ee),u.ctm=le}else console.log(d,C)}E!=null&&(s[O]=E),a+=C-8}t.ShowPage(),t.Done()},n.FromEMF._readBox=function(r,t){for(var a=[],f=0;f<4;f++)a[f]=n.FromEMF.B.readInt(r,t+f*4);return a},n.FromEMF._updateCtm=function(r,t){var a=[1,0,0,1,0,0],f=r.wbb;r.bb;var u=r.vbb&&r.vbb.length==4?r.vbb:r.bb;n.UDOC.M.translate(a,-f[0],-f[1]),n.UDOC.M.scale(a,1/f[2],1/f[3]),n.UDOC.M.scale(a,u[2],u[3]),t.ctm=a},n.FromEMF._draw=function(r,t,a,f){a.fill&&f&&r.Fill(t,!1),a.strk&&t.lwidth!=0&&r.Stroke(t)},n.FromEMF._drawPoly=function(r,t,a,f,u,s,w){for(var _=u==2?n.FromEMF.B.readShort:n.FromEMF.B.readInt,S=0;S<a;S++){var b=_(r,t);t+=u;var p=_(r,t);t+=u,S==0&&!w?n.UDOC.G.moveTo(f,b,p):n.UDOC.G.lineTo(f,b,p)}return s&&n.UDOC.G.closePath(f),t},n.FromEMF.B={uint8:new Uint8Array(4),readShort:function(t,a){var f=n.FromEMF.B.uint8;return f[0]=t[a],f[1]=t[a+1],n.FromEMF.B.int16[0]},readUshort:function(t,a){var f=n.FromEMF.B.uint8;return f[0]=t[a],f[1]=t[a+1],n.FromEMF.B.uint16[0]},readInt:function(t,a){var f=n.FromEMF.B.uint8;return f[0]=t[a],f[1]=t[a+1],f[2]=t[a+2],f[3]=t[a+3],n.FromEMF.B.int32[0]},readUint:function(t,a){var f=n.FromEMF.B.uint8;return f[0]=t[a],f[1]=t[a+1],f[2]=t[a+2],f[3]=t[a+3],n.FromEMF.B.uint32[0]},readFloat:function(t,a){var f=n.FromEMF.B.uint8;return f[0]=t[a],f[1]=t[a+1],f[2]=t[a+2],f[3]=t[a+3],n.FromEMF.B.flot32[0]},readASCII:function(t,a,f){for(var u="",s=0;s<f;s++)u+=String.fromCharCode(t[a+s]);return u}},n.FromEMF.B.int16=new Int16Array(n.FromEMF.B.uint8.buffer),n.FromEMF.B.uint16=new Uint16Array(n.FromEMF.B.uint8.buffer),n.FromEMF.B.int32=new Int32Array(n.FromEMF.B.uint8.buffer),n.FromEMF.B.uint32=new Uint32Array(n.FromEMF.B.uint8.buffer),n.FromEMF.B.flot32=new Float32Array(n.FromEMF.B.uint8.buffer),n.FromEMF.C={EMR_HEADER:1,EMR_POLYBEZIER:2,EMR_POLYGON:3,EMR_POLYLINE:4,EMR_POLYBEZIERTO:5,EMR_POLYLINETO:6,EMR_POLYPOLYLINE:7,EMR_POLYPOLYGON:8,EMR_SETWINDOWEXTEX:9,EMR_SETWINDOWORGEX:10,EMR_SETVIEWPORTEXTEX:11,EMR_SETVIEWPORTORGEX:12,EMR_SETBRUSHORGEX:13,EMR_EOF:14,EMR_SETPIXELV:15,EMR_SETMAPPERFLAGS:16,EMR_SETMAPMODE:17,EMR_SETBKMODE:18,EMR_SETPOLYFILLMODE:19,EMR_SETROP2:20,EMR_SETSTRETCHBLTMODE:21,EMR_SETTEXTALIGN:22,EMR_SETCOLORADJUSTMENT:23,EMR_SETTEXTCOLOR:24,EMR_SETBKCOLOR:25,EMR_OFFSETCLIPRGN:26,EMR_MOVETOEX:27,EMR_SETMETARGN:28,EMR_EXCLUDECLIPRECT:29,EMR_INTERSECTCLIPRECT:30,EMR_SCALEVIEWPORTEXTEX:31,EMR_SCALEWINDOWEXTEX:32,EMR_SAVEDC:33,EMR_RESTOREDC:34,EMR_SETWORLDTRANSFORM:35,EMR_MODIFYWORLDTRANSFORM:36,EMR_SELECTOBJECT:37,EMR_CREATEPEN:38,EMR_CREATEBRUSHINDIRECT:39,EMR_DELETEOBJECT:40,EMR_ANGLEARC:41,EMR_ELLIPSE:42,EMR_RECTANGLE:43,EMR_ROUNDRECT:44,EMR_ARC:45,EMR_CHORD:46,EMR_PIE:47,EMR_SELECTPALETTE:48,EMR_CREATEPALETTE:49,EMR_SETPALETTEENTRIES:50,EMR_RESIZEPALETTE:51,EMR_REALIZEPALETTE:52,EMR_EXTFLOODFILL:53,EMR_LINETO:54,EMR_ARCTO:55,EMR_POLYDRAW:56,EMR_SETARCDIRECTION:57,EMR_SETMITERLIMIT:58,EMR_BEGINPATH:59,EMR_ENDPATH:60,EMR_CLOSEFIGURE:61,EMR_FILLPATH:62,EMR_STROKEANDFILLPATH:63,EMR_STROKEPATH:64,EMR_FLATTENPATH:65,EMR_WIDENPATH:66,EMR_SELECTCLIPPATH:67,EMR_ABORTPATH:68,EMR_COMMENT:70,EMR_FILLRGN:71,EMR_FRAMERGN:72,EMR_INVERTRGN:73,EMR_PAINTRGN:74,EMR_EXTSELECTCLIPRGN:75,EMR_BITBLT:76,EMR_STRETCHBLT:77,EMR_MASKBLT:78,EMR_PLGBLT:79,EMR_SETDIBITSTODEVICE:80,EMR_STRETCHDIBITS:81,EMR_EXTCREATEFONTINDIRECTW:82,EMR_EXTTEXTOUTA:83,EMR_EXTTEXTOUTW:84,EMR_POLYBEZIER16:85,EMR_POLYGON16:86,EMR_POLYLINE16:87,EMR_POLYBEZIERTO16:88,EMR_POLYLINETO16:89,EMR_POLYPOLYLINE16:90,EMR_POLYPOLYGON16:91,EMR_POLYDRAW16:92,EMR_CREATEMONOBRUSH:93,EMR_CREATEDIBPATTERNBRUSHPT:94,EMR_EXTCREATEPEN:95,EMR_POLYTEXTOUTA:96,EMR_POLYTEXTOUTW:97,EMR_SETICMMODE:98,EMR_CREATECOLORSPACE:99,EMR_SETCOLORSPACE:100,EMR_DELETECOLORSPACE:101,EMR_GLSRECORD:102,EMR_GLSBOUNDEDRECORD:103,EMR_PIXELFORMAT:104,EMR_DRAWESCAPE:105,EMR_EXTESCAPE:106,EMR_SMALLTEXTOUT:108,EMR_FORCEUFIMAPPING:109,EMR_NAMEDESCAPE:110,EMR_COLORCORRECTPALETTE:111,EMR_SETICMPROFILEA:112,EMR_SETICMPROFILEW:113,EMR_ALPHABLEND:114,EMR_SETLAYOUT:115,EMR_TRANSPARENTBLT:116,EMR_GRADIENTFILL:118,EMR_SETLINKEDUFIS:119,EMR_SETTEXTJUSTIFICATION:120,EMR_COLORMATCHTOTARGETW:121,EMR_CREATECOLORSPACEW:122},n.FromEMF.K=[],n.ToContext2D=function(r,t){this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.bb=null,this.currPage=0,this.needPage=r,this.scale=t},n.ToContext2D.prototype.StartPage=function(r,t,a,f){if(this.currPage==this.needPage){this.bb=[r,t,a,f];var u=this.scale,s=window.devicePixelRatio,w=this.canvas,_=this.ctx;w.width=Math.round(a*u),w.height=Math.round(f*u),_.translate(0,f*u),_.scale(u,-u),w.setAttribute("style","border:1px solid; width:"+w.width/s+"px; height:"+w.height/s+"px")}},n.ToContext2D.prototype.Fill=function(r,t){if(this.currPage==this.needPage){var a=this.ctx;a.beginPath(),this._setStyle(r,a),this._draw(r.pth,a),a.fill()}},n.ToContext2D.prototype.Stroke=function(r){if(this.currPage==this.needPage){var t=this.ctx;t.beginPath(),this._setStyle(r,t),this._draw(r.pth,t),t.stroke()}},n.ToContext2D.prototype.PutText=function(r,t,a){if(this.currPage==this.needPage){this._scale(r.ctm);var f=this.ctx;this._setStyle(r,f),f.save();var u=[1,0,0,-1,0,0];this._concat(u,r.font.Tm),this._concat(u,r.ctm),f.transform(u[0],u[1],u[2],u[3],u[4],u[5]),f.fillText(t,0,0),f.restore()}},n.ToContext2D.prototype.PutImage=function(r,t,a,f,u){if(this.currPage==this.needPage){var s=this.ctx;if(t.length==a*f*4){if(t=t.slice(0),u&&u.length==a*f*4)for(var w=0;w<t.length;w+=4)t[w+3]=u[w+1];var _=document.createElement("canvas"),S=_.getContext("2d");_.width=a,_.height=f;for(var b=S.createImageData(a,f),w=0;w<t.length;w++)b.data[w]=t[w];S.putImageData(b,0,0),s.save();var p=[1,0,0,1,0,0];this._concat(p,[1/a,0,0,-1/f,0,1]),this._concat(p,r.ctm),s.transform(p[0],p[1],p[2],p[3],p[4],p[5]),s.drawImage(_,0,0),s.restore()}}},n.ToContext2D.prototype.ShowPage=function(){this.currPage++},n.ToContext2D.prototype.Done=function(){};function y(r){return""+parseFloat(r.toFixed(2))}n.ToContext2D.prototype._setStyle=function(r,t){var a=this._scale(r.ctm);t.fillStyle=this._getFill(r.colr,r.ca,t),t.strokeStyle=this._getFill(r.COLR,r.CA,t),t.lineCap=["butt","round","square"][r.lcap],t.lineJoin=["miter","round","bevel"][r.ljoin],t.lineWidth=r.lwidth*a;for(var f=r.dash.slice(0),u=0;u<f.length;u++)f[u]=y(f[u]*a);t.setLineDash(f),t.miterLimit=r.mlimit*a;var s=r.font.Tf,w=s.toLowerCase(),_=w.indexOf("bold")!=-1?"bold ":"",S=w.indexOf("italic")!=-1||w.indexOf("oblique")!=-1?"italic ":"";t.font=_+S+r.font.Tfs+'px "'+s+'"'},n.ToContext2D.prototype._getFill=function(r,t,a){if(r.typ==null)return this._colr(r,t);var f=r,u=f.crds,s=f.mat,w=this._scale(s),_;if(f.typ=="lin"){var S=this._multPoint(s,u.slice(0,2)),b=this._multPoint(s,u.slice(2));_=a.createLinearGradient(S[0],S[1],b[0],b[1])}else if(f.typ=="rad"){var S=this._multPoint(s,u.slice(0,2)),b=this._multPoint(s,u.slice(3));_=a.createRadialGradient(S[0],S[1],u[2]*w,b[0],b[1],u[5]*w)}for(var p=0;p<f.grad.length;p++)_.addColorStop(f.grad[p][0],this._colr(f.grad[p][1],t));return _},n.ToContext2D.prototype._colr=function(r,t){return"rgba("+Math.round(r[0]*255)+","+Math.round(r[1]*255)+","+Math.round(r[2]*255)+","+t+")"},n.ToContext2D.prototype._scale=function(r){return Math.sqrt(Math.abs(r[0]*r[3]-r[1]*r[2]))},n.ToContext2D.prototype._concat=function(r,t){var a=r[0],f=r[1],u=r[2],s=r[3],w=r[4],_=r[5];r[0]=a*t[0]+f*t[2],r[1]=a*t[1]+f*t[3],r[2]=u*t[0]+s*t[2],r[3]=u*t[1]+s*t[3],r[4]=w*t[0]+_*t[2]+t[4],r[5]=w*t[1]+_*t[3]+t[5]},n.ToContext2D.prototype._multPoint=function(r,t){var a=t[0],f=t[1];return[a*r[0]+f*r[2]+r[4],a*r[1]+f*r[3]+r[5]]},n.ToContext2D.prototype._draw=function(r,t){for(var a=0,f=r.crds,u=0;u<r.cmds.length;u++){var s=r.cmds[u];s=="M"?(t.moveTo(f[a],f[a+1]),a+=2):s=="L"?(t.lineTo(f[a],f[a+1]),a+=2):s=="C"?(t.bezierCurveTo(f[a],f[a+1],f[a+2],f[a+3],f[a+4],f[a+5]),a+=6):s=="Q"?(t.quadraticCurveTo(f[a],f[a+1],f[a+2],f[a+3]),a+=4):s=="Z"&&t.closePath()}}},{}],93:[function(e,g,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getBinaryContent=n.isContainMultiType=n.isKoera=n.isJapanese=n.isChinese=n.fromulaRef=n.escapeCharacter=n.generateRandomIndex=n.LightenDarkenColor=n.getRowHeightPixel=n.getColumnWidthPixel=n.getXmlAttibute=n.getPxByEMUs=n.getptToPxRatioByDPI=n.getcellrange=n.getRangetxt=void 0;var y=e("./constant");function r(D,B){var U=D.row[0],x=D.row[1],z=D.column[0],K=D.column[1];return U==null&&x==null?B+f(z)+":"+f(K):z==null&&K==null?B+(U+1)+":"+(x+1):z==K&&U==x?B+f(z)+(U+1):B+f(z)+(U+1)+":"+f(K)+(x+1)}n.getRangetxt=r;function t(D,B,U){B===void 0&&(B={}),U===void 0&&(U="1");var x=D.split("!"),z="",K="",Y=-1;if(x.length>1){z=x[0],K=x[1];var $=B[z];$==null?Y=parseInt(U):Y=parseInt($)}else Y=parseInt(U),K=x[0];if(K.indexOf(":")==-1){var V=parseInt(K.replace(/[^0-9]/g,""))-1,ce=a(K.replace(/[^A-Za-z]/g,""));return!isNaN(V)&&!isNaN(ce)?{row:[V,V],column:[ce,ce],sheetIndex:Y}:null}else{var ie=K.split(":"),V=[],ce=[];return V[0]=parseInt(ie[0].replace(/[^0-9]/g,""))-1,V[1]=parseInt(ie[1].replace(/[^0-9]/g,""))-1,V[0]>V[1]||(ce[0]=a(ie[0].replace(/[^A-Za-z]/g,"")),ce[1]=a(ie[1].replace(/[^A-Za-z]/g,"")),ce[0]>ce[1])?null:{row:V,column:ce,sheetIndex:Y}}}n.getcellrange=t;function a(D){D=D.toUpperCase();var B=D.length;if(B==0)return NaN;for(var U=D.split(""),x=y.columeHeader_word.length,z=0,K=B-1;K>=0;K--)K==B-1?z+=y.columeHeader_word_index[U[K]]:z+=Math.pow(x,B-K-1)*(y.columeHeader_word_index[U[K]]+1);return z}function f(D){var B=y.columeHeader_word.length;if(D<B)return y.columeHeader_word[D];for(var U=0,x="",z=1,K=0;D>=B/(B-1)*(Math.pow(B,z++)-1);)K=z;var Y=D-B/(B-1)*(Math.pow(B,K-1)-1);U=Y+1;for(var $=K;$>0;$--){var V=U;if($==1)return V=V%B,V==0&&(V=26),x+y.columeHeader_word[V-1];V=Math.ceil(V/Math.pow(B,$-1)),x+=y.columeHeader_word[V-1],$>1&&(U=U-(V-1)*B)}}function u(){return 72/96}n.getptToPxRatioByDPI=u;function s(D){if(D==null)return 0;var B=D/914400,U=B*72,x=U/u();return x}n.getPxByEMUs=s;function w(D,B,U){var x=D[B];return x=x??U,x}n.getXmlAttibute=w;function _(D){var B=Math.round((D-.83)*8+5);return B}n.getColumnWidthPixel=_;function S(D){var B=Math.round(D/u());return B}n.getRowHeightPixel=S;function b(D,B){var U=D.substring(D.length-6,D.length),x=i("#"+U),z=d(x[0],x[1],x[2]);if(B>0)z[2]=z[2]*(1-B)+B;else if(B<0)z[2]=z[2]*(1+B);else return"#"+U;var K=l(z[0],z[1],z[2]);return p("RGB("+K.join(",")+")")}n.LightenDarkenColor=b;function p(D){var B=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/;if(/^(rgb|RGB)/.test(D)){for(var U=D.replace(/(?:\(|\)|rgb|RGB)*/g,"").split(","),x="#",z=0;z<U.length;z++){var K=Number(U[z]).toString(16);K.length<2&&(K="0"+K),x+=K}return x.length!==7&&(x=D),x}else if(B.test(D)){var Y=D.replace(/#/,"").split("");if(Y.length===6)return D;if(Y.length===3){for(var $="#",z=0;z<Y.length;z+=1)$+=Y[z]+Y[z];return $}}return D}function i(D){var B=D.toLowerCase(),U=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/;if(B&&U.test(B)){if(B.length===4){for(var x="#",z=1;z<4;z+=1)x+=B.slice(z,z+1).concat(B.slice(z,z+1));B=x}for(var K=[],z=1;z<7;z+=2)K.push(parseInt("0x"+B.slice(z,z+2)));return K}return null}function l(D,B,U){var x,z,K;if(B==0)x=z=K=U;else{var Y=function(ie,de,ve){return ve<0&&(ve+=1),ve>1&&(ve-=1),ve<.16666666666666666?ie+(de-ie)*6*ve:ve<.5?de:ve<.6666666666666666?ie+(de-ie)*(.6666666666666666-ve)*6:ie},$=U<.5?U*(1+B):U+B-U*B,V=2*U-$;x=Y(V,$,D+1/3),z=Y(V,$,D),K=Y(V,$,D-1/3)}return[Math.round(x*255),Math.round(z*255),Math.round(K*255)]}function d(D,B,U){D/=255,B/=255,U/=255;var x=Math.max(D,B,U),z=Math.min(D,B,U),K,Y,$=(x+z)/2;if(x==z)K=Y=0;else{var V=x-z;switch(Y=$>.5?V/(2-x-z):V/(x+z),x){case D:K=(B-U)/V+(B<U?6:0);break;case B:K=(U-D)/V+2;break;case U:K=(D-B)/V+4;break}K/=6}return[K,Y,$]}function C(D){D==null&&(D="Sheet");for(var B=window.navigator.userAgent.replace(/[^a-zA-Z0-9]/g,"").split(""),U="",x=0;x<5;x++)U+=B[Math.round(Math.random()*(B.length-1))];var z=new Date().getTime();return D+"_"+U+"_"+z}n.generateRandomIndex=C;function c(D){return D==null||D.length==0?D:D.replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&nbsp;/g," ").replace(/&apos;/g,"'").replace(/&iexcl;/g,"").replace(/&cent;/g,"").replace(/&pound;/g,"").replace(/&curren;/g,"").replace(/&yen;/g,"").replace(/&brvbar;/g,"").replace(/&sect;/g,"").replace(/&uml;/g,"").replace(/&copy;/g,"").replace(/&ordf;/g,"").replace(/&laquo;/g,"").replace(/&not;/g,"").replace(/&shy;/g,"").replace(/&reg;/g,"").replace(/&macr;/g,"").replace(/&deg;/g,"").replace(/&plusmn;/g,"").replace(/&sup2;/g,"").replace(/&sup3;/g,"").replace(/&acute;/g,"").replace(/&micro;/g,"").replace(/&para;/g,"").replace(/&middot;/g,"").replace(/&cedil;/g,"").replace(/&sup1;/g,"").replace(/&ordm;/g,"").replace(/&raquo;/g,"").replace(/&frac14;/g,"").replace(/&frac12;/g,"").replace(/&frac34;/g,"").replace(/&iquest;/g,"").replace(/&times;/g,"").replace(/&divide;/g,"").replace(/&Agrave;/g,"").replace(/&Aacute;/g,"").replace(/&Acirc;/g,"").replace(/&Atilde;/g,"").replace(/&Auml;/g,"").replace(/&Aring;/g,"").replace(/&AElig;/g,"").replace(/&Ccedil;/g,"").replace(/&Egrave;/g,"").replace(/&Eacute;/g,"").replace(/&Ecirc;/g,"").replace(/&Euml;/g,"").replace(/&Igrave;/g,"").replace(/&Iacute;/g,"").replace(/&Icirc;/g,"").replace(/&Iuml;/g,"").replace(/&ETH;/g,"").replace(/&Ntilde;/g,"").replace(/&Ograve;/g,"").replace(/&Oacute;/g,"").replace(/&Ocirc;/g,"").replace(/&Otilde;/g,"").replace(/&Ouml;/g,"").replace(/&Oslash;/g,"").replace(/&Ugrave;/g,"").replace(/&Uacute;/g,"").replace(/&Ucirc;/g,"").replace(/&Uuml;/g,"").replace(/&Yacute;/g,"").replace(/&THORN;/g,"").replace(/&szlig;/g,"").replace(/&agrave;/g,"").replace(/&aacute;/g,"").replace(/&acirc;/g,"").replace(/&atilde;/g,"").replace(/&auml;/g,"").replace(/&aring;/g,"").replace(/&aelig;/g,"").replace(/&ccedil;/g,"").replace(/&egrave;/g,"").replace(/&eacute;/g,"").replace(/&ecirc;/g,"").replace(/&euml;/g,"").replace(/&igrave;/g,"").replace(/&iacute;/g,"").replace(/&icirc;/g,"").replace(/&iuml;/g,"").replace(/&eth;/g,"").replace(/&ntilde;/g,"").replace(/&ograve;/g,"").replace(/&oacute;/g,"").replace(/&ocirc;/g,"").replace(/&otilde;/g,"").replace(/&ouml;/g,"").replace(/&oslash;/g,"").replace(/&ugrave;/g,"").replace(/&uacute;/g,"").replace(/&ucirc;/g,"").replace(/&uuml;/g,"").replace(/&yacute;/g,"").replace(/&thorn;/g,"").replace(/&yuml;/g,"")}n.escapeCharacter=c;var E=(function(){function D(){}return D.trim=function(B){return B==null&&(B=""),B.replace(/(^\s*)|(\s*$)/g,"")},D.functionCopy=function(B,U,x){var z=this;if(z.operatorjson==null){for(var K=z.operator.split("|"),Y={},$=0;$<K.length;$++)Y[K[$].toString()]=1;z.operatorjson=Y}U==null&&(U="down"),x==null&&(x=1),B.substr(0,1)=="="&&(B=B.substr(1));for(var V=B.split(""),ce=0,ie="",de="",ve={bracket:0,squote:0,dquote:0};ce<V.length;){var Z=V[ce];if(Z=="("&&ve.dquote==0)ve.bracket+=1,ie.length>0?de+=ie+"(":de+="(",ie="";else if(Z==")"&&ve.dquote==0)ve.bracket-=1,de+=z.functionCopy(ie,U,x)+")",ie="";else if(Z=='"'&&ve.squote==0)ve.dquote>0?(de+=ie+'"',ve.dquote-=1,ie=""):(ve.dquote+=1,ie+='"');else if(Z==","&&ve.dquote==0)de+=z.functionCopy(ie,U,x)+",",ie="";else if(Z=="&"&&ve.dquote==0)ie.length>0?(de+=z.functionCopy(ie,U,x)+"&",ie=""):de+="&";else if(Z in z.operatorjson&&ve.dquote==0){var j="";ce+1<V.length&&(j=V[ce+1]);var re=ce-1,ue=null;if(re>=0)do ue=V[re--];while(re>=0&&ue==" ");Z+j in z.operatorjson?(ie.length>0?(de+=z.functionCopy(ie,U,x)+Z+j,ie=""):de+=Z+j,ce++):!/[^0-9]/.test(j)&&Z=="-"&&(ue=="("||ue==null||ue==","||ue==" "||ue in z.operatorjson)?ie+=Z:ie.length>0?(de+=z.functionCopy(ie,U,x)+Z,ie=""):de+=Z}else ie+=Z;ce==V.length-1&&(z.iscelldata(z.trim(ie))?U=="down"?de+=z.downparam(z.trim(ie),x):U=="up"?de+=z.upparam(z.trim(ie),x):U=="left"?de+=z.leftparam(z.trim(ie),x):U=="right"&&(de+=z.rightparam(z.trim(ie),x)):de+=z.trim(ie)),ce++}return de},D.downparam=function(B,U){return this.updateparam("d",B,U)},D.upparam=function(B,U){return this.updateparam("u",B,U)},D.leftparam=function(B,U){return this.updateparam("l",B,U)},D.rightparam=function(B,U){return this.updateparam("r",B,U)},D.updateparam=function(B,U,x){var z=this,K=U.split("!"),Y,$="";if(K.length>1?(Y=K[1],$=K[0]+"!"):Y=K[0],Y.indexOf(":")==-1){var V=parseInt(Y.replace(/[^0-9]/g,"")),ce=a(Y.replace(/[^A-Za-z]/g,"")),ie=z.isfreezonFuc(Y),de=ie[0]?"$":"",ve=ie[1]?"$":"";return B=="u"&&!ie[0]?V-=x:B=="r"&&!ie[1]?ce+=x:B=="l"&&!ie[1]?ce-=x:ie[0]||(V+=x),V<0||ce<0?z.error.r:!isNaN(V)&&!isNaN(ce)?$+ve+f(ce)+de+V:isNaN(V)?isNaN(ce)?U:$+ve+f(ce):$+de+V}else{Y=Y.split(":");var V=[],ce=[];if(V[0]=parseInt(Y[0].replace(/[^0-9]/g,"")),V[1]=parseInt(Y[1].replace(/[^0-9]/g,"")),V[0]>V[1]||(ce[0]=a(Y[0].replace(/[^A-Za-z]/g,"")),ce[1]=a(Y[1].replace(/[^A-Za-z]/g,"")),ce[0]>ce[1]))return U;var Z=z.isfreezonFuc(Y[0]),j=z.isfreezonFuc(Y[1]),re=Z[0]?"$":"",ue=Z[1]?"$":"",ge=j[0]?"$":"",me=j[1]?"$":"";return B=="u"?(Z[0]||(V[0]-=x),j[0]||(V[1]-=x)):B=="r"?(Z[1]||(ce[0]+=x),j[1]||(ce[1]+=x)):B=="l"?(Z[1]||(ce[0]-=x),j[1]||(ce[1]-=x)):(Z[0]||(V[0]+=x),j[0]||(V[1]+=x)),V[0]<0||ce[0]<0?z.error.r:isNaN(ce[0])&&isNaN(ce[1])?$+re+V[0]+":"+ge+V[1]:isNaN(V[0])&&isNaN(V[1])?$+ue+f(ce[0])+":"+me+f(ce[1]):$+ue+f(ce[0])+re+V[0]+":"+me+f(ce[1])+ge+V[1]}},D.iscelldata=function(B){var U=B.split("!"),x;U.length>1?x=U[1]:x=U[0];var z=/^(([a-zA-Z]+)|([$][a-zA-Z]+))(([0-9]+)|([$][0-9]+))$/g,K=/^(((([a-zA-Z]+)|([$][a-zA-Z]+))(([0-9]+)|([$][0-9]+)))|((([a-zA-Z]+)|([$][a-zA-Z]+))))$/g;if(x.indexOf(":")==-1){var Y=parseInt(x.replace(/[^0-9]/g,""))-1,$=a(x.replace(/[^A-Za-z]/g,""));return!isNaN(Y)&&!isNaN($)&&x.toString().match(z)?!0:(isNaN(Y)&&isNaN($),!1)}else{K=/^(((([a-zA-Z]+)|([$][a-zA-Z]+))(([0-9]+)|([$][0-9]+)))|((([a-zA-Z]+)|([$][a-zA-Z]+)))|((([0-9]+)|([$][0-9]+s))))$/g,x=x.split(":");var Y=[],$=[];return Y[0]=parseInt(x[0].replace(/[^0-9]/g,""))-1,Y[1]=parseInt(x[1].replace(/[^0-9]/g,""))-1,Y[0]>Y[1]||($[0]=a(x[0].replace(/[^A-Za-z]/g,"")),$[1]=a(x[1].replace(/[^A-Za-z]/g,"")),$[0]>$[1])?!1:!!(x[0].toString().match(K)&&x[1].toString().match(K))}},D.isfreezonFuc=function(B){var U=B.replace(/[^0-9]/g,""),x=B.replace(/[^A-Za-z]/g,""),z=B.substr(B.indexOf(U)-1,1),K=B.substr(B.indexOf(x)-1,1),Y=[!1,!1];return z=="$"&&(Y[0]=!0),K=="$"&&(Y[1]=!0),Y},D.operator="==|!=|<>|<=|>=|=|+|-|>|<|/|*|%|&|^",D.error={v:"#VALUE!",n:"#NAME?",na:"#N/A",r:"#REF!",d:"#DIV/0!",nm:"#NUM!",nl:"#NULL!",sp:"#SPILL!"},D.operatorjson=null,D})();n.fromulaRef=E;function O(D){var B=/[^\u4e00-\u9fa5]/,U=/[\u3002|\uff1f|\uff01|\uff0c|\u3001|\uff1b|\uff1a|\u201c|\u201d|\u2018|\u2019|\uff08|\uff09|\u300a|\u300b|\u3008|\u3009|\u3010|\u3011|\u300e|\u300f|\u300c|\u300d|\ufe43|\ufe44|\u3014|\u3015|\u2026|\u2014|\uff5e|\ufe4f|\uffe5]/;return U.test(D)?!0:!B.test(D)}n.isChinese=O;function P(D){var B=/[^\u0800-\u4e00]/;return!B.test(D)}n.isJapanese=P;function W(D){return D>12592&&D<12687||D>=44032&&D<=55203}n.isKoera=W;function A(D){var B=!1;escape(D).indexOf("%u")>-1&&(B=!0);var U=!1,x=/[0-9a-z]/gi;x.test(D)&&(U=!0);var z=/[\x00-\xff]+/g;return z.test(D)&&(U=!0),!!(B&&U)}n.isContainMultiType=A;function ee(D,B){var U,x,z,K;B||(B={});var Y=function(){try{return new window.XMLHttpRequest}catch{}},$=function(){try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch{}},V=typeof window<"u"&&window.ActiveXObject?(function(){return Y()||$()}):Y;typeof B=="function"?(K=B,B={}):typeof B.callback=="function"&&(K=B.callback),x=function(de){K(null,de)},z=function(de){K(de,null)};try{var ce=V();ce.open("GET",D,!0),"responseType"in ce&&(ce.responseType="arraybuffer"),ce.overrideMimeType&&ce.overrideMimeType("text/plain; charset=x-user-defined"),ce.onreadystatechange=function(ie){if(ce.readyState===4)if(ce.status===200||ce.status===0)try{x((function(de){return de.response||de.responseText})(ce))}catch(de){z(new Error(de))}else z(new Error("Ajax error for "+D+" : "+this.status+" "+this.statusText))},B.progress&&(ce.onprogress=function(ie){B.progress({path:D,originalEvent:ie,percent:ie.loaded/ie.total*100,loaded:ie.loaded,total:ie.total})}),ce.send()}catch(ie){z(new Error(ie),null)}return U}n.getBinaryContent=ee},{"./constant":91}],94:[function(e,g,n){Object.defineProperty(n,"__esModule",{value:!0}),n.LuckyExcel=void 0;var y=e("./ToLuckySheet/LuckyFile"),r=e("./HandleZip"),t=(function(){function a(){}return a.transformExcelToLucky=function(f,u){var s=new r.HandleZip(f);s.unzipFile(function(w){var _=new y.LuckyFile(w,f.name),S=_.Parse(),b=JSON.parse(S);u?.(b,S)},function(w){console.error(w)})},a.transformExcelToLuckyByUrl=function(f,u,s){var w=new r.HandleZip;w.unzipFileByUrl(f,function(_){var S=new y.LuckyFile(_,u),b=S.Parse(),p=JSON.parse(b);s?.(p,b)},function(_){console.error(_)})},a.transformLuckyToExcel=function(f,u){},a})();n.LuckyExcel=t},{"./HandleZip":84,"./ToLuckySheet/LuckyFile":87}],95:[function(e,g,n){var y=e("./main");g.exports=y.LuckyExcel},{"./main":94}]},{},[95])(95)})})(Wt)),Wt.exports}var Yr=Gr();const Kr=jr(Yr),nt=Object.create(null);nt.open="0";nt.close="1";nt.ping="2";nt.pong="3";nt.message="4";nt.upgrade="5";nt.noop="6";const At=Object.create(null);Object.keys(nt).forEach(F=>{At[nt[F]]=F});const jt={type:"error",data:"parser error"},wr=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Er=typeof ArrayBuffer=="function",br=F=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(F):F&&F.buffer instanceof ArrayBuffer,$t=({type:F,data:h},e,g)=>wr&&h instanceof Blob?e?g(h):vr(h,g):Er&&(h instanceof ArrayBuffer||br(h))?e?g(h):vr(new Blob([h]),g):g(nt[F]+(h||"")),vr=(F,h)=>{const e=new FileReader;return e.onload=function(){const g=e.result.split(",")[1];h("b"+(g||""))},e.readAsDataURL(F)};function gr(F){return F instanceof Uint8Array?F:F instanceof ArrayBuffer?new Uint8Array(F):new Uint8Array(F.buffer,F.byteOffset,F.byteLength)}let Ht;function Vr(F,h){if(wr&&F.data instanceof Blob)return F.data.arrayBuffer().then(gr).then(h);if(Er&&(F.data instanceof ArrayBuffer||br(F.data)))return h(gr(F.data));$t(F,!1,e=>{Ht||(Ht=new TextEncoder),h(Ht.encode(e))})}const mr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bt=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let F=0;F<mr.length;F++)bt[mr.charCodeAt(F)]=F;const Jr=F=>{let h=F.length*.75,e=F.length,g,n=0,y,r,t,a;F[F.length-1]==="="&&(h--,F[F.length-2]==="="&&h--);const f=new ArrayBuffer(h),u=new Uint8Array(f);for(g=0;g<e;g+=4)y=bt[F.charCodeAt(g)],r=bt[F.charCodeAt(g+1)],t=bt[F.charCodeAt(g+2)],a=bt[F.charCodeAt(g+3)],u[n++]=y<<2|r>>4,u[n++]=(r&15)<<4|t>>2,u[n++]=(t&3)<<6|a&63;return f},$r=typeof ArrayBuffer=="function",Qt=(F,h)=>{if(typeof F!="string")return{type:"message",data:Sr(F,h)};const e=F.charAt(0);return e==="b"?{type:"message",data:Qr(F.substring(1),h)}:At[e]?F.length>1?{type:At[e],data:F.substring(1)}:{type:At[e]}:jt},Qr=(F,h)=>{if($r){const e=Jr(F);return Sr(e,h)}else return{base64:!0,data:F}},Sr=(F,h)=>{switch(h){case"blob":return F instanceof Blob?F:new Blob([F]);case"arraybuffer":default:return F instanceof ArrayBuffer?F:F.buffer}},Tr="",qr=(F,h)=>{const e=F.length,g=new Array(e);let n=0;F.forEach((y,r)=>{$t(y,!1,t=>{g[r]=t,++n===e&&h(g.join(Tr))})})},ei=(F,h)=>{const e=F.split(Tr),g=[];for(let n=0;n<e.length;n++){const y=Qt(e[n],h);if(g.push(y),y.type==="error")break}return g};function ti(){return new TransformStream({transform(F,h){Vr(F,e=>{const g=e.length;let n;if(g<126)n=new Uint8Array(1),new DataView(n.buffer).setUint8(0,g);else if(g<65536){n=new Uint8Array(3);const y=new DataView(n.buffer);y.setUint8(0,126),y.setUint16(1,g)}else{n=new Uint8Array(9);const y=new DataView(n.buffer);y.setUint8(0,127),y.setBigUint64(1,BigInt(g))}F.data&&typeof F.data!="string"&&(n[0]|=128),h.enqueue(n),h.enqueue(e)})}})}let Zt;function Ct(F){return F.reduce((h,e)=>h+e.length,0)}function Rt(F,h){if(F[0].length===h)return F.shift();const e=new Uint8Array(h);let g=0;for(let n=0;n<h;n++)e[n]=F[0][g++],g===F[0].length&&(F.shift(),g=0);return F.length&&g<F[0].length&&(F[0]=F[0].slice(g)),e}function ri(F,h){Zt||(Zt=new TextDecoder);const e=[];let g=0,n=-1,y=!1;return new TransformStream({transform(r,t){for(e.push(r);;){if(g===0){if(Ct(e)<1)break;const a=Rt(e,1);y=(a[0]&128)===128,n=a[0]&127,n<126?g=3:n===126?g=1:g=2}else if(g===1){if(Ct(e)<2)break;const a=Rt(e,2);n=new DataView(a.buffer,a.byteOffset,a.length).getUint16(0),g=3}else if(g===2){if(Ct(e)<8)break;const a=Rt(e,8),f=new DataView(a.buffer,a.byteOffset,a.length),u=f.getUint32(0);if(u>Math.pow(2,21)-1){t.enqueue(jt);break}n=u*Math.pow(2,32)+f.getUint32(4),g=3}else{if(Ct(e)<n)break;const a=Rt(e,n);t.enqueue(Qt(y?a:Zt.decode(a),h)),g=0}if(n===0||n>F){t.enqueue(jt);break}}}})}const kr=4;function Ge(F){if(F)return ii(F)}function ii(F){for(var h in Ge.prototype)F[h]=Ge.prototype[h];return F}Ge.prototype.on=Ge.prototype.addEventListener=function(F,h){return this._callbacks=this._callbacks||{},(this._callbacks["$"+F]=this._callbacks["$"+F]||[]).push(h),this};Ge.prototype.once=function(F,h){function e(){this.off(F,e),h.apply(this,arguments)}return e.fn=h,this.on(F,e),this};Ge.prototype.off=Ge.prototype.removeListener=Ge.prototype.removeAllListeners=Ge.prototype.removeEventListener=function(F,h){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var e=this._callbacks["$"+F];if(!e)return this;if(arguments.length==1)return delete this._callbacks["$"+F],this;for(var g,n=0;n<e.length;n++)if(g=e[n],g===h||g.fn===h){e.splice(n,1);break}return e.length===0&&delete this._callbacks["$"+F],this};Ge.prototype.emit=function(F){this._callbacks=this._callbacks||{};for(var h=new Array(arguments.length-1),e=this._callbacks["$"+F],g=1;g<arguments.length;g++)h[g-1]=arguments[g];if(e){e=e.slice(0);for(var g=0,n=e.length;g<n;++g)e[g].apply(this,h)}return this};Ge.prototype.emitReserved=Ge.prototype.emit;Ge.prototype.listeners=function(F){return this._callbacks=this._callbacks||{},this._callbacks["$"+F]||[]};Ge.prototype.hasListeners=function(F){return!!this.listeners(F).length};const Ft=typeof Promise=="function"&&typeof Promise.resolve=="function"?h=>Promise.resolve().then(h):(h,e)=>e(h,0),Qe=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),ni="arraybuffer";function Cr(F,...h){return h.reduce((e,g)=>(F.hasOwnProperty(g)&&(e[g]=F[g]),e),{})}const ai=Qe.setTimeout,si=Qe.clearTimeout;function Bt(F,h){h.useNativeTimers?(F.setTimeoutFn=ai.bind(Qe),F.clearTimeoutFn=si.bind(Qe)):(F.setTimeoutFn=Qe.setTimeout.bind(Qe),F.clearTimeoutFn=Qe.clearTimeout.bind(Qe))}const oi=1.33;function li(F){return typeof F=="string"?ui(F):Math.ceil((F.byteLength||F.size)*oi)}function ui(F){let h=0,e=0;for(let g=0,n=F.length;g<n;g++)h=F.charCodeAt(g),h<128?e+=1:h<2048?e+=2:h<55296||h>=57344?e+=3:(g++,e+=4);return e}function Rr(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function fi(F){let h="";for(let e in F)F.hasOwnProperty(e)&&(h.length&&(h+="&"),h+=encodeURIComponent(e)+"="+encodeURIComponent(F[e]));return h}function ci(F){let h={},e=F.split("&");for(let g=0,n=e.length;g<n;g++){let y=e[g].split("=");h[decodeURIComponent(y[0])]=decodeURIComponent(y[1])}return h}class hi extends Error{constructor(h,e,g){super(h),this.description=e,this.context=g,this.type="TransportError"}}class qt extends Ge{constructor(h){super(),this.writable=!1,Bt(this,h),this.opts=h,this.query=h.query,this.socket=h.socket,this.supportsBinary=!h.forceBase64}onError(h,e,g){return super.emitReserved("error",new hi(h,e,g)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(h){this.readyState==="open"&&this.write(h)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(h){const e=Qt(h,this.socket.binaryType);this.onPacket(e)}onPacket(h){super.emitReserved("packet",h)}onClose(h){this.readyState="closed",super.emitReserved("close",h)}pause(h){}createUri(h,e={}){return h+"://"+this._hostname()+this._port()+this.opts.path+this._query(e)}_hostname(){const h=this.opts.hostname;return h.indexOf(":")===-1?h:"["+h+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(h){const e=fi(h);return e.length?"?"+e:""}}class di extends qt{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(h){this.readyState="pausing";const e=()=>{this.readyState="paused",h()};if(this._polling||!this.writable){let g=0;this._polling&&(g++,this.once("pollComplete",function(){--g||e()})),this.writable||(g++,this.once("drain",function(){--g||e()}))}else e()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(h){const e=g=>{if(this.readyState==="opening"&&g.type==="open"&&this.onOpen(),g.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(g)};ei(h,this.socket.binaryType).forEach(e),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const h=()=>{this.write([{type:"close"}])};this.readyState==="open"?h():this.once("open",h)}write(h){this.writable=!1,qr(h,e=>{this.doWrite(e,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const h=this.opts.secure?"https":"http",e=this.query||{};return this.opts.timestampRequests!==!1&&(e[this.opts.timestampParam]=Rr()),!this.supportsBinary&&!e.sid&&(e.b64=1),this.createUri(h,e)}}let Ar=!1;try{Ar=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const pi=Ar;function vi(){}class gi extends di{constructor(h){if(super(h),typeof location<"u"){const e=location.protocol==="https:";let g=location.port;g||(g=e?"443":"80"),this.xd=typeof location<"u"&&h.hostname!==location.hostname||g!==h.port}}doWrite(h,e){const g=this.request({method:"POST",data:h});g.on("success",e),g.on("error",(n,y)=>{this.onError("xhr post error",n,y)})}doPoll(){const h=this.request();h.on("data",this.onData.bind(this)),h.on("error",(e,g)=>{this.onError("xhr poll error",e,g)}),this.pollXhr=h}}class it extends Ge{constructor(h,e,g){super(),this.createRequest=h,Bt(this,g),this._opts=g,this._method=g.method||"GET",this._uri=e,this._data=g.data!==void 0?g.data:null,this._create()}_create(){var h;const e=Cr(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");e.xdomain=!!this._opts.xd;const g=this._xhr=this.createRequest(e);try{g.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){g.setDisableHeaderCheck&&g.setDisableHeaderCheck(!0);for(let n in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(n)&&g.setRequestHeader(n,this._opts.extraHeaders[n])}}catch{}if(this._method==="POST")try{g.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{g.setRequestHeader("Accept","*/*")}catch{}(h=this._opts.cookieJar)===null||h===void 0||h.addCookies(g),"withCredentials"in g&&(g.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(g.timeout=this._opts.requestTimeout),g.onreadystatechange=()=>{var n;g.readyState===3&&((n=this._opts.cookieJar)===null||n===void 0||n.parseCookies(g.getResponseHeader("set-cookie"))),g.readyState===4&&(g.status===200||g.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof g.status=="number"?g.status:0)},0))},g.send(this._data)}catch(n){this.setTimeoutFn(()=>{this._onError(n)},0);return}typeof document<"u"&&(this._index=it.requestsCount++,it.requests[this._index]=this)}_onError(h){this.emitReserved("error",h,this._xhr),this._cleanup(!0)}_cleanup(h){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=vi,h)try{this._xhr.abort()}catch{}typeof document<"u"&&delete it.requests[this._index],this._xhr=null}}_onLoad(){const h=this._xhr.responseText;h!==null&&(this.emitReserved("data",h),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}it.requestsCount=0;it.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",_r);else if(typeof addEventListener=="function"){const F="onpagehide"in Qe?"pagehide":"unload";addEventListener(F,_r,!1)}}function _r(){for(let F in it.requests)it.requests.hasOwnProperty(F)&&it.requests[F].abort()}const mi=(function(){const F=Lr({xdomain:!1});return F&&F.responseType!==null})();class _i extends gi{constructor(h){super(h);const e=h&&h.forceBase64;this.supportsBinary=mi&&!e}request(h={}){return Object.assign(h,{xd:this.xd},this.opts),new it(Lr,this.uri(),h)}}function Lr(F){const h=F.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!h||pi))return new XMLHttpRequest}catch{}if(!h)try{return new Qe[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const Or=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class yi extends qt{get name(){return"websocket"}doOpen(){const h=this.uri(),e=this.opts.protocols,g=Or?{}:Cr(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(g.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(h,e,g)}catch(n){return this.emitReserved("error",n)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=h=>this.onClose({description:"websocket connection closed",context:h}),this.ws.onmessage=h=>this.onData(h.data),this.ws.onerror=h=>this.onError("websocket error",h)}write(h){this.writable=!1;for(let e=0;e<h.length;e++){const g=h[e],n=e===h.length-1;$t(g,this.supportsBinary,y=>{try{this.doWrite(g,y)}catch{}n&&Ft(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const h=this.opts.secure?"wss":"ws",e=this.query||{};return this.opts.timestampRequests&&(e[this.opts.timestampParam]=Rr()),this.supportsBinary||(e.b64=1),this.createUri(h,e)}}const Xt=Qe.WebSocket||Qe.MozWebSocket;class wi extends yi{createSocket(h,e,g){return Or?new Xt(h,e,g):e?new Xt(h,e):new Xt(h)}doWrite(h,e){this.ws.send(e)}}class Ei extends qt{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(h){return this.emitReserved("error",h)}this._transport.closed.then(()=>{this.onClose()}).catch(h=>{this.onError("webtransport error",h)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(h=>{const e=ri(Number.MAX_SAFE_INTEGER,this.socket.binaryType),g=h.readable.pipeThrough(e).getReader(),n=ti();n.readable.pipeTo(h.writable),this._writer=n.writable.getWriter();const y=()=>{g.read().then(({done:t,value:a})=>{t||(this.onPacket(a),y())}).catch(t=>{})};y();const r={type:"open"};this.query.sid&&(r.data=`{"sid":"${this.query.sid}"}`),this._writer.write(r).then(()=>this.onOpen())})})}write(h){this.writable=!1;for(let e=0;e<h.length;e++){const g=h[e],n=e===h.length-1;this._writer.write(g).then(()=>{n&&Ft(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var h;(h=this._transport)===null||h===void 0||h.close()}}const bi={websocket:wi,webtransport:Ei,polling:_i},Si=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Ti=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Gt(F){if(F.length>8e3)throw"URI too long";const h=F,e=F.indexOf("["),g=F.indexOf("]");e!=-1&&g!=-1&&(F=F.substring(0,e)+F.substring(e,g).replace(/:/g,";")+F.substring(g,F.length));let n=Si.exec(F||""),y={},r=14;for(;r--;)y[Ti[r]]=n[r]||"";return e!=-1&&g!=-1&&(y.source=h,y.host=y.host.substring(1,y.host.length-1).replace(/;/g,":"),y.authority=y.authority.replace("[","").replace("]","").replace(/;/g,":"),y.ipv6uri=!0),y.pathNames=ki(y,y.path),y.queryKey=Ci(y,y.query),y}function ki(F,h){const e=/\/{2,9}/g,g=h.replace(e,"/").split("/");return(h.slice(0,1)=="/"||h.length===0)&&g.splice(0,1),h.slice(-1)=="/"&&g.splice(g.length-1,1),g}function Ci(F,h){const e={};return h.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(g,n,y){n&&(e[n]=y)}),e}const Yt=typeof addEventListener=="function"&&typeof removeEventListener=="function",Lt=[];Yt&&addEventListener("offline",()=>{Lt.forEach(F=>F())},!1);class ut extends Ge{constructor(h,e){if(super(),this.binaryType=ni,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,h&&typeof h=="object"&&(e=h,h=null),h){const g=Gt(h);e.hostname=g.host,e.secure=g.protocol==="https"||g.protocol==="wss",e.port=g.port,g.query&&(e.query=g.query)}else e.host&&(e.hostname=Gt(e.host).host);Bt(this,e),this.secure=e.secure!=null?e.secure:typeof location<"u"&&location.protocol==="https:",e.hostname&&!e.port&&(e.port=this.secure?"443":"80"),this.hostname=e.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=e.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},e.transports.forEach(g=>{const n=g.prototype.name;this.transports.push(n),this._transportsByName[n]=g}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},e),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=ci(this.opts.query)),Yt&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},Lt.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(h){const e=Object.assign({},this.opts.query);e.EIO=kr,e.transport=h,this.id&&(e.sid=this.id);const g=Object.assign({},this.opts,{query:e,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[h]);return new this._transportsByName[h](g)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const h=this.opts.rememberUpgrade&&ut.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const e=this.createTransport(h);e.open(),this.setTransport(e)}setTransport(h){this.transport&&this.transport.removeAllListeners(),this.transport=h,h.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",e=>this._onClose("transport close",e))}onOpen(){this.readyState="open",ut.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(h){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",h),this.emitReserved("heartbeat"),h.type){case"open":this.onHandshake(JSON.parse(h.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const e=new Error("server error");e.code=h.data,this._onError(e);break;case"message":this.emitReserved("data",h.data),this.emitReserved("message",h.data);break}}onHandshake(h){this.emitReserved("handshake",h),this.id=h.sid,this.transport.query.sid=h.sid,this._pingInterval=h.pingInterval,this._pingTimeout=h.pingTimeout,this._maxPayload=h.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const h=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+h,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},h),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const h=this._getWritablePackets();this.transport.send(h),this._prevBufferLen=h.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let e=1;for(let g=0;g<this.writeBuffer.length;g++){const n=this.writeBuffer[g].data;if(n&&(e+=li(n)),g>0&&e>this._maxPayload)return this.writeBuffer.slice(0,g);e+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const h=Date.now()>this._pingTimeoutTime;return h&&(this._pingTimeoutTime=0,Ft(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),h}write(h,e,g){return this._sendPacket("message",h,e,g),this}send(h,e,g){return this._sendPacket("message",h,e,g),this}_sendPacket(h,e,g,n){if(typeof e=="function"&&(n=e,e=void 0),typeof g=="function"&&(n=g,g=null),this.readyState==="closing"||this.readyState==="closed")return;g=g||{},g.compress=g.compress!==!1;const y={type:h,data:e,options:g};this.emitReserved("packetCreate",y),this.writeBuffer.push(y),n&&this.once("flush",n),this.flush()}close(){const h=()=>{this._onClose("forced close"),this.transport.close()},e=()=>{this.off("upgrade",e),this.off("upgradeError",e),h()},g=()=>{this.once("upgrade",e),this.once("upgradeError",e)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?g():h()}):this.upgrading?g():h()),this}_onError(h){if(ut.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",h),this._onClose("transport error",h)}_onClose(h,e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),Yt&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const g=Lt.indexOf(this._offlineEventListener);g!==-1&&Lt.splice(g,1)}this.readyState="closed",this.id=null,this.emitReserved("close",h,e),this.writeBuffer=[],this._prevBufferLen=0}}}ut.protocol=kr;class Ri extends ut{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let h=0;h<this._upgrades.length;h++)this._probe(this._upgrades[h])}_probe(h){let e=this.createTransport(h),g=!1;ut.priorWebsocketSuccess=!1;const n=()=>{g||(e.send([{type:"ping",data:"probe"}]),e.once("packet",s=>{if(!g)if(s.type==="pong"&&s.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",e),!e)return;ut.priorWebsocketSuccess=e.name==="websocket",this.transport.pause(()=>{g||this.readyState!=="closed"&&(u(),this.setTransport(e),e.send([{type:"upgrade"}]),this.emitReserved("upgrade",e),e=null,this.upgrading=!1,this.flush())})}else{const w=new Error("probe error");w.transport=e.name,this.emitReserved("upgradeError",w)}}))};function y(){g||(g=!0,u(),e.close(),e=null)}const r=s=>{const w=new Error("probe error: "+s);w.transport=e.name,y(),this.emitReserved("upgradeError",w)};function t(){r("transport closed")}function a(){r("socket closed")}function f(s){e&&s.name!==e.name&&y()}const u=()=>{e.removeListener("open",n),e.removeListener("error",r),e.removeListener("close",t),this.off("close",a),this.off("upgrading",f)};e.once("open",n),e.once("error",r),e.once("close",t),this.once("close",a),this.once("upgrading",f),this._upgrades.indexOf("webtransport")!==-1&&h!=="webtransport"?this.setTimeoutFn(()=>{g||e.open()},200):e.open()}onHandshake(h){this._upgrades=this._filterUpgrades(h.upgrades),super.onHandshake(h)}_filterUpgrades(h){const e=[];for(let g=0;g<h.length;g++)~this.transports.indexOf(h[g])&&e.push(h[g]);return e}}let Ai=class extends Ri{constructor(h,e={}){const g=typeof h=="object"?h:e;(!g.transports||g.transports&&typeof g.transports[0]=="string")&&(g.transports=(g.transports||["polling","websocket","webtransport"]).map(n=>bi[n]).filter(n=>!!n)),super(h,g)}};function Li(F,h="",e){let g=F;e=e||typeof location<"u"&&location,F==null&&(F=e.protocol+"//"+e.host),typeof F=="string"&&(F.charAt(0)==="/"&&(F.charAt(1)==="/"?F=e.protocol+F:F=e.host+F),/^(https?|wss?):\/\//.test(F)||(typeof e<"u"?F=e.protocol+"//"+F:F="https://"+F),g=Gt(F)),g.port||(/^(http|ws)$/.test(g.protocol)?g.port="80":/^(http|ws)s$/.test(g.protocol)&&(g.port="443")),g.path=g.path||"/";const y=g.host.indexOf(":")!==-1?"["+g.host+"]":g.host;return g.id=g.protocol+"://"+y+":"+g.port+h,g.href=g.protocol+"://"+y+(e&&e.port===g.port?"":":"+g.port),g}const Oi=typeof ArrayBuffer=="function",Ii=F=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(F):F.buffer instanceof ArrayBuffer,Ir=Object.prototype.toString,Fi=typeof Blob=="function"||typeof Blob<"u"&&Ir.call(Blob)==="[object BlobConstructor]",Bi=typeof File=="function"||typeof File<"u"&&Ir.call(File)==="[object FileConstructor]";function er(F){return Oi&&(F instanceof ArrayBuffer||Ii(F))||Fi&&F instanceof Blob||Bi&&F instanceof File}function Ot(F,h){if(!F||typeof F!="object")return!1;if(Array.isArray(F)){for(let e=0,g=F.length;e<g;e++)if(Ot(F[e]))return!0;return!1}if(er(F))return!0;if(F.toJSON&&typeof F.toJSON=="function"&&arguments.length===1)return Ot(F.toJSON(),!0);for(const e in F)if(Object.prototype.hasOwnProperty.call(F,e)&&Ot(F[e]))return!0;return!1}function Mi(F){const h=[],e=F.data,g=F;return g.data=Kt(e,h),g.attachments=h.length,{packet:g,buffers:h}}function Kt(F,h){if(!F)return F;if(er(F)){const e={_placeholder:!0,num:h.length};return h.push(F),e}else if(Array.isArray(F)){const e=new Array(F.length);for(let g=0;g<F.length;g++)e[g]=Kt(F[g],h);return e}else if(typeof F=="object"&&!(F instanceof Date)){const e={};for(const g in F)Object.prototype.hasOwnProperty.call(F,g)&&(e[g]=Kt(F[g],h));return e}return F}function Di(F,h){return F.data=Vt(F.data,h),delete F.attachments,F}function Vt(F,h){if(!F)return F;if(F&&F._placeholder===!0){if(typeof F.num=="number"&&F.num>=0&&F.num<h.length)return h[F.num];throw new Error("illegal attachments")}else if(Array.isArray(F))for(let e=0;e<F.length;e++)F[e]=Vt(F[e],h);else if(typeof F=="object")for(const e in F)Object.prototype.hasOwnProperty.call(F,e)&&(F[e]=Vt(F[e],h));return F}const Ni=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],Pi=5;var De;(function(F){F[F.CONNECT=0]="CONNECT",F[F.DISCONNECT=1]="DISCONNECT",F[F.EVENT=2]="EVENT",F[F.ACK=3]="ACK",F[F.CONNECT_ERROR=4]="CONNECT_ERROR",F[F.BINARY_EVENT=5]="BINARY_EVENT",F[F.BINARY_ACK=6]="BINARY_ACK"})(De||(De={}));class xi{constructor(h){this.replacer=h}encode(h){return(h.type===De.EVENT||h.type===De.ACK)&&Ot(h)?this.encodeAsBinary({type:h.type===De.EVENT?De.BINARY_EVENT:De.BINARY_ACK,nsp:h.nsp,data:h.data,id:h.id}):[this.encodeAsString(h)]}encodeAsString(h){let e=""+h.type;return(h.type===De.BINARY_EVENT||h.type===De.BINARY_ACK)&&(e+=h.attachments+"-"),h.nsp&&h.nsp!=="/"&&(e+=h.nsp+","),h.id!=null&&(e+=h.id),h.data!=null&&(e+=JSON.stringify(h.data,this.replacer)),e}encodeAsBinary(h){const e=Mi(h),g=this.encodeAsString(e.packet),n=e.buffers;return n.unshift(g),n}}function yr(F){return Object.prototype.toString.call(F)==="[object Object]"}class tr extends Ge{constructor(h){super(),this.reviver=h}add(h){let e;if(typeof h=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");e=this.decodeString(h);const g=e.type===De.BINARY_EVENT;g||e.type===De.BINARY_ACK?(e.type=g?De.EVENT:De.ACK,this.reconstructor=new Ui(e),e.attachments===0&&super.emitReserved("decoded",e)):super.emitReserved("decoded",e)}else if(er(h)||h.base64)if(this.reconstructor)e=this.reconstructor.takeBinaryData(h),e&&(this.reconstructor=null,super.emitReserved("decoded",e));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+h)}decodeString(h){let e=0;const g={type:Number(h.charAt(0))};if(De[g.type]===void 0)throw new Error("unknown packet type "+g.type);if(g.type===De.BINARY_EVENT||g.type===De.BINARY_ACK){const y=e+1;for(;h.charAt(++e)!=="-"&&e!=h.length;);const r=h.substring(y,e);if(r!=Number(r)||h.charAt(e)!=="-")throw new Error("Illegal attachments");g.attachments=Number(r)}if(h.charAt(e+1)==="/"){const y=e+1;for(;++e&&!(h.charAt(e)===","||e===h.length););g.nsp=h.substring(y,e)}else g.nsp="/";const n=h.charAt(e+1);if(n!==""&&Number(n)==n){const y=e+1;for(;++e;){const r=h.charAt(e);if(r==null||Number(r)!=r){--e;break}if(e===h.length)break}g.id=Number(h.substring(y,e+1))}if(h.charAt(++e)){const y=this.tryParse(h.substr(e));if(tr.isPayloadValid(g.type,y))g.data=y;else throw new Error("invalid payload")}return g}tryParse(h){try{return JSON.parse(h,this.reviver)}catch{return!1}}static isPayloadValid(h,e){switch(h){case De.CONNECT:return yr(e);case De.DISCONNECT:return e===void 0;case De.CONNECT_ERROR:return typeof e=="string"||yr(e);case De.EVENT:case De.BINARY_EVENT:return Array.isArray(e)&&(typeof e[0]=="number"||typeof e[0]=="string"&&Ni.indexOf(e[0])===-1);case De.ACK:case De.BINARY_ACK:return Array.isArray(e)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class Ui{constructor(h){this.packet=h,this.buffers=[],this.reconPack=h}takeBinaryData(h){if(this.buffers.push(h),this.buffers.length===this.reconPack.attachments){const e=Di(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const zi=Object.freeze(Object.defineProperty({__proto__:null,Decoder:tr,Encoder:xi,get PacketType(){return De},protocol:Pi},Symbol.toStringTag,{value:"Module"}));function rt(F,h,e){return F.on(h,e),function(){F.off(h,e)}}const Wi=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Fr extends Ge{constructor(h,e,g){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=h,this.nsp=e,g&&g.auth&&(this.auth=g.auth),this._opts=Object.assign({},g),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const h=this.io;this.subs=[rt(h,"open",this.onopen.bind(this)),rt(h,"packet",this.onpacket.bind(this)),rt(h,"error",this.onerror.bind(this)),rt(h,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...h){return h.unshift("message"),this.emit.apply(this,h),this}emit(h,...e){var g,n,y;if(Wi.hasOwnProperty(h))throw new Error('"'+h.toString()+'" is a reserved event name');if(e.unshift(h),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(e),this;const r={type:De.EVENT,data:e};if(r.options={},r.options.compress=this.flags.compress!==!1,typeof e[e.length-1]=="function"){const u=this.ids++,s=e.pop();this._registerAckCallback(u,s),r.id=u}const t=(n=(g=this.io.engine)===null||g===void 0?void 0:g.transport)===null||n===void 0?void 0:n.writable,a=this.connected&&!(!((y=this.io.engine)===null||y===void 0)&&y._hasPingExpired());return this.flags.volatile&&!t||(a?(this.notifyOutgoingListeners(r),this.packet(r)):this.sendBuffer.push(r)),this.flags={},this}_registerAckCallback(h,e){var g;const n=(g=this.flags.timeout)!==null&&g!==void 0?g:this._opts.ackTimeout;if(n===void 0){this.acks[h]=e;return}const y=this.io.setTimeoutFn(()=>{delete this.acks[h];for(let t=0;t<this.sendBuffer.length;t++)this.sendBuffer[t].id===h&&this.sendBuffer.splice(t,1);e.call(this,new Error("operation has timed out"))},n),r=(...t)=>{this.io.clearTimeoutFn(y),e.apply(this,t)};r.withError=!0,this.acks[h]=r}emitWithAck(h,...e){return new Promise((g,n)=>{const y=(r,t)=>r?n(r):g(t);y.withError=!0,e.push(y),this.emit(h,...e)})}_addToQueue(h){let e;typeof h[h.length-1]=="function"&&(e=h.pop());const g={id:this._queueSeq++,tryCount:0,pending:!1,args:h,flags:Object.assign({fromQueue:!0},this.flags)};h.push((n,...y)=>g!==this._queue[0]?void 0:(n!==null?g.tryCount>this._opts.retries&&(this._queue.shift(),e&&e(n)):(this._queue.shift(),e&&e(null,...y)),g.pending=!1,this._drainQueue())),this._queue.push(g),this._drainQueue()}_drainQueue(h=!1){if(!this.connected||this._queue.length===0)return;const e=this._queue[0];e.pending&&!h||(e.pending=!0,e.tryCount++,this.flags=e.flags,this.emit.apply(this,e.args))}packet(h){h.nsp=this.nsp,this.io._packet(h)}onopen(){typeof this.auth=="function"?this.auth(h=>{this._sendConnectPacket(h)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(h){this.packet({type:De.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},h):h})}onerror(h){this.connected||this.emitReserved("connect_error",h)}onclose(h,e){this.connected=!1,delete this.id,this.emitReserved("disconnect",h,e),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(h=>{if(!this.sendBuffer.some(g=>String(g.id)===h)){const g=this.acks[h];delete this.acks[h],g.withError&&g.call(this,new Error("socket has been disconnected"))}})}onpacket(h){if(h.nsp===this.nsp)switch(h.type){case De.CONNECT:h.data&&h.data.sid?this.onconnect(h.data.sid,h.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case De.EVENT:case De.BINARY_EVENT:this.onevent(h);break;case De.ACK:case De.BINARY_ACK:this.onack(h);break;case De.DISCONNECT:this.ondisconnect();break;case De.CONNECT_ERROR:this.destroy();const g=new Error(h.data.message);g.data=h.data.data,this.emitReserved("connect_error",g);break}}onevent(h){const e=h.data||[];h.id!=null&&e.push(this.ack(h.id)),this.connected?this.emitEvent(e):this.receiveBuffer.push(Object.freeze(e))}emitEvent(h){if(this._anyListeners&&this._anyListeners.length){const e=this._anyListeners.slice();for(const g of e)g.apply(this,h)}super.emit.apply(this,h),this._pid&&h.length&&typeof h[h.length-1]=="string"&&(this._lastOffset=h[h.length-1])}ack(h){const e=this;let g=!1;return function(...n){g||(g=!0,e.packet({type:De.ACK,id:h,data:n}))}}onack(h){const e=this.acks[h.id];typeof e=="function"&&(delete this.acks[h.id],e.withError&&h.data.unshift(null),e.apply(this,h.data))}onconnect(h,e){this.id=h,this.recovered=e&&this._pid===e,this._pid=e,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(h=>this.emitEvent(h)),this.receiveBuffer=[],this.sendBuffer.forEach(h=>{this.notifyOutgoingListeners(h),this.packet(h)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(h=>h()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:De.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(h){return this.flags.compress=h,this}get volatile(){return this.flags.volatile=!0,this}timeout(h){return this.flags.timeout=h,this}onAny(h){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(h),this}prependAny(h){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(h),this}offAny(h){if(!this._anyListeners)return this;if(h){const e=this._anyListeners;for(let g=0;g<e.length;g++)if(h===e[g])return e.splice(g,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(h){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(h),this}prependAnyOutgoing(h){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(h),this}offAnyOutgoing(h){if(!this._anyOutgoingListeners)return this;if(h){const e=this._anyOutgoingListeners;for(let g=0;g<e.length;g++)if(h===e[g])return e.splice(g,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(h){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const e=this._anyOutgoingListeners.slice();for(const g of e)g.apply(this,h.data)}}}function dt(F){F=F||{},this.ms=F.min||100,this.max=F.max||1e4,this.factor=F.factor||2,this.jitter=F.jitter>0&&F.jitter<=1?F.jitter:0,this.attempts=0}dt.prototype.duration=function(){var F=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var h=Math.random(),e=Math.floor(h*this.jitter*F);F=(Math.floor(h*10)&1)==0?F-e:F+e}return Math.min(F,this.max)|0};dt.prototype.reset=function(){this.attempts=0};dt.prototype.setMin=function(F){this.ms=F};dt.prototype.setMax=function(F){this.max=F};dt.prototype.setJitter=function(F){this.jitter=F};class Jt extends Ge{constructor(h,e){var g;super(),this.nsps={},this.subs=[],h&&typeof h=="object"&&(e=h,h=void 0),e=e||{},e.path=e.path||"/socket.io",this.opts=e,Bt(this,e),this.reconnection(e.reconnection!==!1),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor((g=e.randomizationFactor)!==null&&g!==void 0?g:.5),this.backoff=new dt({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(e.timeout==null?2e4:e.timeout),this._readyState="closed",this.uri=h;const n=e.parser||zi;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this._autoConnect=e.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(h){return arguments.length?(this._reconnection=!!h,h||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(h){return h===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=h,this)}reconnectionDelay(h){var e;return h===void 0?this._reconnectionDelay:(this._reconnectionDelay=h,(e=this.backoff)===null||e===void 0||e.setMin(h),this)}randomizationFactor(h){var e;return h===void 0?this._randomizationFactor:(this._randomizationFactor=h,(e=this.backoff)===null||e===void 0||e.setJitter(h),this)}reconnectionDelayMax(h){var e;return h===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=h,(e=this.backoff)===null||e===void 0||e.setMax(h),this)}timeout(h){return arguments.length?(this._timeout=h,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(h){if(~this._readyState.indexOf("open"))return this;this.engine=new Ai(this.uri,this.opts);const e=this.engine,g=this;this._readyState="opening",this.skipReconnect=!1;const n=rt(e,"open",function(){g.onopen(),h&&h()}),y=t=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",t),h?h(t):this.maybeReconnectOnOpen()},r=rt(e,"error",y);if(this._timeout!==!1){const t=this._timeout,a=this.setTimeoutFn(()=>{n(),y(new Error("timeout")),e.close()},t);this.opts.autoUnref&&a.unref(),this.subs.push(()=>{this.clearTimeoutFn(a)})}return this.subs.push(n),this.subs.push(r),this}connect(h){return this.open(h)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const h=this.engine;this.subs.push(rt(h,"ping",this.onping.bind(this)),rt(h,"data",this.ondata.bind(this)),rt(h,"error",this.onerror.bind(this)),rt(h,"close",this.onclose.bind(this)),rt(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(h){try{this.decoder.add(h)}catch(e){this.onclose("parse error",e)}}ondecoded(h){Ft(()=>{this.emitReserved("packet",h)},this.setTimeoutFn)}onerror(h){this.emitReserved("error",h)}socket(h,e){let g=this.nsps[h];return g?this._autoConnect&&!g.active&&g.connect():(g=new Fr(this,h,e),this.nsps[h]=g),g}_destroy(h){const e=Object.keys(this.nsps);for(const g of e)if(this.nsps[g].active)return;this._close()}_packet(h){const e=this.encoder.encode(h);for(let g=0;g<e.length;g++)this.engine.write(e[g],h.options)}cleanup(){this.subs.forEach(h=>h()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(h,e){var g;this.cleanup(),(g=this.engine)===null||g===void 0||g.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",h,e),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const h=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const e=this.backoff.duration();this._reconnecting=!0;const g=this.setTimeoutFn(()=>{h.skipReconnect||(this.emitReserved("reconnect_attempt",h.backoff.attempts),!h.skipReconnect&&h.open(n=>{n?(h._reconnecting=!1,h.reconnect(),this.emitReserved("reconnect_error",n)):h.onreconnect()}))},e);this.opts.autoUnref&&g.unref(),this.subs.push(()=>{this.clearTimeoutFn(g)})}}onreconnect(){const h=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",h)}}const Et={};function It(F,h){typeof F=="object"&&(h=F,F=void 0),h=h||{};const e=Li(F,h.path||"/socket.io"),g=e.source,n=e.id,y=e.path,r=Et[n]&&y in Et[n].nsps,t=h.forceNew||h["force new connection"]||h.multiplex===!1||r;let a;return t?a=new Jt(g,h):(Et[n]||(Et[n]=new Jt(g,h)),a=Et[n]),e.query&&!h.query&&(h.query=e.queryKey),a.socket(e.path,h)}Object.assign(It,{Manager:Jt,Socket:Fr,io:It,connect:It});const Hi={class:"excel-editor-container"},Zi={class:"sidebar"},Xi={class:"file-list"},ji=["onClick"],Gi={class:"file-info"},Yi=["onUpdate:modelValue","onBlur","onKeyup"],Ki=["onDblclick"],Vi={class:"file-actions"},Ji=["onClick"],$i={class:"sidebar-footer"},Qi={class:"status-text"},qi={class:"main-content"},en={class:"header"},tn={class:"header-left"},rn={class:"current-file-title"},nn={class:"actions"},an={class:"action-btn import-btn"},sn=Mr({__name:"ExcelEditor",setup(F){const h=_t("..."),e=_t(!1),g=It("http://localhost:3000");let n=!1;const y=_t([{id:"1",name:"",sheets:[]}]),r=_t("1"),t=_t(null),a=Dr(()=>y.value.find(l=>l.id===r.value));Nr(()=>{u(a.value?.sheets||[]),g.on("connect",()=>{h.value="",e.value=!0}),g.on("disconnect",()=>{h.value="",e.value=!1}),g.on("update-cell",l=>{l.fileId===r.value&&(n=!0,window.luckysheet.setCellValue(l.r,l.c,l.v),n=!1,console.log(":",l))})});const f=(l=[],d="Vue Excel Editor")=>({container:"luckysheet",title:d,lang:"zh",data:l,showinfobar:!1,showtoolbar:!0,showsheetbar:!0,showstatisticBar:!0,hook:{cellUpdated:function(C,c,E,O,P){n||g.emit("cell-update",{r:C,c,v:O,fileId:r.value})}}}),u=(l=[])=>{const d=f(l,a.value?.name);window.luckysheet.create(d)},s=()=>{const l=Date.now().toString(),d={id:l,name:` ${y.value.length+1}`,sheets:[]};y.value.push(d),_(l)},w=l=>{if(y.value.length<=1){alert("");return}const d=y.value.findIndex(C=>C.id===l);if(y.value=y.value.filter(C=>C.id!==l),r.value===l){const C=y.value[d-1]||y.value[0];C&&_(C.id)}},_=l=>{r.value!==l&&(S(),r.value=l,window.luckysheet.destroy(),zr(()=>{const d=y.value.find(C=>C.id===l);d&&u(d.sheets)}))},S=()=>{const l=window.luckysheet.getAllSheets(),d=y.value.find(C=>C.id===r.value);d&&(d.sheets=l)},b=l=>{t.value=l.id},p=l=>{l.name.trim()||(l.name=""),t.value=null},i=l=>{const d=l.target;if(!d.files||d.files.length===0)return;const C=d.files[0];C&&Kr.transformExcelToLucky(C,(c,E)=>{if(c.sheets==null||c.sheets.length==0){alert(" Excel  xls ");return}const O=Date.now().toString(),P={id:O,name:c.info.name||C.name.replace(".xlsx",""),sheets:c.sheets};y.value.push(P),_(O),d.value=""})};return(l,d)=>(wt(),yt("div",Hi,[We("aside",Zi,[d[5]||(d[5]=Pr('<div class="sidebar-header" data-v-57b61ecf><div class="traffic-lights" data-v-57b61ecf><div class="traffic-light red" data-v-57b61ecf></div><div class="traffic-light yellow" data-v-57b61ecf></div><div class="traffic-light green" data-v-57b61ecf></div></div></div>',1)),We("div",Xi,[We("div",{class:"list-header"},[d[2]||(d[2]=We("span",null,"",-1)),We("button",{class:"icon-btn add-btn",onClick:s,title:""},[...d[1]||(d[1]=[We("span",null,"+",-1)])])]),(wt(!0),yt(xr,null,Ur(y.value,C=>(wt(),yt("div",{key:C.id,class:hr(["file-item",{active:r.value===C.id}]),onClick:c=>_(C.id)},[d[3]||(d[3]=We("span",{class:"file-icon"},"",-1)),We("div",Gi,[t.value===C.id?Wr((wt(),yt("input",{key:0,"onUpdate:modelValue":c=>C.name=c,onBlur:c=>p(C),onKeyup:Zr(c=>p(C),["enter"]),onClick:d[0]||(d[0]=dr(()=>{},["stop"])),class:"rename-input",autoFocus:""},null,40,Yi)),[[Hr,C.name]]):(wt(),yt("span",{key:1,class:"file-name",onDblclick:c=>b(C)},zt(C.name),41,Ki))]),We("div",Vi,[We("button",{class:"icon-btn delete-btn",onClick:dr(c=>w(C.id),["stop"]),title:""},"  ",8,Ji)])],10,ji))),128))]),We("div",$i,[We("div",{class:hr(["status-indicator",{connected:e.value}])},[d[4]||(d[4]=We("span",{class:"status-dot"},null,-1)),We("span",Qi,zt(e.value?"":""),1)],2)])]),We("main",qi,[We("header",en,[We("div",tn,[We("h2",rn,zt(a.value?.name||""),1)]),We("div",nn,[We("label",an,[We("input",{type:"file",onChange:i,accept:".xlsx",hidden:""},null,32),d[6]||(d[6]=We("span",{class:"icon"},"",-1)),d[7]||(d[7]=We("span",null," Excel",-1))]),We("button",{class:"action-btn save-btn",onClick:S},[...d[8]||(d[8]=[We("span",{class:"icon"},"",-1),We("span",null,"",-1)])])])]),d[9]||(d[9]=We("div",{id:"luckysheet",class:"spreadsheet-area"},null,-1))])]))}}),fn=Xr(sn,[["__scopeId","data-v-57b61ecf"]]);export{fn as default};
